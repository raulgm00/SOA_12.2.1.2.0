<xsl:stylesheet version="1.0" exclude-result-prefixes=" xsd oracle-xsl-mapper xsi xsl ns0 tns UUIDUserFunction IsUserInGroupFunction oraext IsUserInRoleFunction xp20 DVMFunctions oraxsl RuntimeTypeConversionFunctions XrefFunctions BasicCredentialsUserFunction" xmlns:UUIDUserFunction="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.stages.functions.UUIDUserFunction" xmlns:IsUserInGroupFunction="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.stages.functions.IsUserInGroupFunction" xmlns:ns0="http://www.agarcia.mx/EnterpriseObjects/Appointment" xmlns:tns="http://www.agarcia.mx/EnterpriseObjects/Citas" xmlns:oraext="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc" xmlns:IsUserInRoleFunction="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.stages.functions.IsUserInRoleFunction" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20" xmlns:DVMFunctions="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.functions.dvm.DVMFunctions" xmlns:oracle-xsl-mapper="http://www.oracle.com/xsl/mapper/schemas" xmlns:oraxsl="http://www.oracle.com/XSL/Transform/java" xmlns:RuntimeTypeConversionFunctions="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.stages.functions.RuntimeTypeConversionFunctions" xmlns:XrefFunctions="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.functions.xref.XrefFunctions" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:BasicCredentialsUserFunction="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.stages.functions.BasicCredentialsUserFunction" xmlns:com="http://www.agarcia.mx/EnterpriseObjects/Common" xmlns:ns1="http://www.agarcia.mx/EnterpriseObjects/Custom">
   <oracle-xsl-mapper:schema>
      <!--SPECIFICATION OF MAP SOURCES AND TARGETS, DO NOT MODIFY.-->
      <oracle-xsl-mapper:mapSources>
         <oracle-xsl-mapper:source type="XSD">
            <oracle-xsl-mapper:schema location="../../../../MetaData/Components/EnterpriseObjectLibrary/EBO/Appointment/AppointmentEBM.xsd"/>
            <oracle-xsl-mapper:rootElement name="ProccesAppointmentEBM" namespace="http://www.agarcia.mx/EnterpriseObjects/Appointment"/>
         </oracle-xsl-mapper:source>
      </oracle-xsl-mapper:mapSources>
      <oracle-xsl-mapper:mapTargets>
         <oracle-xsl-mapper:target type="XSD">
            <oracle-xsl-mapper:schema location="../../../../MetaData/Components/EnterpriseObjectLibrary/EBO/Citas/CitasEBM.xsd"/>
            <oracle-xsl-mapper:rootElement name="ProccesCitasEBM" namespace="http://www.agarcia.mx/EnterpriseObjects/Citas"/>
         </oracle-xsl-mapper:target>
      </oracle-xsl-mapper:mapTargets>
      <!--GENERATED BY ORACLE XSL MAPPER 12.2.1.2.0(XSLT Build 161003.0739.0018) AT [MON OCT 19 16:21:12 CDT 2020].-->
   </oracle-xsl-mapper:schema>
   <!--User Editing allowed BELOW this line - DO NOT DELETE THIS LINE-->
   <xsl:template match="/">
      <tns:ProccesCitasEBM>
         <tns:header>
            <com:TrackingID>
               <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:TrackingID/@schemeID">
                  <xsl:attribute name="schemeID">
                     <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:TrackingID/@schemeID"/>
                  </xsl:attribute>
               </xsl:if>
               <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:TrackingID/@schemeAgencyID">
                  <xsl:attribute name="schemeAgencyID">
                     <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:TrackingID/@schemeAgencyID"/>
                  </xsl:attribute>
               </xsl:if>
               <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:TrackingID/@schemeVersionID">
                  <xsl:attribute name="schemeVersionID">
                     <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:TrackingID/@schemeVersionID"/>
                  </xsl:attribute>
               </xsl:if>
               <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:TrackingID"/>
            </com:TrackingID>
            <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:InstanceID">
               <com:InstanceID>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:InstanceID/@schemeID">
                     <xsl:attribute name="schemeID">
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:InstanceID/@schemeID"/>
                     </xsl:attribute>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:InstanceID/@schemeAgencyID">
                     <xsl:attribute name="schemeAgencyID">
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:InstanceID/@schemeAgencyID"/>
                     </xsl:attribute>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:InstanceID/@schemeVersionID">
                     <xsl:attribute name="schemeVersionID">
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:InstanceID/@schemeVersionID"/>
                     </xsl:attribute>
                  </xsl:if>
                  <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:InstanceID"/>
               </com:InstanceID>
            </xsl:if>
            <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:User">
               <com:User>
                  <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:User"/>
               </com:User>
            </xsl:if>
            <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:SourceID">
               <com:SourceID>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:SourceID/@listID">
                     <xsl:attribute name="listID">
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:SourceID/@listID"/>
                     </xsl:attribute>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:SourceID/@listAgencyID">
                     <xsl:attribute name="listAgencyID">
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:SourceID/@listAgencyID"/>
                     </xsl:attribute>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:SourceID/@listVersionID">
                     <xsl:attribute name="listVersionID">
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:SourceID/@listVersionID"/>
                     </xsl:attribute>
                  </xsl:if>
                  <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:SourceID"/>
               </com:SourceID>
            </xsl:if>
            <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:Target">
               <com:Target>
                  <xsl:for-each select="/ns0:ProccesAppointmentEBM/ns0:header/com:Target/com:Applications">
                     <com:Applications>
                        <xsl:if test="com:Name">
                           <com:Name>
                              <xsl:value-of select="com:Name"/>
                           </com:Name>
                        </xsl:if>
                        <xsl:if test="com:Code">
                           <com:Code>
                              <xsl:if test="com:Code/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="com:Code/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="com:Code/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="com:Code/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="com:Code/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="com:Code/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="com:Code"/>
                           </com:Code>
                        </xsl:if>
                        <xsl:if test="com:User">
                           <com:User>
                              <xsl:value-of select="com:User"/>
                           </com:User>
                        </xsl:if>
                        <xsl:if test="com:Version">
                           <com:Version>
                              <xsl:if test="com:Version/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="com:Version/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="com:Version/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="com:Version/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="com:Version/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="com:Version/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="com:Version"/>
                           </com:Version>
                        </xsl:if>
                     </com:Applications>
                  </xsl:for-each>
               </com:Target>
            </xsl:if>
            <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:Operation">
               <com:Operation>
                  <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:Operation"/>
               </com:Operation>
            </xsl:if>
            <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:Interface">
               <com:Interface>
                  <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:Interface"/>
               </com:Interface>
            </xsl:if>
            <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit">
               <com:BusinessUnit>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Identification">
                     <com:Identification>
                        <com:ID>
                           <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Identification/com:ID"/>
                        </com:ID>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Identification/com:BusinessComponentID">
                           <com:BusinessComponentID>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Identification/com:BusinessComponentID/@schemeID">
                                 <xsl:attribute name="schemeID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Identification/com:BusinessComponentID/@schemeID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Identification/com:BusinessComponentID/@schemeAgencyID">
                                 <xsl:attribute name="schemeAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Identification/com:BusinessComponentID/@schemeAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Identification/com:BusinessComponentID/@schemeVersionID">
                                 <xsl:attribute name="schemeVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Identification/com:BusinessComponentID/@schemeVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Identification/com:BusinessComponentID"/>
                           </com:BusinessComponentID>
                        </xsl:if>
                        <xsl:for-each select="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Identification/com:ApplicationObjectReference">
                           <com:ApplicationObjectReference>
                              <xsl:if test="com:ApplicationName">
                                 <com:ApplicationName>
                                    <xsl:value-of select="com:ApplicationName"/>
                                 </com:ApplicationName>
                              </xsl:if>
                              <com:ApplicationObjectID>
                                 <xsl:value-of select="com:ApplicationObjectID"/>
                              </com:ApplicationObjectID>
                           </com:ApplicationObjectReference>
                        </xsl:for-each>
                     </com:Identification>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Name">
                     <com:Name>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Name/@languageCode">
                           <xsl:attribute name="languageCode">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Name/@languageCode"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Name/@languageLocaleCode">
                           <xsl:attribute name="languageLocaleCode">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Name/@languageLocaleCode"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Name"/>
                     </com:Name>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Code">
                     <com:Code>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Code/@listID">
                           <xsl:attribute name="listID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Code/@listID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Code/@listAgencyID">
                           <xsl:attribute name="listAgencyID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Code/@listAgencyID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Code/@listVersionID">
                           <xsl:attribute name="listVersionID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Code/@listVersionID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:Code"/>
                     </com:Code>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:CountryName">
                     <com:CountryName>
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:CountryName"/>
                     </com:CountryName>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:CountryCode">
                     <com:CountryCode>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:CountryCode/@listID">
                           <xsl:attribute name="listID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:CountryCode/@listID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:CountryCode/@listAgencyID">
                           <xsl:attribute name="listAgencyID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:CountryCode/@listAgencyID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:CountryCode/@listVersionID">
                           <xsl:attribute name="listVersionID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:CountryCode/@listVersionID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:BusinessUnit/com:CountryCode"/>
                     </com:CountryCode>
                  </xsl:if>
               </com:BusinessUnit>
            </xsl:if>
            <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:header/com:RequestDateTime">
               <com:RequestDateTime>
                  <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:header/com:RequestDateTime"/>
               </com:RequestDateTime>
            </xsl:if>
            <xsl:for-each select="/ns0:ProccesAppointmentEBM/ns0:header/com:DateTimes">
               <com:DateTimes>
                  <xsl:if test="@Code">
                     <xsl:attribute name="Code">
                        <xsl:value-of select="@Code"/>
                     </xsl:attribute>
                  </xsl:if>
                  <xsl:value-of select="."/>
               </com:DateTimes>
            </xsl:for-each>
         </tns:header>
         <tns:dataArea>
            <tns:CitasEBO>
               <tns:from_location>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/@Name">
                     <xsl:attribute name="Name">
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/@Name"/>
                     </xsl:attribute>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/@Code">
                     <xsl:attribute name="Code">
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/@Code"/>
                     </xsl:attribute>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:LocationId">
                     <com:LocationId>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:LocationId/@schemeID">
                           <xsl:attribute name="schemeID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:LocationId/@schemeID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:LocationId/@schemeAgencyID">
                           <xsl:attribute name="schemeAgencyID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:LocationId/@schemeAgencyID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:LocationId/@schemeVersionID">
                           <xsl:attribute name="schemeVersionID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:LocationId/@schemeVersionID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:LocationId"/>
                     </com:LocationId>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Name">
                     <com:Name>
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Name"/>
                     </com:Name>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Description">
                     <com:Description>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Description/@languageCode">
                           <xsl:attribute name="languageCode">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Description/@languageCode"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Description/@languageLocaleCode">
                           <xsl:attribute name="languageLocaleCode">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Description/@languageLocaleCode"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Description"/>
                     </com:Description>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:TypeCode">
                     <com:TypeCode>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:TypeCode/@listID">
                           <xsl:attribute name="listID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:TypeCode/@listID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:TypeCode/@listAgencyID">
                           <xsl:attribute name="listAgencyID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:TypeCode/@listAgencyID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:TypeCode/@listVersionID">
                           <xsl:attribute name="listVersionID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:TypeCode/@listVersionID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:TypeCode"/>
                     </com:TypeCode>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:UseCode">
                     <com:UseCode>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:UseCode/@listID">
                           <xsl:attribute name="listID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:UseCode/@listID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:UseCode/@listAgencyID">
                           <xsl:attribute name="listAgencyID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:UseCode/@listAgencyID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:UseCode/@listVersionID">
                           <xsl:attribute name="listVersionID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:UseCode/@listVersionID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:UseCode"/>
                     </com:UseCode>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Directions">
                     <com:Directions>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Directions/@languageCode">
                           <xsl:attribute name="languageCode">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Directions/@languageCode"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Directions/@languageLocaleCode">
                           <xsl:attribute name="languageLocaleCode">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Directions/@languageLocaleCode"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Directions"/>
                     </com:Directions>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address">
                     <com:Address>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/@type">
                           <xsl:attribute name="type">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/@type"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Identification">
                           <com:Identification>
                              <com:ID>
                                 <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Identification/com:ID"/>
                              </com:ID>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Identification/com:BusinessComponentID">
                                 <com:BusinessComponentID>
                                    <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Identification/com:BusinessComponentID/@schemeID">
                                       <xsl:attribute name="schemeID">
                                          <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Identification/com:BusinessComponentID/@schemeID"/>
                                       </xsl:attribute>
                                    </xsl:if>
                                    <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Identification/com:BusinessComponentID/@schemeAgencyID">
                                       <xsl:attribute name="schemeAgencyID">
                                          <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Identification/com:BusinessComponentID/@schemeAgencyID"/>
                                       </xsl:attribute>
                                    </xsl:if>
                                    <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Identification/com:BusinessComponentID/@schemeVersionID">
                                       <xsl:attribute name="schemeVersionID">
                                          <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Identification/com:BusinessComponentID/@schemeVersionID"/>
                                       </xsl:attribute>
                                    </xsl:if>
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Identification/com:BusinessComponentID"/>
                                 </com:BusinessComponentID>
                              </xsl:if>
                              <xsl:for-each select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Identification/com:ApplicationObjectReference">
                                 <com:ApplicationObjectReference>
                                    <xsl:if test="com:ApplicationName">
                                       <com:ApplicationName>
                                          <xsl:value-of select="com:ApplicationName"/>
                                       </com:ApplicationName>
                                    </xsl:if>
                                    <com:ApplicationObjectID>
                                       <xsl:value-of select="com:ApplicationObjectID"/>
                                    </com:ApplicationObjectID>
                                 </com:ApplicationObjectReference>
                              </xsl:for-each>
                           </com:Identification>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineOne">
                           <com:LineOne>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineOne/@languageCode">
                                 <xsl:attribute name="languageCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineOne/@languageCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineOne/@languageLocaleCode">
                                 <xsl:attribute name="languageLocaleCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineOne/@languageLocaleCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineOne"/>
                           </com:LineOne>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineTwo">
                           <com:LineTwo>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineTwo/@languageCode">
                                 <xsl:attribute name="languageCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineTwo/@languageCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineTwo/@languageLocaleCode">
                                 <xsl:attribute name="languageLocaleCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineTwo/@languageLocaleCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineTwo"/>
                           </com:LineTwo>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineThree">
                           <com:LineThree>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineThree/@languageCode">
                                 <xsl:attribute name="languageCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineThree/@languageCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineThree/@languageLocaleCode">
                                 <xsl:attribute name="languageLocaleCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineThree/@languageLocaleCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineThree"/>
                           </com:LineThree>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineFour">
                           <com:LineFour>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineFour/@languageCode">
                                 <xsl:attribute name="languageCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineFour/@languageCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineFour/@languageLocaleCode">
                                 <xsl:attribute name="languageLocaleCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineFour/@languageLocaleCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LineFour"/>
                           </com:LineFour>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Building">
                           <com:Building>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Building/@languageCode">
                                 <xsl:attribute name="languageCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Building/@languageCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Building/@languageLocaleCode">
                                 <xsl:attribute name="languageLocaleCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Building/@languageLocaleCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Building"/>
                           </com:Building>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Floor">
                           <com:Floor>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Floor"/>
                           </com:Floor>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:StreetNumber">
                           <com:StreetNumber>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:StreetNumber"/>
                           </com:StreetNumber>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Apartment">
                           <com:Apartment>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Apartment"/>
                           </com:Apartment>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:StreetName">
                           <com:StreetName>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:StreetName"/>
                           </com:StreetName>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:BetweenStreets">
                           <com:BetweenStreets>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:BetweenStreets"/>
                           </com:BetweenStreets>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Area">
                           <com:Area>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Area/@languageCode">
                                 <xsl:attribute name="languageCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Area/@languageCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Area/@languageLocaleCode">
                                 <xsl:attribute name="languageLocaleCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Area/@languageLocaleCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:Area"/>
                           </com:Area>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CityName">
                           <com:CityName>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CityName"/>
                           </com:CityName>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:StateName">
                           <com:StateName>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:StateName"/>
                           </com:StateName>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:ProvinceName">
                           <com:ProvinceName>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:ProvinceName"/>
                           </com:ProvinceName>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:RuralRoute">
                           <com:RuralRoute>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:RuralRoute/@languageCode">
                                 <xsl:attribute name="languageCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:RuralRoute/@languageCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:RuralRoute/@languageLocaleCode">
                                 <xsl:attribute name="languageLocaleCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:RuralRoute/@languageLocaleCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:RuralRoute"/>
                           </com:RuralRoute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountyName">
                           <com:CountyName>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountyName"/>
                           </com:CountyName>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountryName">
                           <com:CountryName>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountryName"/>
                           </com:CountryName>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountryCode">
                           <com:CountryCode>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountryCode/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountryCode/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountryCode/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountryCode/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountryCode/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountryCode/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountryCode"/>
                           </com:CountryCode>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountrySubDivisionID">
                           <com:CountrySubDivisionID>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountrySubDivisionID/@schemeID">
                                 <xsl:attribute name="schemeID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountrySubDivisionID/@schemeID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountrySubDivisionID/@schemeAgencyID">
                                 <xsl:attribute name="schemeAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountrySubDivisionID/@schemeAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountrySubDivisionID/@schemeVersionID">
                                 <xsl:attribute name="schemeVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountrySubDivisionID/@schemeVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CountrySubDivisionID"/>
                           </com:CountrySubDivisionID>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CitySubDivisionName">
                           <com:CitySubDivisionName>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:CitySubDivisionName"/>
                           </com:CitySubDivisionName>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:ProcessingCode">
                           <com:ProcessingCode>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:ProcessingCode/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:ProcessingCode/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:ProcessingCode/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:ProcessingCode/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:ProcessingCode/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:ProcessingCode/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:ProcessingCode"/>
                           </com:ProcessingCode>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:PostalCode">
                           <com:PostalCode>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:PostalCode/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:PostalCode/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:PostalCode/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:PostalCode/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:PostalCode/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:PostalCode/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:PostalCode"/>
                           </com:PostalCode>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LongPostalCode">
                           <com:LongPostalCode>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LongPostalCode/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LongPostalCode/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LongPostalCode/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LongPostalCode/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LongPostalCode/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LongPostalCode/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:LongPostalCode"/>
                           </com:LongPostalCode>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:GEOCodeID">
                           <com:GEOCodeID>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:GEOCodeID/@schemeID">
                                 <xsl:attribute name="schemeID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:GEOCodeID/@schemeID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:GEOCodeID/@schemeAgencyID">
                                 <xsl:attribute name="schemeAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:GEOCodeID/@schemeAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:GEOCodeID/@schemeVersionID">
                                 <xsl:attribute name="schemeVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:GEOCodeID/@schemeVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:GEOCodeID"/>
                           </com:GEOCodeID>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:InCityLimitIndicator">
                           <com:InCityLimitIndicator>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:InCityLimitIndicator"/>
                           </com:InCityLimitIndicator>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:TimeZoneCode">
                           <com:TimeZoneCode>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:TimeZoneCode/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:TimeZoneCode/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:TimeZoneCode/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:TimeZoneCode/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:TimeZoneCode/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:TimeZoneCode/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:TimeZoneCode"/>
                           </com:TimeZoneCode>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:TypeCode">
                           <com:TypeCode>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:TypeCode/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:TypeCode/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:TypeCode/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:TypeCode/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:TypeCode/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:TypeCode/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:TypeCode"/>
                           </com:TypeCode>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:SubTypeCode">
                           <com:SubTypeCode>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:SubTypeCode/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:SubTypeCode/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:SubTypeCode/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:SubTypeCode/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:SubTypeCode/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:SubTypeCode/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:Address/com:SubTypeCode"/>
                           </com:SubTypeCode>
                        </xsl:if>
                     </com:Address>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GEOCodeID">
                     <com:GEOCodeID>
                        <com:ID>
                           <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GEOCodeID/com:ID"/>
                        </com:ID>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GEOCodeID/com:BusinessComponentID">
                           <com:BusinessComponentID>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GEOCodeID/com:BusinessComponentID/@schemeID">
                                 <xsl:attribute name="schemeID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GEOCodeID/com:BusinessComponentID/@schemeID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GEOCodeID/com:BusinessComponentID/@schemeAgencyID">
                                 <xsl:attribute name="schemeAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GEOCodeID/com:BusinessComponentID/@schemeAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GEOCodeID/com:BusinessComponentID/@schemeVersionID">
                                 <xsl:attribute name="schemeVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GEOCodeID/com:BusinessComponentID/@schemeVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GEOCodeID/com:BusinessComponentID"/>
                           </com:BusinessComponentID>
                        </xsl:if>
                        <xsl:for-each select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GEOCodeID/com:ApplicationObjectReference">
                           <com:ApplicationObjectReference>
                              <xsl:if test="com:ApplicationName">
                                 <com:ApplicationName>
                                    <xsl:value-of select="com:ApplicationName"/>
                                 </com:ApplicationName>
                              </xsl:if>
                              <com:ApplicationObjectID>
                                 <xsl:value-of select="com:ApplicationObjectID"/>
                              </com:ApplicationObjectID>
                           </com:ApplicationObjectReference>
                        </xsl:for-each>
                     </com:GEOCodeID>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:TimeZoneIdentifier">
                     <com:TimeZoneIdentifier>
                        <com:ID>
                           <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:TimeZoneIdentifier/com:ID"/>
                        </com:ID>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:TimeZoneIdentifier/com:BusinessComponentID">
                           <com:BusinessComponentID>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:TimeZoneIdentifier/com:BusinessComponentID/@schemeID">
                                 <xsl:attribute name="schemeID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:TimeZoneIdentifier/com:BusinessComponentID/@schemeID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:TimeZoneIdentifier/com:BusinessComponentID/@schemeAgencyID">
                                 <xsl:attribute name="schemeAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:TimeZoneIdentifier/com:BusinessComponentID/@schemeAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:TimeZoneIdentifier/com:BusinessComponentID/@schemeVersionID">
                                 <xsl:attribute name="schemeVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:TimeZoneIdentifier/com:BusinessComponentID/@schemeVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:TimeZoneIdentifier/com:BusinessComponentID"/>
                           </com:BusinessComponentID>
                        </xsl:if>
                        <xsl:for-each select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:TimeZoneIdentifier/com:ApplicationObjectReference">
                           <com:ApplicationObjectReference>
                              <xsl:if test="com:ApplicationName">
                                 <com:ApplicationName>
                                    <xsl:value-of select="com:ApplicationName"/>
                                 </com:ApplicationName>
                              </xsl:if>
                              <com:ApplicationObjectID>
                                 <xsl:value-of select="com:ApplicationObjectID"/>
                              </com:ApplicationObjectID>
                           </com:ApplicationObjectReference>
                        </xsl:for-each>
                     </com:TimeZoneIdentifier>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate">
                     <com:GeographicalCoordinate>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:AltitudeMeasure">
                           <com:AltitudeMeasure>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:AltitudeMeasure/@unitCode">
                                 <xsl:attribute name="unitCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:AltitudeMeasure/@unitCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:AltitudeMeasure"/>
                           </com:AltitudeMeasure>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LatitudeMeasure">
                           <com:LatitudeMeasure>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LatitudeMeasure/@unitCode">
                                 <xsl:attribute name="unitCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LatitudeMeasure/@unitCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LatitudeMeasure"/>
                           </com:LatitudeMeasure>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LongitudeMeasure">
                           <com:LongitudeMeasure>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LongitudeMeasure/@unitCode">
                                 <xsl:attribute name="unitCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LongitudeMeasure/@unitCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LongitudeMeasure"/>
                           </com:LongitudeMeasure>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LatitudeDirectionCode">
                           <com:LatitudeDirectionCode>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LatitudeDirectionCode/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LatitudeDirectionCode/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LatitudeDirectionCode/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LatitudeDirectionCode/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LatitudeDirectionCode/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LatitudeDirectionCode/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LatitudeDirectionCode"/>
                           </com:LatitudeDirectionCode>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LongitudeDirectionCode">
                           <com:LongitudeDirectionCode>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LongitudeDirectionCode/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LongitudeDirectionCode/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LongitudeDirectionCode/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LongitudeDirectionCode/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LongitudeDirectionCode/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LongitudeDirectionCode/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:LongitudeDirectionCode"/>
                           </com:LongitudeDirectionCode>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:SystemID">
                           <com:SystemID>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:SystemID/@schemeID">
                                 <xsl:attribute name="schemeID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:SystemID/@schemeID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:SystemID/@schemeAgencyID">
                                 <xsl:attribute name="schemeAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:SystemID/@schemeAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:SystemID/@schemeVersionID">
                                 <xsl:attribute name="schemeVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:SystemID/@schemeVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:from_location/com:GeographicalCoordinate/com:SystemID"/>
                           </com:SystemID>
                        </xsl:if>
                     </com:GeographicalCoordinate>
                  </xsl:if>
               </tns:from_location>
               <tns:to_location>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/@Name">
                     <xsl:attribute name="Name">
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/@Name"/>
                     </xsl:attribute>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/@Code">
                     <xsl:attribute name="Code">
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/@Code"/>
                     </xsl:attribute>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:LocationId">
                     <com:LocationId>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:LocationId/@schemeID">
                           <xsl:attribute name="schemeID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:LocationId/@schemeID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:LocationId/@schemeAgencyID">
                           <xsl:attribute name="schemeAgencyID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:LocationId/@schemeAgencyID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:LocationId/@schemeVersionID">
                           <xsl:attribute name="schemeVersionID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:LocationId/@schemeVersionID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:LocationId"/>
                     </com:LocationId>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Name">
                     <com:Name>
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Name"/>
                     </com:Name>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Description">
                     <com:Description>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Description/@languageCode">
                           <xsl:attribute name="languageCode">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Description/@languageCode"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Description/@languageLocaleCode">
                           <xsl:attribute name="languageLocaleCode">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Description/@languageLocaleCode"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Description"/>
                     </com:Description>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:TypeCode">
                     <com:TypeCode>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:TypeCode/@listID">
                           <xsl:attribute name="listID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:TypeCode/@listID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:TypeCode/@listAgencyID">
                           <xsl:attribute name="listAgencyID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:TypeCode/@listAgencyID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:TypeCode/@listVersionID">
                           <xsl:attribute name="listVersionID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:TypeCode/@listVersionID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:TypeCode"/>
                     </com:TypeCode>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:UseCode">
                     <com:UseCode>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:UseCode/@listID">
                           <xsl:attribute name="listID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:UseCode/@listID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:UseCode/@listAgencyID">
                           <xsl:attribute name="listAgencyID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:UseCode/@listAgencyID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:UseCode/@listVersionID">
                           <xsl:attribute name="listVersionID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:UseCode/@listVersionID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:UseCode"/>
                     </com:UseCode>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Directions">
                     <com:Directions>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Directions/@languageCode">
                           <xsl:attribute name="languageCode">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Directions/@languageCode"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Directions/@languageLocaleCode">
                           <xsl:attribute name="languageLocaleCode">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Directions/@languageLocaleCode"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Directions"/>
                     </com:Directions>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address">
                     <com:Address>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/@type">
                           <xsl:attribute name="type">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/@type"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Identification">
                           <com:Identification>
                              <com:ID>
                                 <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Identification/com:ID"/>
                              </com:ID>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Identification/com:BusinessComponentID">
                                 <com:BusinessComponentID>
                                    <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Identification/com:BusinessComponentID/@schemeID">
                                       <xsl:attribute name="schemeID">
                                          <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Identification/com:BusinessComponentID/@schemeID"/>
                                       </xsl:attribute>
                                    </xsl:if>
                                    <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Identification/com:BusinessComponentID/@schemeAgencyID">
                                       <xsl:attribute name="schemeAgencyID">
                                          <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Identification/com:BusinessComponentID/@schemeAgencyID"/>
                                       </xsl:attribute>
                                    </xsl:if>
                                    <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Identification/com:BusinessComponentID/@schemeVersionID">
                                       <xsl:attribute name="schemeVersionID">
                                          <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Identification/com:BusinessComponentID/@schemeVersionID"/>
                                       </xsl:attribute>
                                    </xsl:if>
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Identification/com:BusinessComponentID"/>
                                 </com:BusinessComponentID>
                              </xsl:if>
                              <xsl:for-each select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Identification/com:ApplicationObjectReference">
                                 <com:ApplicationObjectReference>
                                    <xsl:if test="com:ApplicationName">
                                       <com:ApplicationName>
                                          <xsl:value-of select="com:ApplicationName"/>
                                       </com:ApplicationName>
                                    </xsl:if>
                                    <com:ApplicationObjectID>
                                       <xsl:value-of select="com:ApplicationObjectID"/>
                                    </com:ApplicationObjectID>
                                 </com:ApplicationObjectReference>
                              </xsl:for-each>
                           </com:Identification>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineOne">
                           <com:LineOne>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineOne/@languageCode">
                                 <xsl:attribute name="languageCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineOne/@languageCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineOne/@languageLocaleCode">
                                 <xsl:attribute name="languageLocaleCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineOne/@languageLocaleCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineOne"/>
                           </com:LineOne>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineTwo">
                           <com:LineTwo>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineTwo/@languageCode">
                                 <xsl:attribute name="languageCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineTwo/@languageCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineTwo/@languageLocaleCode">
                                 <xsl:attribute name="languageLocaleCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineTwo/@languageLocaleCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineTwo"/>
                           </com:LineTwo>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineThree">
                           <com:LineThree>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineThree/@languageCode">
                                 <xsl:attribute name="languageCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineThree/@languageCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineThree/@languageLocaleCode">
                                 <xsl:attribute name="languageLocaleCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineThree/@languageLocaleCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineThree"/>
                           </com:LineThree>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineFour">
                           <com:LineFour>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineFour/@languageCode">
                                 <xsl:attribute name="languageCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineFour/@languageCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineFour/@languageLocaleCode">
                                 <xsl:attribute name="languageLocaleCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineFour/@languageLocaleCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LineFour"/>
                           </com:LineFour>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Building">
                           <com:Building>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Building/@languageCode">
                                 <xsl:attribute name="languageCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Building/@languageCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Building/@languageLocaleCode">
                                 <xsl:attribute name="languageLocaleCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Building/@languageLocaleCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Building"/>
                           </com:Building>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Floor">
                           <com:Floor>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Floor"/>
                           </com:Floor>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:StreetNumber">
                           <com:StreetNumber>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:StreetNumber"/>
                           </com:StreetNumber>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Apartment">
                           <com:Apartment>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Apartment"/>
                           </com:Apartment>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:StreetName">
                           <com:StreetName>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:StreetName"/>
                           </com:StreetName>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:BetweenStreets">
                           <com:BetweenStreets>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:BetweenStreets"/>
                           </com:BetweenStreets>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Area">
                           <com:Area>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Area/@languageCode">
                                 <xsl:attribute name="languageCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Area/@languageCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Area/@languageLocaleCode">
                                 <xsl:attribute name="languageLocaleCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Area/@languageLocaleCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:Area"/>
                           </com:Area>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CityName">
                           <com:CityName>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CityName"/>
                           </com:CityName>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:StateName">
                           <com:StateName>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:StateName"/>
                           </com:StateName>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:ProvinceName">
                           <com:ProvinceName>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:ProvinceName"/>
                           </com:ProvinceName>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:RuralRoute">
                           <com:RuralRoute>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:RuralRoute/@languageCode">
                                 <xsl:attribute name="languageCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:RuralRoute/@languageCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:RuralRoute/@languageLocaleCode">
                                 <xsl:attribute name="languageLocaleCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:RuralRoute/@languageLocaleCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:RuralRoute"/>
                           </com:RuralRoute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountyName">
                           <com:CountyName>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountyName"/>
                           </com:CountyName>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountryName">
                           <com:CountryName>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountryName"/>
                           </com:CountryName>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountryCode">
                           <com:CountryCode>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountryCode/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountryCode/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountryCode/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountryCode/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountryCode/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountryCode/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountryCode"/>
                           </com:CountryCode>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountrySubDivisionID">
                           <com:CountrySubDivisionID>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountrySubDivisionID/@schemeID">
                                 <xsl:attribute name="schemeID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountrySubDivisionID/@schemeID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountrySubDivisionID/@schemeAgencyID">
                                 <xsl:attribute name="schemeAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountrySubDivisionID/@schemeAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountrySubDivisionID/@schemeVersionID">
                                 <xsl:attribute name="schemeVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountrySubDivisionID/@schemeVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CountrySubDivisionID"/>
                           </com:CountrySubDivisionID>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CitySubDivisionName">
                           <com:CitySubDivisionName>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:CitySubDivisionName"/>
                           </com:CitySubDivisionName>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:ProcessingCode">
                           <com:ProcessingCode>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:ProcessingCode/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:ProcessingCode/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:ProcessingCode/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:ProcessingCode/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:ProcessingCode/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:ProcessingCode/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:ProcessingCode"/>
                           </com:ProcessingCode>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:PostalCode">
                           <com:PostalCode>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:PostalCode/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:PostalCode/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:PostalCode/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:PostalCode/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:PostalCode/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:PostalCode/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:PostalCode"/>
                           </com:PostalCode>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LongPostalCode">
                           <com:LongPostalCode>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LongPostalCode/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LongPostalCode/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LongPostalCode/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LongPostalCode/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LongPostalCode/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LongPostalCode/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:LongPostalCode"/>
                           </com:LongPostalCode>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:GEOCodeID">
                           <com:GEOCodeID>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:GEOCodeID/@schemeID">
                                 <xsl:attribute name="schemeID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:GEOCodeID/@schemeID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:GEOCodeID/@schemeAgencyID">
                                 <xsl:attribute name="schemeAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:GEOCodeID/@schemeAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:GEOCodeID/@schemeVersionID">
                                 <xsl:attribute name="schemeVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:GEOCodeID/@schemeVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:GEOCodeID"/>
                           </com:GEOCodeID>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:InCityLimitIndicator">
                           <com:InCityLimitIndicator>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:InCityLimitIndicator"/>
                           </com:InCityLimitIndicator>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:TimeZoneCode">
                           <com:TimeZoneCode>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:TimeZoneCode/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:TimeZoneCode/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:TimeZoneCode/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:TimeZoneCode/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:TimeZoneCode/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:TimeZoneCode/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:TimeZoneCode"/>
                           </com:TimeZoneCode>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:TypeCode">
                           <com:TypeCode>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:TypeCode/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:TypeCode/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:TypeCode/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:TypeCode/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:TypeCode/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:TypeCode/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:TypeCode"/>
                           </com:TypeCode>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:SubTypeCode">
                           <com:SubTypeCode>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:SubTypeCode/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:SubTypeCode/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:SubTypeCode/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:SubTypeCode/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:SubTypeCode/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:SubTypeCode/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:Address/com:SubTypeCode"/>
                           </com:SubTypeCode>
                        </xsl:if>
                     </com:Address>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GEOCodeID">
                     <com:GEOCodeID>
                        <com:ID>
                           <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GEOCodeID/com:ID"/>
                        </com:ID>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GEOCodeID/com:BusinessComponentID">
                           <com:BusinessComponentID>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GEOCodeID/com:BusinessComponentID/@schemeID">
                                 <xsl:attribute name="schemeID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GEOCodeID/com:BusinessComponentID/@schemeID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GEOCodeID/com:BusinessComponentID/@schemeAgencyID">
                                 <xsl:attribute name="schemeAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GEOCodeID/com:BusinessComponentID/@schemeAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GEOCodeID/com:BusinessComponentID/@schemeVersionID">
                                 <xsl:attribute name="schemeVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GEOCodeID/com:BusinessComponentID/@schemeVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GEOCodeID/com:BusinessComponentID"/>
                           </com:BusinessComponentID>
                        </xsl:if>
                        <xsl:for-each select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GEOCodeID/com:ApplicationObjectReference">
                           <com:ApplicationObjectReference>
                              <xsl:if test="com:ApplicationName">
                                 <com:ApplicationName>
                                    <xsl:value-of select="com:ApplicationName"/>
                                 </com:ApplicationName>
                              </xsl:if>
                              <com:ApplicationObjectID>
                                 <xsl:value-of select="com:ApplicationObjectID"/>
                              </com:ApplicationObjectID>
                           </com:ApplicationObjectReference>
                        </xsl:for-each>
                     </com:GEOCodeID>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:TimeZoneIdentifier">
                     <com:TimeZoneIdentifier>
                        <com:ID>
                           <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:TimeZoneIdentifier/com:ID"/>
                        </com:ID>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:TimeZoneIdentifier/com:BusinessComponentID">
                           <com:BusinessComponentID>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:TimeZoneIdentifier/com:BusinessComponentID/@schemeID">
                                 <xsl:attribute name="schemeID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:TimeZoneIdentifier/com:BusinessComponentID/@schemeID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:TimeZoneIdentifier/com:BusinessComponentID/@schemeAgencyID">
                                 <xsl:attribute name="schemeAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:TimeZoneIdentifier/com:BusinessComponentID/@schemeAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:TimeZoneIdentifier/com:BusinessComponentID/@schemeVersionID">
                                 <xsl:attribute name="schemeVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:TimeZoneIdentifier/com:BusinessComponentID/@schemeVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:TimeZoneIdentifier/com:BusinessComponentID"/>
                           </com:BusinessComponentID>
                        </xsl:if>
                        <xsl:for-each select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:TimeZoneIdentifier/com:ApplicationObjectReference">
                           <com:ApplicationObjectReference>
                              <xsl:if test="com:ApplicationName">
                                 <com:ApplicationName>
                                    <xsl:value-of select="com:ApplicationName"/>
                                 </com:ApplicationName>
                              </xsl:if>
                              <com:ApplicationObjectID>
                                 <xsl:value-of select="com:ApplicationObjectID"/>
                              </com:ApplicationObjectID>
                           </com:ApplicationObjectReference>
                        </xsl:for-each>
                     </com:TimeZoneIdentifier>
                  </xsl:if>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate">
                     <com:GeographicalCoordinate>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:AltitudeMeasure">
                           <com:AltitudeMeasure>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:AltitudeMeasure/@unitCode">
                                 <xsl:attribute name="unitCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:AltitudeMeasure/@unitCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:AltitudeMeasure"/>
                           </com:AltitudeMeasure>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LatitudeMeasure">
                           <com:LatitudeMeasure>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LatitudeMeasure/@unitCode">
                                 <xsl:attribute name="unitCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LatitudeMeasure/@unitCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LatitudeMeasure"/>
                           </com:LatitudeMeasure>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LongitudeMeasure">
                           <com:LongitudeMeasure>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LongitudeMeasure/@unitCode">
                                 <xsl:attribute name="unitCode">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LongitudeMeasure/@unitCode"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LongitudeMeasure"/>
                           </com:LongitudeMeasure>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LatitudeDirectionCode">
                           <com:LatitudeDirectionCode>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LatitudeDirectionCode/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LatitudeDirectionCode/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LatitudeDirectionCode/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LatitudeDirectionCode/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LatitudeDirectionCode/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LatitudeDirectionCode/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LatitudeDirectionCode"/>
                           </com:LatitudeDirectionCode>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LongitudeDirectionCode">
                           <com:LongitudeDirectionCode>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LongitudeDirectionCode/@listID">
                                 <xsl:attribute name="listID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LongitudeDirectionCode/@listID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LongitudeDirectionCode/@listAgencyID">
                                 <xsl:attribute name="listAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LongitudeDirectionCode/@listAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LongitudeDirectionCode/@listVersionID">
                                 <xsl:attribute name="listVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LongitudeDirectionCode/@listVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:LongitudeDirectionCode"/>
                           </com:LongitudeDirectionCode>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:SystemID">
                           <com:SystemID>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:SystemID/@schemeID">
                                 <xsl:attribute name="schemeID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:SystemID/@schemeID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:SystemID/@schemeAgencyID">
                                 <xsl:attribute name="schemeAgencyID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:SystemID/@schemeAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:SystemID/@schemeVersionID">
                                 <xsl:attribute name="schemeVersionID">
                                    <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:SystemID/@schemeVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:to_location/com:GeographicalCoordinate/com:SystemID"/>
                           </com:SystemID>
                        </xsl:if>
                     </com:GeographicalCoordinate>
                  </xsl:if>
               </tns:to_location>
               <tns:appt_nbr>
                  <com:ID>
                     <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:appt_nbr/com:ID"/>
                  </com:ID>
                  <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:appt_nbr/com:BusinessComponentID">
                     <com:BusinessComponentID>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:appt_nbr/com:BusinessComponentID/@schemeID">
                           <xsl:attribute name="schemeID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:appt_nbr/com:BusinessComponentID/@schemeID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:appt_nbr/com:BusinessComponentID/@schemeAgencyID">
                           <xsl:attribute name="schemeAgencyID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:appt_nbr/com:BusinessComponentID/@schemeAgencyID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:if test="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:appt_nbr/com:BusinessComponentID/@schemeVersionID">
                           <xsl:attribute name="schemeVersionID">
                              <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:appt_nbr/com:BusinessComponentID/@schemeVersionID"/>
                           </xsl:attribute>
                        </xsl:if>
                        <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:appt_nbr/com:BusinessComponentID"/>
                     </com:BusinessComponentID>
                  </xsl:if>
                  <xsl:for-each select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:appt_nbr/com:ApplicationObjectReference">
                     <com:ApplicationObjectReference>
                        <xsl:if test="com:ApplicationName">
                           <com:ApplicationName>
                              <xsl:value-of select="com:ApplicationName"/>
                           </com:ApplicationName>
                        </xsl:if>
                        <com:ApplicationObjectID>
                           <xsl:value-of select="com:ApplicationObjectID"/>
                        </com:ApplicationObjectID>
                     </com:ApplicationObjectReference>
                  </xsl:for-each>
               </tns:appt_nbr>
               <tns:appt_start_ts>
                  <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:appt_start_ts"/>
               </tns:appt_start_ts>
               <tns:appt_action_status>
                  <xsl:value-of select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:appt_action_status"/>
               </tns:appt_action_status>
               <xsl:for-each select="/ns0:ProccesAppointmentEBM/ns0:dataArea/ns0:AppointmentEBO/ns0:Desc">
                  <tns:Desc>
                     <tns:item_id>
                        <com:ID>
                           <xsl:value-of select="ns0:item_id/com:ID"/>
                        </com:ID>
                        <xsl:if test="ns0:item_id/com:BusinessComponentID">
                           <com:BusinessComponentID>
                              <xsl:if test="ns0:item_id/com:BusinessComponentID/@schemeID">
                                 <xsl:attribute name="schemeID">
                                    <xsl:value-of select="ns0:item_id/com:BusinessComponentID/@schemeID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="ns0:item_id/com:BusinessComponentID/@schemeAgencyID">
                                 <xsl:attribute name="schemeAgencyID">
                                    <xsl:value-of select="ns0:item_id/com:BusinessComponentID/@schemeAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="ns0:item_id/com:BusinessComponentID/@schemeVersionID">
                                 <xsl:attribute name="schemeVersionID">
                                    <xsl:value-of select="ns0:item_id/com:BusinessComponentID/@schemeVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="ns0:item_id/com:BusinessComponentID"/>
                           </com:BusinessComponentID>
                        </xsl:if>
                        <xsl:for-each select="ns0:item_id/com:ApplicationObjectReference">
                           <com:ApplicationObjectReference>
                              <xsl:if test="com:ApplicationName">
                                 <com:ApplicationName>
                                    <xsl:value-of select="com:ApplicationName"/>
                                 </com:ApplicationName>
                              </xsl:if>
                              <com:ApplicationObjectID>
                                 <xsl:value-of select="com:ApplicationObjectID"/>
                              </com:ApplicationObjectID>
                           </com:ApplicationObjectReference>
                        </xsl:for-each>
                     </tns:item_id>
                     <tns:unit_qty>
                        <xsl:value-of select="ns0:unit_qty"/>
                     </tns:unit_qty>
                     <tns:po_nbr>
                        <com:ID>
                           <xsl:value-of select="ns0:po_nbr/com:ID"/>
                        </com:ID>
                        <xsl:if test="ns0:po_nbr/com:BusinessComponentID">
                           <com:BusinessComponentID>
                              <xsl:if test="ns0:po_nbr/com:BusinessComponentID/@schemeID">
                                 <xsl:attribute name="schemeID">
                                    <xsl:value-of select="ns0:po_nbr/com:BusinessComponentID/@schemeID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="ns0:po_nbr/com:BusinessComponentID/@schemeAgencyID">
                                 <xsl:attribute name="schemeAgencyID">
                                    <xsl:value-of select="ns0:po_nbr/com:BusinessComponentID/@schemeAgencyID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:if test="ns0:po_nbr/com:BusinessComponentID/@schemeVersionID">
                                 <xsl:attribute name="schemeVersionID">
                                    <xsl:value-of select="ns0:po_nbr/com:BusinessComponentID/@schemeVersionID"/>
                                 </xsl:attribute>
                              </xsl:if>
                              <xsl:value-of select="ns0:po_nbr/com:BusinessComponentID"/>
                           </com:BusinessComponentID>
                        </xsl:if>
                        <xsl:for-each select="ns0:po_nbr/com:ApplicationObjectReference">
                           <com:ApplicationObjectReference>
                              <xsl:if test="com:ApplicationName">
                                 <com:ApplicationName>
                                    <xsl:value-of select="com:ApplicationName"/>
                                 </com:ApplicationName>
                              </xsl:if>
                              <com:ApplicationObjectID>
                                 <xsl:value-of select="com:ApplicationObjectID"/>
                              </com:ApplicationObjectID>
                           </com:ApplicationObjectReference>
                        </xsl:for-each>
                     </tns:po_nbr>
                     <tns:document_type>
                        <xsl:value-of select="ns0:document_type"/>
                     </tns:document_type>
                     <xsl:if test="ns0:asn_nbr">
                        <tns:asn_nbr>
                           <com:ID>
                              <xsl:value-of select="ns0:asn_nbr/com:ID"/>
                           </com:ID>
                           <com:BusinessComponentID>
                              <xsl:value-of select="ns0:asn_nbr/com:BusinessComponentID"/>
                           </com:BusinessComponentID>
                           <xsl:for-each select="ns0:asn_nbr/com:ApplicationObjectReference">
                              <com:ApplicationObjectReference>
                                 <com:ApplicationName>
                                    <xsl:value-of select="com:ApplicationName"/>
                                 </com:ApplicationName>
                                 <com:ApplicationObjectID>
                                    <xsl:value-of select="com:ApplicationObjectID"/>
                                 </com:ApplicationObjectID>
                              </com:ApplicationObjectReference>
                           </xsl:for-each>
                        </tns:asn_nbr>
                     </xsl:if>
                  </tns:Desc>
               </xsl:for-each>
            </tns:CitasEBO>
         </tns:dataArea>
      </tns:ProccesCitasEBM>
   </xsl:template>
</xsl:stylesheet>