<xsl:stylesheet version="1.0" exclude-result-prefixes="xsd oracle-xsl-mapper xsi xsl ns0 tns UUIDUserFunction IsUserInGroupFunction oraext IsUserInRoleFunction xp20 DVMFunctions oraxsl RuntimeTypeConversionFunctions XrefFunctions BasicCredentialsUserFunction" xmlns:UUIDUserFunction="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.stages.functions.UUIDUserFunction" xmlns:IsUserInGroupFunction="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.stages.functions.IsUserInGroupFunction" xmlns:oraext="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc" xmlns:IsUserInRoleFunction="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.stages.functions.IsUserInRoleFunction" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20" xmlns:DVMFunctions="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.functions.dvm.DVMFunctions" xmlns:oracle-xsl-mapper="http://www.oracle.com/xsl/mapper/schemas" xmlns:oraxsl="http://www.oracle.com/XSL/Transform/java" xmlns:RuntimeTypeConversionFunctions="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.stages.functions.RuntimeTypeConversionFunctions" xmlns:tns="http://www.agarcia.mx/EnterpriseObjects/CreateOrder" xmlns:XrefFunctions="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.functions.xref.XrefFunctions" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:BasicCredentialsUserFunction="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.stages.functions.BasicCredentialsUserFunction" xmlns:ns0="http://www.agarcia.mx/ftpNadroCreateOrder" xmlns:nxsd="http://xmlns.oracle.com/pcbpel/nxsd" xmlns:com="http://www.agarcia.mx/EnterpriseObjects/Common">
  <oracle-xsl-mapper:schema>
    <!--SPECIFICATION OF MAP SOURCES AND TARGETS, DO NOT MODIFY.-->
    <oracle-xsl-mapper:mapSources>
      <oracle-xsl-mapper:source type="XSD">
        <oracle-xsl-mapper:schema location="ediupack.xsd"/>
        <oracle-xsl-mapper:rootElement name="body" namespace="http://www.agarcia.mx/ftpNadroCreateOrder"/>
      </oracle-xsl-mapper:source>
    </oracle-xsl-mapper:mapSources>
    <oracle-xsl-mapper:mapTargets>
      <oracle-xsl-mapper:target type="XSD">
        <oracle-xsl-mapper:schema location="../../../MetaData/Components/EnterpriseObjectLibrary/EBO/PurchaseOrder/CreateOrderEBM.xsd"/>
        <oracle-xsl-mapper:rootElement name="ProcessCreateOrderEBM" namespace="http://www.agarcia.mx/EnterpriseObjects/CreateOrder"/>
      </oracle-xsl-mapper:target>
    </oracle-xsl-mapper:mapTargets>
    <!--GENERATED BY ORACLE XSL MAPPER 12.2.1.2.0(XSLT Build 161003.0739.0018) AT [MON OCT 26 13:40:37 CST 2020].-->
  </oracle-xsl-mapper:schema>
  <!--User Editing allowed BELOW this line - DO NOT DELETE THIS LINE-->
  <xsl:template match="/">
    <tns:ProcessCreateOrderEBM>
      <tns:DataArea>
        <tns:CreateOrderEBO>
          <tns:FileHead>
            <tns:LineID>
              <xsl:value-of select="/ns0:body/ns0:FHEAD/ns0:LineId"/>
            </tns:LineID>
          </tns:FileHead>
          <xsl:for-each select="/ns0:body/ns0:THEAD">
            <xsl:variable name="flagTHEAD" select="ns0:TransactionNumber"/>
            <tns:HeadOrder>
              <tns:LineID>
                <xsl:value-of select="ns0:LineId"/>
              </tns:LineID>
            </tns:HeadOrder>
            <xsl:for-each select="/ns0:body/ns0:TITEM">
              <xsl:if test="ns0:TransactionNumber = $flagTHEAD">
                <tns:ItemOrder>
                  <tns:LineID>
                    <xsl:value-of select="ns0:LineId"/>
                  </tns:LineID>
                </tns:ItemOrder>
                
                <xsl:variable name="IdsumaItem" select="number(ns0:LineId)+1"/>
                
                <xsl:for-each select="/ns0:body/ns0:TSHIP">
                  <xsl:variable name="Idtship" select="number(ns0:LineId)"/>
                  <xsl:if test="$IdsumaItem = $Idtship">
                    <tns:ShipOrder>
                      <tns:LineID>
                        <xsl:value-of select="ns0:LineId"/>
                      </tns:LineID>
                    </tns:ShipOrder>
                    <xsl:variable name="Idtship" select="number($Idtship) + 1"/>
                    </xsl:if>
                </xsl:for-each>
              
              
              </xsl:if>
            </xsl:for-each>
            <xsl:for-each select="/ns0:body/ns0:TTAIL">
              <xsl:if test="ns0:TransactionNumber = $flagTHEAD">
                <tns:TailOrder>
                  <tns:LineID>
                    <xsl:value-of select="ns0:LineId"/>
                  </tns:LineID>
                </tns:TailOrder>
              </xsl:if>
            </xsl:for-each>
          </xsl:for-each>
          <tns:FileTail>
            <tns:LineID>
              <xsl:value-of select="/ns0:body/ns0:FTAIL/ns0:LineId"/>
            </tns:LineID>
          </tns:FileTail>
        </tns:CreateOrderEBO>
      </tns:DataArea>
    </tns:ProcessCreateOrderEBM>
  </xsl:template>
</xsl:stylesheet>