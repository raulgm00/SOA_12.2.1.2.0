<?xml version = "1.0" encoding = "UTF-8" ?>
<!--
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  Oracle JDeveloper BPEL Designer 
  
  Created: Wed Dec 02 12:58:09 CST 2015
  Author:  francisco-taboada
  Purpose: Synchronous BPEL Process
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
-->
<process name="ConfiguracionEvaluacion"
               targetNamespace="http://xmlns.oracle.com/ConfiguracionProcesos/ConfiguracionEvaluacion/ConfiguracionEvaluacion"
               xmlns="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
               xmlns:client="http://xmlns.oracle.com/ConfiguracionProcesos/ConfiguracionEvaluacion/ConfiguracionEvaluacion"
               xmlns:ora="http://schemas.oracle.com/xpath/extension"
               xmlns:bpelx="http://schemas.oracle.com/bpel/extension"
               xmlns:ns1="http://xmlns.bcie.com/ConfiguracionProcesosService"
               xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
         xmlns:ui="http://xmlns.oracle.com/soa/designer" xmlns:ns2="http://xmlns.bcie.com/ProductoService"
         xmlns:ns3="http://www.bcie.org/ConfiguracionProcesosMO" xmlns:ns4="http://www.bcie.org/ProductoMO"
         xmlns:ns5="http://www.bcie.org/ProductoBO" xmlns:ns12="http://www.bcie.org/ConfiguracionProcesosBO"
         xmlns:ns9="http://www.bcie.org/DeclaracionJuradaBO" xmlns:ns6="http://www.bcie.org/OperacionBO"
         xmlns:ns10="http://www.bcie.org/ResultBO" xmlns:ns8="http://www.bcie.org/CatalogoBO"
         xmlns:ns7="http://www.bcie.org/ClienteBO" xmlns:ns11="http://www.bcie.org/ErrorBO"
         xmlns:ns13="http://www.bcie.com/ConsultarRolesPorProceso"
         xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20"
         xmlns:bpws="http://schemas.xmlsoap.org/ws/2003/03/business-process/"
         xmlns:bpm="http://xmlns.oracle.com/bpmn20/extensions"
         xmlns:oraext="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc"
         xmlns:dvm="http://www.oracle.com/XSL/Transform/java/oracle.tip.dvm.LookupValue"
         xmlns:hwf="http://xmlns.oracle.com/bpel/workflow/xpath"
         xmlns:ids="http://xmlns.oracle.com/bpel/services/IdentityService/xpath"
         xmlns:ess="http://xmlns.oracle.com/scheduler"
         xmlns:xdk="http://schemas.oracle.com/bpel/extension/xpath/function/xdk"
         xmlns:xref="http://www.oracle.com/XSL/Transform/java/oracle.tip.xref.xpath.XRefXPathFunctions"
         xmlns:ldap="http://schemas.oracle.com/xpath/extension/ldap"
         xmlns:ns15="http://www.bcie.org/ConsultarRolesPorProcesoBO"
         xmlns:ns14="http://www.bcie.org/ConsultarRolesPorProcesoMO" xmlns:xsd="http://www.w3.org/2001/XMLSchema"
         xmlns:ns19="http://www.bcie.org/TerminoBO" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns:ns22="http://www.bcie.org/CommonBO" xmlns:ns17="http://www.bcie.org/LineaCreditoBO"
         xmlns:ns18="http://www.bcie.org/CondicionBO" xmlns:ns23="http://www.bcie.org/HerramientaCEBO"
         xmlns:ns20="http://www.bcie.org/ComisionBO" xmlns:ns21="http://www.bcie.org/DesembolsoBO"
         xmlns:ns16="http://www.bcie.org/ContratoBO"
         xmlns:ns29="http://xmlns.bcie.org/ObjetoProceso/Comun/Parameter/V1"
         xmlns:ns25="http://xmlns.bcie.org/ObjetoProceso/Comun/Operacion/V1"
         xmlns:ns28="http://xmlns.bcie.org/ObjetoProceso/Comun/Proceso/V1"
         xmlns:ns24="http://xmlns.bcie.org/ObjetoProceso/Comun/Header/V1"
         xmlns:ns27="http://xmlns.bcie.org/ObjetoProceso/Comun/Tarea/V1"
         xmlns:ns26="http://xmlns.bcie.org/ObjetoProceso/Comun/Cliente/V1" xmlns:ns31="http://www.bcie.org/DocumentoBO"
         xmlns:ns30="http://www.bcie.org/AtributoBO" xmlns:ns32="http://xmlns.bcie.org/EvaluacionService"
         xmlns:ns33="http://www.bcie.org/EvaluacionMO" xmlns:ns34="http://www.bcie.org/EvaluacionBO"
         xmlns:ns35="http://xmlns.bcie.com/EvaluacionService">

  <!-- 
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
      PARTNERLINKS                                                      
      List of services participating in this BPEL process               
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  -->
  <import namespace="http://xmlns.bcie.com/EvaluacionService"
          location="oramds:/apps/Resources/ComponentesComunes/DominioOperacion/Evaluacion/V1/Wsdl/BPEL/CrearEvaluacionSOR.wsdl"
          importType="http://schemas.xmlsoap.org/wsdl/"/>
  <import namespace="http://xmlns.bcie.com/EvaluacionService"
          location="oramds:/apps/Resources/ComponentesComunes/DominioOperacion/Evaluacion/V1/Wsdl/ADAPTER/DuplicarEvaluacionSAD.wsdl"
          importType="http://schemas.xmlsoap.org/wsdl/"/>
  <import namespace="http://xmlns.bcie.com/EvaluacionService"
          location="oramds:/apps/Resources/ComponentesComunes/DominioOperacion/Evaluacion/V1/Wsdl/Evaluacion.wsdl"
          importType="http://schemas.xmlsoap.org/wsdl/"/>
  <import namespace="http://xmlns.bcie.org/EvaluacionService"
          location="oramds:/apps/Resources/ComponentesComunes/DominioOperacion/Evaluacion/V1/Wsdl/ADAPTER/ConsultarEvaluacionFenixSAD.wsdl"
          importType="http://schemas.xmlsoap.org/wsdl/"/>
  <import namespace="http://xmlns.bcie.com/ConfiguracionProcesosService"
          location="../WSDLs/ConfiguracionEvaluacionSORWrapper.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"
          ui:processWSDL="true"/>
  <partnerLinks>
    <!-- 
      The 'client' role represents the requester of this service. It is 
      used for callback. The location and correlation information associated
      with the client role are automatically set using WS-Addressing.
    -->
    <partnerLink name="configuracionevaluacion_client" partnerLinkType="ns1:ConfiguracionEvaluacion" myRole="ConfigurarEvaluacionPT"/>
    <partnerLink name="ProductoService" partnerLinkType="ns2:ProductoService" partnerRole="ProductoPT"/>
    <partnerLink name="ConsultarRol" partnerLinkType="ns13:ConsultarRol" partnerRole="ConsultarRolesPorProceso_ptt"/>
    <partnerLink name="ConsultarEvaluacionFenix_PS" partnerLinkType="ns32:ConsultarEvaluacionFenix_PS"
                 partnerRole="ConsultarEvaluacionFenixPT"/>
    <partnerLink name="CrearEvaluacionFenix_PS" partnerLinkType="ns35:CrearEvaluacionFenix_PS"
                 partnerRole="EvaluacionPT"/>
    <partnerLink name="DuplicarEvaluacion_PS" partnerLinkType="ns35:DuplicarEvaluacion_PS"
                 partnerRole="DuplicarEvaluacionPT"/>
    <partnerLink name="ConsultarEvaluacionesEVAL_PS" partnerLinkType="ns35:ConsultarEvaluacionesEVAL_PS"
                 partnerRole="EvaluacionPT"/>
  </partnerLinks>

  <!-- 
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
      VARIABLES                                                        
      List of messages and XML documents used within this BPEL process 
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  -->
  <variables>
    <!-- Reference to the message passed as input during initiation -->
    <variable name="inputVariable" messageType="ns1:requestconfiguracionEvaluacionmessage"/>

    <!-- Reference to the message that will be returned to the requester-->
    <variable name="outputVariable" messageType="ns1:responseconfiguracionEvaluacionmessage"/>
    <variable name="InConsultarProducto" messageType="ns2:requestConsultarByIdOperacionMessage"/>
    <variable name="OutConsultarProducto" messageType="ns2:responseConsultarByIdOperacionMessage"/>
    <variable name="setTitleVar" type="xsd:string"/>
    <variable name="outConsultarConsultarRolPorProceso" messageType="ns13:replyMessage"/>
    <!--<variable name="inConsultarEvaluacionFenix" messageType="ns32:ConsultarEvaluacionFenixRequestMessage"/>-->
    <!--<variable name="outConsultarEvaluacionFenix" messageType="ns32:ConsultarEvaluacionFenixResponseMessage"/>-->
    <variable name="inDuplicarEvaluacion" messageType="ns35:DuplicarEvaluacionRequestMessage"/>
    <variable name="outDuplicarEvaluacion" messageType="ns35:DuplicarEvaluacionResponseMessage"/>
    <variable name="inCrearEvaluacion" messageType="ns35:requestCrearEvaluacionMessage"/>
    <variable name="outCrearEvaluacion" messageType="ns35:responseCrearEvaluacionMessage"/>
    <variable name="inConsultarEvaluacionEVAL" messageType="ns35:requestConsultarEvaluacionMessage"/>
    <variable name="outConsultarEvaluacionEVAL" messageType="ns35:responseConsultarEvaluacionMessage"/>
    <variable name="Evaluacion" messageType="ns35:responseConsultarEvaluacionMessage"/>
    <variable name="outCrearEvaluacionEVAL" messageType="ns35:responseCrearEvaluacionMessage"/>
  </variables>
  <faultHandlers>
    <catchAll>
      <sequence name="CatchAll">
        <assign name="AssignERROR">
          <copy>
            <from>'ERROR'</from>
            <to>$outputVariable.response/ns3:Resultado/ns10:result</to>
          </copy>
          <copy>
            <from>ora:getFaultAsString()</from>
            <to>$outputVariable.response/ns3:Resultado/ns10:message</to>
          </copy>
        </assign>
        <reply name="ReplyERROR" variable="outputVariable" partnerLink="configuracionevaluacion_client"
               portType="ns1:ConfigurarEvaluacionPT" operation="configurarEvaluacion"/>
      </sequence>
    </catchAll>
  </faultHandlers>
  <!-- 
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
     ORCHESTRATION LOGIC                                               
     Set of activities coordinating the flow of messages across the    
     services integrated within this business process                  
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  -->
  <sequence name="main">

    <!-- Receive input from requestor. (Note: This maps to operation defined in ConfiguracionEvaluacion.wsdl) -->
    <receive name="receiveInput" partnerLink="configuracionevaluacion_client" portType="ns1:ConfigurarEvaluacionPT" operation="configurarEvaluacion" variable="inputVariable" createInstance="yes"/>
    <assign name="setTitleInstance">
      <copy>
        <from>oraext:setFlowInstanceTitle(concat("idOperacion= ", $inputVariable.request/ns3:idOperacion))</from>
        <to>$setTitleVar</to>
      </copy>
      <copy ignoreMissingFromData="yes" bpelx:insertMissingToData="yes">
        <from>number($inputVariable.request/ns3:Parameters[ns22:name = 'TIPO_EVALUACION']/ns22:value)</from>
        <to>$inputVariable.request/ns3:idTipoEvaluacion</to>
      </copy>
    </assign>
    <scope name="ConsultarProducto">
      <sequence name="ConsultarProducto">
        <assign name="AssignConsultarProducto">
          <copy>
            <from>$inputVariable.request/ns3:idOperacion</from>
            <to>$InConsultarProducto.request/ns4:idOperacion</to>
          </copy>
        </assign>
        <invoke name="InvokeConsultarProducto" partnerLink="ProductoService" portType="ns2:ProductoPT"
                operation="consultarByIdOperacion" inputVariable="InConsultarProducto"
                outputVariable="OutConsultarProducto" bpelx:invokeAsDetail="no"/>
        <if name="IfValidaOK">
          <documentation>
            <![CDATA[OK]]>
          </documentation>
          <condition>$OutConsultarProducto.response/ns4:Resultado/ns10:result = 'OK'</condition>
          <empty name="OK"/>
          <else>
            <documentation>
              <![CDATA[ERROR]]>
            </documentation>
            <sequence name="Error">
              <assign name="errorConsultarProducto">
                <copy>
                  <from>'ERROR'</from>
                  <to>$outputVariable.response/ns3:Resultado/ns10:result</to>
                </copy>
                <copy>
                  <from>concat("Error en el servicio ConsultarProducto: ",$OutConsultarProducto.response/ns4:Resultado/ns10:message)</from>
                  <to>$outputVariable.response/ns3:Resultado/ns10:message</to>
                </copy>
              </assign>
              <reply name="ReplyError" variable="outputVariable" partnerLink="configuracionevaluacion_client"
                     portType="ns1:ConfigurarEvaluacionPT" operation="configurarEvaluacion"/>
              <exit name="Error"/>
            </sequence>
          </else>
        </if>
      </sequence>
    </scope><scope name="ConsultarRolesPorProceso">
      <variables>
        <variable name="inConsultarConsultarRolPorProceso" messageType="ns13:requestMessage"/>
      </variables>
      <sequence name="ConsultarRolesPorProceso">
        <if name="IfTipoEvaluacion">
          <documentation>
            <![CDATA[SEGUIMIENTO SIEMAS]]>
          </documentation>
          <condition>$inputVariable.request/ns3:Parameters[ns22:name= 'TIPO_EVALUACION']/ns22:value = 4 or $inputVariable.request/ns3:Parameters[ns22:name= 'TIPO_EVALUACION']/ns22:value = 5</condition><assign name="AssignInconsultarROL"
                                                                                                                           xmlns="http://docs.oasis-open.org/wsbpel/2.0/process/executable">
      
   <copy>
         <from>31</from>
         <to>$inConsultarConsultarRolPorProceso.request/ns14:Proceso/ns15:idProceso</to>
      </copy></assign><else>
            <documentation>
              <![CDATA[OTRA]]>
            </documentation>
            <assign name="AssignInconsultarROL" xmlns="http://docs.oasis-open.org/wsbpel/2.0/process/executable">
              <copy>
                <from>6</from>
                <to>$inConsultarConsultarRolPorProceso.request/ns14:Proceso/ns15:idProceso</to>
              </copy>
            </assign>
          </else>
        </if>
        <invoke name="InvokeConsultarConsultarRolPorProceso" partnerLink="ConsultarRol" portType="ns13:ConsultarRolesPorProceso_ptt"
                operation="ConsultarRolesPorProceso" inputVariable="inConsultarConsultarRolPorProceso"
                outputVariable="outConsultarConsultarRolPorProceso"
                bpelx:invokeAsDetail="no"/>
        <if name="IfValidaOK">
          <documentation>
            <![CDATA[OK]]>
          </documentation>
          <condition>$outConsultarConsultarRolPorProceso.response/ns14:Result/ns10:result  = 'OK'</condition>
          <assign name="XQ_ResponseConfiguracionEvaluacion">
            <bpelx:annotation>
              <bpelx:pattern patternName="bpelx:xquery"></bpelx:pattern>
            </bpelx:annotation>
            <copy>
              <from>ora:processXQuery10('../Transformations/XQ_ResponseConfiguracionEvaluacion.xqy', 'inputVariable.request', $inputVariable.request, 'OutConsultarProducto.response', $OutConsultarProducto.response, 'outConsultarConsultarRolPorProceso.response', $outConsultarConsultarRolPorProceso.response)</from>
              <to variable="outputVariable" part="response"/>
            </copy>
          </assign>
          <else>
            <documentation>
              <![CDATA[ERROR]]>
            </documentation>
            <sequence name="Error">
              <assign name="errorConsultarRolesPorProceso">
                <copy>
                  <from>'ERROR'</from>
                  <to>$outputVariable.response/ns3:Resultado/ns10:result</to>
                </copy>
                <copy>
                  <from>concat("Error en el servicio ConsultarRolesPorProceso: ",$outConsultarConsultarRolPorProceso.response/ns14:Result/ns10:message)</from>
                  <to>$outputVariable.response/ns3:Resultado/ns10:message</to>
                </copy>
              </assign>
              <reply name="ReplyError" variable="outputVariable" partnerLink="configuracionevaluacion_client"
                     portType="ns1:ConfigurarEvaluacionPT" operation="configurarEvaluacion"/>
              <exit name="Error"/>
            </sequence>
          </else>
        </if>
      </sequence>
    </scope>
    <if name="IfTipoEvaluacion">
      <documentation>
        <![CDATA[tipoEval_1]]>
      </documentation>
      <condition>$inputVariable.request/ns3:idTipoEvaluacion = 1</condition>
      <empty name="idTipoEval_1"/>
      <else>
        <documentation>
          <![CDATA[otroTipoEval]]>
        </documentation>
        <if name="IfTipoEvaluacion">
          <documentation>
            <![CDATA[tipoEval_2]]>
          </documentation>
          <condition>$inputVariable.request/ns3:idTipoEvaluacion = 2</condition>
          <scope name="ScopeConsultarEvaluacionFenixTipoEVAL_2">
            <sequence name="SequenceConsultarEvaluacionFenix">
              <assign name="assignIdOperacion">
                <copy bpelx:insertMissingToData="yes">
                  <from>$inputVariable.request/ns3:idOperacion</from>
                  <to>$inConsultarEvaluacionEVAL.request/ns33:Evaluacion/ns34:idOperacion</to>
                </copy>
                <copy bpelx:insertMissingToData="yes">
                  <from>'IBCIE'</from>
                  <to>$inConsultarEvaluacionEVAL.request/ns33:Evaluacion/ns34:descripcionTipoEvaluacion</to>
                </copy>
                <copy bpelx:insertMissingToData="yes">
                  <from>'1'</from>
                  <to>$inConsultarEvaluacionEVAL.request/ns33:Evaluacion/ns34:catEvaluacion/ns8:Id</to>
                </copy>
              </assign>
              <invoke name="InvokeConsultarEvaluacionEVAL" inputVariable="inConsultarEvaluacionEVAL"
                      outputVariable="outConsultarEvaluacionEVAL"
                      partnerLink="ConsultarEvaluacionesEVAL_PS" portType="ns35:EvaluacionPT"
                      operation="ConsultarEvaluacion" bpelx:invokeAsDetail="no"/>
              <if name="IfOKConultarEval">
                <documentation>
                  <![CDATA[OK]]>
                </documentation>
                <condition>$outConsultarEvaluacionEVAL.response/ns33:Resultado/ns10:result = 'OK' and  count($outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion) &gt; 0</condition>
                <scope name="ScopeDuplicarEvaluacion">
                  <sequence name="SequenceDuplicarEvaluacion">
                    <assign name="assignIdOperacion">
                      <copy bpelx:insertMissingToData="yes">
                        <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:idEvaluacion</from>
                        <to>$inDuplicarEvaluacion.request/ns33:Evaluacion/ns34:Id</to>
                      </copy>
                      <copy bpelx:insertMissingToData="yes">
                        <from>$inputVariable.request/ns3:idOperacion</from>
                        <to>$inDuplicarEvaluacion.request/ns33:Evaluacion/ns34:Operacion/ns6:idOperacion</to>
                      </copy>
                      <copy bpelx:insertMissingToData="yes">
                        <from>'2'</from>
                        <to>$inDuplicarEvaluacion.request/ns33:Evaluacion/ns34:TipoEvaluacion/ns8:Id</to>
                      </copy>
                      <copy bpelx:insertMissingToData="yes">
                        <from>$inputVariable.request/ns3:loginUsuario</from>
                        <to>$inDuplicarEvaluacion.request/ns33:Evaluacion/ns34:LoginUsuario</to>
                      </copy>
                    </assign>
                    <invoke name="InvokeDuplicarEvaluacion" bpelx:invokeAsDetail="no"
                            partnerLink="DuplicarEvaluacion_PS" portType="ns35:DuplicarEvaluacionPT"
                            operation="DuplicarEvaluacion" inputVariable="inDuplicarEvaluacion"
                            outputVariable="outDuplicarEvaluacion"/>
                    <if name="IfOKDuplicarEvaluacion">
                      <documentation>
                        <![CDATA[OK]]>
                      </documentation>
                      <condition>$outDuplicarEvaluacion.response/ns33:Resultado/ns10:result = 'OK'</condition>
                      <scope name="ScopeCrearEvaluacionFenix">
                        <sequence name="SequenceCrearEvaluacion">
                          <assign name="assignIdEval">
                            <copy bpelx:insertMissingToData="yes">
                              <from>'0'</from>
                              <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:id</to>
                            </copy>
                            <copy>
                              <from>$outDuplicarEvaluacion.response/ns33:codigoEvaluacion</from>
                              <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:idEvaluacion</to>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes">
                              <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:idOperacion</from>
                              <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:idOperacion</to>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes">
                              <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:idSectorIBCIE</from>
                              <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:idSectorIBCIE</to>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes">
                              <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:SectorIBCIE</from>
                              <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:SectorIBCIE</to>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes">
                              <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:idSubSectorIBCIE</from>
                              <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:idSubSectorIBCIE</to>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes">
                              <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:subSectorIBCIE</from>
                              <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:subSectorIBCIE</to>
                            </copy>
                            <extensionAssignOperation>
                              <bpelx:copyList ignoreMissingFromData="yes">
                                <bpelx:from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = '']/ns34:cuestionarios/ns34:cuestionario</bpelx:from>
                                <bpelx:to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:cuestionarios/ns34:cuestionario</bpelx:to>
                              </bpelx:copyList>
                            </extensionAssignOperation>
                            <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes">
                              <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:enAnalisis</from>
                              <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:enAnalisis</to>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes">
                              <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:banEstatus</from>
                              <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:banEstatus</to>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes">
                              <from>'2'</from>
                              <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:tipoEvaluacion</to>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes">
                              <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:version</from>
                              <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:version</to>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes">
                              <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:codigoExterno</from>
                              <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:codigoExterno</to>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes">
                              <from>'2'</from>
                              <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:catEvaluacion/ns8:Id</to>
                            </copy>
                            <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes">
                              <from>$inputVariable.request/ns3:instanciaProceso</from>
                              <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:instanciaProceso</to>
                            </copy>
                          </assign>
                          <invoke name="InvokeCrearEvaluacion" bpelx:invokeAsDetail="no"
                                  partnerLink="CrearEvaluacionFenix_PS" portType="ns35:EvaluacionPT"
                                  operation="crearEvaluacion" inputVariable="inCrearEvaluacion"
                                  outputVariable="outCrearEvaluacion"/>
                        </sequence>
                      </scope>
                      <else>
                        <documentation>
                          <![CDATA[ERROR]]>
                        </documentation>
                        <sequence name="SequenceErrorDuplicarEVAL">
                          <assign name="assignError">
                            <copy>
                              <from>$outDuplicarEvaluacion.response/ns33:Resultado</from>
                              <to>$outputVariable.response/ns3:Resultado</to>
                            </copy>
                          </assign>
                          <reply name="ReplyErrorDuplicarEVAL" variable="outputVariable"
                                 partnerLink="configuracionevaluacion_client" portType="ns1:ConfigurarEvaluacionPT"
                                 operation="configurarEvaluacion"/>
                        </sequence>
                      </else>
                    </if>
                  </sequence>
                </scope>
                <else>
                  <documentation>
                    <![CDATA[ERROR]]>
                  </documentation>
                  <sequence name="SequenceError">
                    <assign name="assignError">
                      <copy>
                        <from>concat('No hay evaluaciones a duplicar u ocurrio un error: ',$outConsultarEvaluacionEVAL.response/ns33:Resultado/ns10:message)</from>
                        <to>$outputVariable.response/ns3:Resultado/ns10:message</to>
                      </copy>
                      <copy>
                        <from>'ERROR'</from>
                        <to>$outputVariable.response/ns3:Resultado/ns10:result</to>
                      </copy>
                    </assign>
                  </sequence>
                </else>
              </if>
            </sequence>
          </scope>
          <else>
            <documentation>
              <![CDATA[otroTipoEval]]>
            </documentation>
            <if name="IfTipoEvaluacion">
              <documentation>
                <![CDATA[tipoEval_3]]>
              </documentation>
              <condition>$inputVariable.request/ns3:idTipoEvaluacion = 3</condition><scope name="ScopeConsultarEvaluacionFenixTipoEVAL_3"
                                                                                           xmlns="http://docs.oasis-open.org/wsbpel/2.0/process/executable">
      <sequence name="SequenceConsultarEvaluacionFenix">
         <assign name="assignIdOperacion">
            
            
            
         <copy bpelx:insertMissingToData="yes" xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
               <from>$inputVariable.request/ns3:idOperacion</from>
               <to>$inConsultarEvaluacionEVAL.request/ns33:Evaluacion/ns34:idOperacion</to>
            </copy><copy bpelx:insertMissingToData="yes" xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
               <from>'IBCIE'</from>
               <to>$inConsultarEvaluacionEVAL.request/ns33:Evaluacion/ns34:descripcionTipoEvaluacion</to>
            </copy><copy bpelx:insertMissingToData="yes" xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
               <from>'2'</from>
               <to>$inConsultarEvaluacionEVAL.request/ns33:Evaluacion/ns34:catEvaluacion/ns8:Id</to>
            </copy></assign>
         <invoke name="InvokeConsultarEvaluacionEVAL" inputVariable="inConsultarEvaluacionEVAL"
                 outputVariable="outConsultarEvaluacionEVAL" partnerLink="ConsultarEvaluacionesEVAL_PS"
                 portType="ns35:EvaluacionPT" operation="ConsultarEvaluacion" bpelx:invokeAsDetail="no"
                 xmlns:bpelx="http://schemas.oracle.com/bpel/extension"/>
         <if name="IfOKConultarEval">
            <documentation>
               <![CDATA[OK]]>
            </documentation>
            <condition>$outConsultarEvaluacionEVAL.response/ns33:Resultado/ns10:result = 'OK' and count($outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion) &gt; 0</condition>
            <scope name="ScopeDuplicarEvaluacion">
               <sequence name="SequenceDuplicarEvaluacion">
                  <assign name="assignIdOperacion">
                     
                     
                     
                     
                  <copy bpelx:insertMissingToData="yes" xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                        <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:idEvaluacion</from>
                        <to>$inDuplicarEvaluacion.request/ns33:Evaluacion/ns34:Id</to>
                     </copy><copy bpelx:insertMissingToData="yes"
                                  xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                        <from>$inputVariable.request/ns3:idOperacion</from>
                        <to>$inDuplicarEvaluacion.request/ns33:Evaluacion/ns34:Operacion/ns6:idOperacion</to>
                     </copy><copy bpelx:insertMissingToData="yes"
                                  xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                        <from>'3'</from>
                        <to>$inDuplicarEvaluacion.request/ns33:Evaluacion/ns34:TipoEvaluacion/ns8:Id</to>
                     </copy><copy bpelx:insertMissingToData="yes"
                                  xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                        <from>$inputVariable.request/ns3:loginUsuario</from>
                        <to>$inDuplicarEvaluacion.request/ns33:Evaluacion/ns34:LoginUsuario</to>
                     </copy></assign>
                  <invoke name="InvokeDuplicarEvaluacion" bpelx:invokeAsDetail="no" partnerLink="DuplicarEvaluacion_PS"
                          portType="ns35:DuplicarEvaluacionPT" operation="DuplicarEvaluacion"
                          inputVariable="inDuplicarEvaluacion" outputVariable="outDuplicarEvaluacion"
                          xmlns:bpelx="http://schemas.oracle.com/bpel/extension"/>
                  <if name="IfOKDuplicarEvaluacion">
                     <documentation>
                        <![CDATA[OK]]>
                     </documentation>
                     <condition>$outDuplicarEvaluacion.response/ns33:Resultado/ns10:result = 'OK'</condition>
                     <scope name="ScopeCrearEvaluacionFenix">
                        <sequence name="SequenceCrearEvaluacion">
                           <assign name="assignIdEval">
                                <copy bpelx:insertMissingToData="yes">
                                  <from>'0'</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:id</to>
                                </copy>
                                <copy>
                                  <from>$outDuplicarEvaluacion.response/ns33:codigoEvaluacion</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:idEvaluacion</to>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes"
                                      xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                                  <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:idOperacion</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:idOperacion</to>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes"
                                      xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                                  <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:tituloEvaluacion</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:tituloEvaluacion</to>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes"
                                      xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                                  <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:idSectorIBCIE</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:idSectorIBCIE</to>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes"
                                      xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                                  <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:SectorIBCIE</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:SectorIBCIE</to>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes"
                                      xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                                  <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:idSubSectorIBCIE</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:idSubSectorIBCIE</to>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes"
                                      xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                                  <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:subSectorIBCIE</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:subSectorIBCIE</to>
                                </copy>
                                <extensionAssignOperation>
                                  <bpelx:copyList ignoreMissingFromData="yes"
                                                  xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                                    <bpelx:from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = '']/ns34:cuestionarios/ns34:cuestionario</bpelx:from>
                                    <bpelx:to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:cuestionarios/ns34:cuestionario</bpelx:to>
                                  </bpelx:copyList>
                                </extensionAssignOperation>
                                <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes"
                                      xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                                  <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:enAnalisis</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:enAnalisis</to>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes"
                                      xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                                  <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:banEstatus</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:banEstatus</to>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes"
                                      xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                                  <from>'3'</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:tipoEvaluacion</to>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes"
                                      xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                                  <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:descripcionTipoEvaluacion</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:descripcionTipoEvaluacion</to>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes"
                                      xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                                  <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:version</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:version</to>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes"
                                      xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                                  <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:codigoUsuario</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:codigoUsuario</to>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes"
                                      xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                                  <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:nombreUsuario</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:nombreUsuario</to>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes"
                                      xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                                  <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:Porcentaje</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:Porcentaje</to>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes"
                                      xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                                  <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:PorcentajeObligatorio</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:PorcentajeObligatorio</to>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes"
                                      xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                                  <from>$outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacionOrigen = ''][1]/ns34:codigoExterno</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:codigoExterno</to>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes"
                                      xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                                  <from>'3'</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:catEvaluacion/ns8:Id</to>
                                </copy>
                                <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes"
                                      xmlns:bpelx="http://schemas.oracle.com/bpel/extension">
                                  <from>$inputVariable.request/ns3:instanciaProceso</from>
                                  <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:instanciaProceso</to>
                                </copy>
                              </assign>
                           <invoke name="InvokeCrearEvaluacion" bpelx:invokeAsDetail="no"
                                   partnerLink="CrearEvaluacionFenix_PS" portType="ns35:EvaluacionPT"
                                   operation="crearEvaluacion" inputVariable="inCrearEvaluacion"
                                   outputVariable="outCrearEvaluacion"
                                   xmlns:bpelx="http://schemas.oracle.com/bpel/extension"/>
                        </sequence>
                     </scope>
                     <else>
                        <documentation>
                           <![CDATA[ERROR]]>
                        </documentation>
                        <sequence name="SequenceErrorDuplicarEVAL">
                           <assign name="assignError">
                              <copy>
                                 <from>$outDuplicarEvaluacion.response/ns33:Resultado</from>
                                 <to>$outputVariable.response/ns3:Resultado</to>
                              </copy>
                           </assign>
                           <reply name="ReplyErrorDuplicarEVAL" variable="outputVariable"
                                  partnerLink="configuracionevaluacion_client" portType="ns1:ConfigurarEvaluacionPT"
                                  operation="configurarEvaluacion"/>
                        </sequence>
                     </else>
                  </if>
               </sequence>
            </scope>
            <else>
               <documentation>
                  <![CDATA[ERROR]]>
               </documentation>
               <sequence name="SequenceError">
                  <assign name="assignError">
                     <copy>
                        <from>concat('No hay evaluaciones a duplicar u ocurrio un error: ',$outConsultarEvaluacionEVAL.response/ns33:Resultado/ns10:message)</from>
                        <to>$outputVariable.response/ns3:Resultado/ns10:message</to>
                     </copy>
                     <copy>
                        <from>'ERROR'</from>
                        <to>$outputVariable.response/ns3:Resultado/ns10:result</to>
                     </copy>
                  </assign>
               </sequence>
            </else>
         </if>
      </sequence>
   </scope><else>
                <documentation>
                  <![CDATA[otroTipoEval]]>
                </documentation>
                <if name="IfTipoEvaluacion">
                  <documentation>
                    <![CDATA[tipoEval_4 or tipoEval_5]]>
                  </documentation>
                  <condition>$inputVariable.request/ns3:idTipoEvaluacion = 4 or $inputVariable.request/ns3:idTipoEvaluacion = 5</condition>
                  <scope name="ScopeConsultarEvaluacionEVAL">
                    <sequence name="SequenceConsultarEvaluacionEVAL">
                      <assign name="assignIdOperacion">
                        <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes">
                          <from>$inputVariable.request/ns3:idOperacion</from>
                          <to>$inConsultarEvaluacionEVAL.request/ns33:Evaluacion/ns34:idOperacion</to>
                        </copy>
                        <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes">
                          <from>'SIEMAS'</from>
                          <to>$inConsultarEvaluacionEVAL.request/ns33:Evaluacion/ns34:descripcionTipoEvaluacion</to>
                        </copy>
                      </assign>
                      <invoke name="InvokeConsultarEvaluacionEVAL" bpelx:invokeAsDetail="no"
                              partnerLink="ConsultarEvaluacionesEVAL_PS" portType="ns35:EvaluacionPT"
                              operation="ConsultarEvaluacion" inputVariable="inConsultarEvaluacionEVAL"
                              outputVariable="outConsultarEvaluacionEVAL"/>
                      <assign name="ObtenerEvaluacion">
                        <bpelx:annotation>
                          <bpelx:pattern patternName="bpelx:xquery"></bpelx:pattern>
                        </bpelx:annotation>
                        <copy>
                          <from>ora:processXQuery10('../Transformations/ConsultarEvaluacionEVAL_TO_Evaluacion.xqy', 'outConsultarEvaluacionEVAL.response', $outConsultarEvaluacionEVAL.response)</from>
                          <to variable="Evaluacion" part="response"/>
                        </copy>
                      </assign>
                      <if name="IfOKConsultarEvaluacion">
                        <documentation>
                          <![CDATA[OK]]>
                        </documentation>
                        <condition>$outConsultarEvaluacionEVAL.response/ns33:Resultado/ns10:result = 'OK' and count($outConsultarEvaluacionEVAL.response/ns33:Evaluaciones/ns34:evaluacion) &gt; 0</condition>
                        <scope name="ScopeDuplicarEVAL">
                          <sequence name="SequenceDuplicarEVAL">
                            <assign name="assigEVAL">
                              <copy ignoreMissingFromData="no" bpelx:insertMissingToData="yes">
                                <from>$Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[1]/ns34:idEvaluacion</from>
                                <to>$inDuplicarEvaluacion.request/ns33:Evaluacion/ns34:Id</to>
                              </copy>
                              <copy>
                                <from>4</from>
                                <to>$inDuplicarEvaluacion.request/ns33:Evaluacion/ns34:TipoEvaluacion/ns8:Id</to>
                              </copy>
                              <copy bpelx:insertMissingToData="yes">
                                <from>$inputVariable.request/ns3:idOperacion</from>
                                <to>$inDuplicarEvaluacion.request/ns33:Evaluacion/ns34:Operacion/ns6:idOperacion</to>
                              </copy>
                              <copy bpelx:insertMissingToData="yes">
                                <from>$inputVariable.request/ns3:loginUsuario</from>
                                <to>$inDuplicarEvaluacion.request/ns33:Evaluacion/ns34:LoginUsuario</to>
                              </copy>
                            </assign>
                            <invoke name="InvokeDuplicarEVAL" bpelx:invokeAsDetail="no"
                                    partnerLink="DuplicarEvaluacion_PS" portType="ns35:DuplicarEvaluacionPT"
                                    operation="DuplicarEvaluacion" inputVariable="inDuplicarEvaluacion"
                                    outputVariable="outDuplicarEvaluacion"/>
                            <if name="IfOKDuplicarEVAL">
                              <documentation>
                                <![CDATA[OK]]>
                              </documentation>
                              <condition>$outDuplicarEvaluacion.response/ns33:Resultado/ns10:result = 'OK'</condition>
                              <scope name="ScopeCrearEvaluacionFenix">
                                <sequence name="SequenceCrearEvaluacionFenix">
                                  <assign name="assigEvaluacion">
                                    <copy>
                                      <from>0</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:id</to>
                                    </copy>
                                    <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes">
                                      <from>$inputVariable.request/ns3:idOperacion</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:idOperacion</to>
                                    </copy>
                                    <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes">
                                      <from>$outDuplicarEvaluacion.response/ns33:codigoEvaluacion</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:idEvaluacion</to>
                                    </copy>
                                    <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes">
                                      <from>$Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[1]/ns34:tituloEvaluacion</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:tituloEvaluacion</to>
                                    </copy>
                                    <copy bpelx:insertMissingToData="yes" ignoreMissingFromData="yes">
                                      <from>$Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[1]/ns34:idSectorIBCIE</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:idSectorIBCIE</to>
                                    </copy>
                                    <copy ignoreMissingFromData="yes" bpelx:insertMissingToData="yes">
                                      <from>$Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[1]/ns34:SectorIBCIE</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:SectorIBCIE</to>
                                    </copy>
                                    <copy ignoreMissingFromData="yes" bpelx:insertMissingToData="yes">
                                      <from>$Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[1]/ns34:idSubSectorIBCIE</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:idSubSectorIBCIE</to>
                                    </copy>
                                    <copy ignoreMissingFromData="yes" bpelx:insertMissingToData="yes">
                                      <from>$Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[1]/ns34:subSectorIBCIE</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:subSectorIBCIE</to>
                                    </copy>
                                    <extensionAssignOperation>
                                      <bpelx:copyList ignoreMissingFromData="yes">
                                        <bpelx:from>$Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[ns34:idEvaluacion = $Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[1]/ns34:idEvaluacion ]/ns34:cuestionarios/ns34:cuestionario</bpelx:from>
                                        <bpelx:to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:cuestionarios/ns34:cuestionario</bpelx:to>
                                      </bpelx:copyList>
                                    </extensionAssignOperation>
                                    <copy ignoreMissingFromData="yes" bpelx:insertMissingToData="yes">
                                      <from>$Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[1]/ns34:enAnalisis</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:enAnalisis</to>
                                    </copy>
                                    <copy ignoreMissingFromData="yes" bpelx:insertMissingToData="yes">
                                      <from>$Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[1]/ns34:fechaRegistro</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:fechaRegistro</to>
                                    </copy>
                                    <copy ignoreMissingFromData="yes" bpelx:insertMissingToData="yes">
                                      <from>$Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[1]/ns34:banEstatus</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:banEstatus</to>
                                    </copy>
                                    <copy ignoreMissingFromData="yes" bpelx:insertMissingToData="yes">
                                      <from>number(4)</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:tipoEvaluacion</to>
                                    </copy>
                                    <copy ignoreMissingFromData="yes" bpelx:insertMissingToData="yes">
                                      <from>$Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[1]/ns34:descripcionTipoEvaluacion</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:descripcionTipoEvaluacion</to>
                                    </copy>
                                    <copy ignoreMissingFromData="yes" bpelx:insertMissingToData="yes">
                                      <from>$Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[1]/ns34:version</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:version</to>
                                    </copy>
                                    <copy ignoreMissingFromData="yes" bpelx:insertMissingToData="yes">
                                      <from>$Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[1]/ns34:codigoUsuario</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:codigoUsuario</to>
                                    </copy>
                                    <copy ignoreMissingFromData="yes" bpelx:insertMissingToData="yes">
                                      <from>$Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[1]/ns34:nombreUsuario</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:nombreUsuario</to>
                                    </copy>
                                    <copy ignoreMissingFromData="yes" bpelx:insertMissingToData="yes">
                                      <from>$Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[1]/ns34:Porcentaje</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:Porcentaje</to>
                                    </copy>
                                    <copy ignoreMissingFromData="yes" bpelx:insertMissingToData="yes">
                                      <from>$Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[1]/ns34:PorcentajeObligatorio</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:PorcentajeObligatorio</to>
                                    </copy>
                                    <copy ignoreMissingFromData="yes" bpelx:insertMissingToData="yes">
                                      <from>$Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[1]/ns34:codigoExterno</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:codigoExterno</to>
                                    </copy>
                                    <copy bpelx:insertMissingToData="yes">
                                      <from>number(4)</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:catEvaluacion/ns8:Id</to>
                                    </copy>
                                    <copy ignoreMissingFromData="yes" bpelx:insertMissingToData="yes">
                                      <from>$Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[1]/ns34:idEvaluacionOrigen</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:idEvaluacionOrigen</to>
                                    </copy>
                                    <copy ignoreMissingFromData="yes" bpelx:insertMissingToData="yes">
                                      <from>$Evaluacion.response/ns33:Evaluaciones/ns34:evaluacion[1]/ns34:calificacionIBCIE</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:calificacionIBCIE</to>
                                    </copy>
                                    <copy bpelx:insertMissingToData="yes">
                                      <from>$inputVariable.request/ns3:instanciaProceso</from>
                                      <to>$inCrearEvaluacion.request/ns33:Evaluaciones/ns34:evaluacion/ns34:instanciaProceso</to>
                                    </copy>
                                  </assign>
                                  <invoke name="InvokeCrearEvaluacionFenix" bpelx:invokeAsDetail="no"
                                          partnerLink="CrearEvaluacionFenix_PS" portType="ns35:EvaluacionPT"
                                          operation="crearEvaluacion" inputVariable="inCrearEvaluacion"
                                          outputVariable="outCrearEvaluacion"/>
                                </sequence>
                              </scope>
                              <else>
                                <documentation>
                                  <![CDATA[ERROR]]>
                                </documentation>
                                <sequence name="SequenceErrror">
                                  <assign name="assignResult">
                                    <copy bpelx:insertMissingToData="yes">
                                      <from>$outDuplicarEvaluacion.response/ns33:Resultado</from>
                                      <to>$outputVariable.response/ns3:Resultado</to>
                                    </copy>
                                  </assign>
                                  <reply name="ReplyError" variable="outputVariable"
                                         partnerLink="configuracionevaluacion_client"
                                         portType="ns1:ConfigurarEvaluacionPT" operation="configurarEvaluacion"/>
                                </sequence>
                              </else>
                            </if>
                          </sequence>
                        </scope>
                        <else>
                          <documentation>
                            <![CDATA[ERROR]]>
                          </documentation>
                          <assign name="assignError">
                            <copy>
                              <from>'ERROR'</from>
                              <to>$outputVariable.response/ns3:Resultado/ns10:result</to>
                            </copy>
                            <copy>
                              <from>concat('Fallo al ConsultarEVAL: ',$outConsultarEvaluacionEVAL.response/ns33:Resultado/ns10:message)</from>
                              <to>$outputVariable.response/ns3:Resultado/ns10:message</to>
                            </copy>
                          </assign>
                        </else>
                      </if>
                    </sequence>
                  </scope>
                  <else>
                    <documentation>
                      <![CDATA[tipoEvalNOValido]]>
                    </documentation>
                    <assign name="assignError">
                      <copy>
                        <from>'ERROR'</from>
                        <to>$outputVariable.response/ns3:Resultado/ns10:result</to>
                      </copy>
                      <copy>
                        <from>'El idTipoEvaluacion es incorrecto'</from>
                        <to>$outputVariable.response/ns3:Resultado/ns10:message</to>
                      </copy>
                    </assign>
                  </else>
                </if>
              </else>
            </if>
          </else>
        </if>
      </else>
    </if>
    <!-- Generate reply to synchronous request -->
    <reply name="replyOutput" partnerLink="configuracionevaluacion_client" portType="ns1:ConfigurarEvaluacionPT" operation="configurarEvaluacion" variable="outputVariable"/>
  </sequence>
</process>