package org.bcie.fenix.common.model.vo.parametrizacion;

import oracle.adf.share.logging.ADFLogger;

import oracle.jbo.Row;
import oracle.jbo.RowSetIterator;
import oracle.jbo.server.ViewObjectImpl;

import org.bcie.fenix.common.model.am.FenixParametrizacionAMImpl;
import org.bcie.fenix.common.model.vo.parametrizacion.common.TcaAlertaVO;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Mon Jul 10 11:15:13 CDT 2017
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class TcaAlertaVOImpl extends ViewObjectImpl implements TcaAlertaVO {
    
    private static ADFLogger logger = null;
    
    /**
     * This is the default constructor (do not remove).
     */
    public TcaAlertaVOImpl() {
        if (logger == null) {
            logger = ADFLogger.createADFLogger(this.getClass());
        }
    }

    /**
     * Returns the variable value for pIdAlerta.
     * @return variable value for pIdAlerta
     */
    public Long getpIdAlerta() {
        return (Long) ensureVariableManager().getVariableValue("pIdAlerta");
    }

    /**
     * Sets <code>value</code> for variable pIdAlerta.
     * @param value value to bind as pIdAlerta
     */
    public void setpIdAlerta(Long value) {
        ensureVariableManager().setVariableValue("pIdAlerta", value);
    }

    /**
     * Returns the variable value for pIdTipoAlerta.
     * @return variable value for pIdTipoAlerta
     */
    public Long getpIdTipoAlerta() {
        return (Long) ensureVariableManager().getVariableValue("pIdTipoAlerta");
    }

    /**
     * Sets <code>value</code> for variable pIdTipoAlerta.
     * @param value value to bind as pIdTipoAlerta
     */
    public void setpIdTipoAlerta(Long value) {
        ensureVariableManager().setVariableValue("pIdTipoAlerta", value);
    }

    /**
     * Returns the variable value for pNombre.
     * @return variable value for pNombre
     */
    public String getpNombre() {
        return (String) ensureVariableManager().getVariableValue("pNombre");
    }

    /**
     * Sets <code>value</code> for variable pNombre.
     * @param value value to bind as pNombre
     */
    public void setpNombre(String value) {
        ensureVariableManager().setVariableValue("pNombre", value);
    }

    public void agregarRolesBpmSeleccionados(Integer idPlantillaCorreo) {
        logger.log(ADFLogger.WARNING, "Entrando en agregarRolesBpmSeleccionados.");
        logger.log(ADFLogger.WARNING, "idPlantillaCorreo: " + idPlantillaCorreo);
        
        FenixParametrizacionAMImpl parametrizacionAM = (FenixParametrizacionAMImpl) getRootApplicationModule();
        ParametrizacionRolBpmVOImpl rolBpmVO = parametrizacionAM.getParametrizacionRolBpmVO();
        TrePlantillaCorreoRolBpmVOImpl rolPlantillaVO = parametrizacionAM.getTrePlantillaCorreoRolBpmVO();

        RowSetIterator iterator = rolBpmVO.createRowSetIterator(null);
        iterator.reset();

        while (iterator.hasNext()) {
            Row row = iterator.next();
            if (registroSeleccionado(row)) {
                agregarRolBpmPlantilla(rolPlantillaVO, row, idPlantillaCorreo);
            }
        }
    }

    private boolean registroSeleccionado(Row row) {
        boolean seleccionado = Boolean.FALSE;
        Boolean seleccionadoAtr = (Boolean) row.getAttribute("Seleccionado");
        if (null != seleccionadoAtr && seleccionadoAtr.compareTo(Boolean.TRUE) == 0) {
            seleccionado = Boolean.TRUE;
        }
        return seleccionado;
    }

    private void agregarRolBpmPlantilla(TrePlantillaCorreoRolBpmVOImpl rolPlantillaVO, Row rolBpmRow,
                                        Integer idPlantillaCorreo) {
        Row row = rolPlantillaVO.createRow();
        row.setAttribute(TrePlantillaCorreoRolBpmVORowImpl.IDTCAPLANTILLACORREO, idPlantillaCorreo);
        row.setAttribute(TrePlantillaCorreoRolBpmVORowImpl.IDTCAROLBPM,
                              rolBpmRow.getAttribute(ParametrizacionRolBpmVORowImpl.ID));
        rolPlantillaVO.insertRow(row);
    }
}

