package org.bcie.fenix.common.model.vo;

import java.util.ArrayList;
import java.util.List;

import oracle.adf.share.logging.ADFLogger;

import oracle.jbo.Row;
import oracle.jbo.RowSetIterator;
import oracle.jbo.ViewCriteria;
import oracle.jbo.server.ViewObjectImpl;

import org.bcie.fenix.common.model.vo.common.RolesAccionVO;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Thu Jul 13 16:03:55 CDT 2017
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class RolesAccionVOImpl extends ViewObjectImpl implements RolesAccionVO {
    
    private static ADFLogger logger = null;
    
    /**
     * This is the default constructor (do not remove).
     */
    public RolesAccionVOImpl() {
        if (logger == null) {
            logger = ADFLogger.createADFLogger(this.getClass());
        }
    }

    /**
     * Returns the variable value for idAccion.
     * @return variable value for idAccion
     */
    public Integer getidAccion() {
        return (Integer) ensureVariableManager().getVariableValue("idAccion");
    }

    /**
     * Sets <code>value</code> for variable idAccion.
     * @param value value to bind as idAccion
     */
    public void setidAccion(Integer value) {
        ensureVariableManager().setVariableValue("idAccion", value);
    }
    
    public List<String> obtenerRoles(Integer idAccion) {
        logger.warning("Inside obtenerRoles.");
        logger.warning("idAccion: " + idAccion);

        List<String> listRoles = new ArrayList<String>();
        ViewCriteria criteria = null;
    
        try {      
            criteria =this.getViewCriteriaManager().getViewCriteria("RolesAccionVOCriteria");
            criteria.ensureVariableManager().setVariableValue("idAccion", idAccion);
            this.applyViewCriteria(criteria);
            this.executeQuery();
            
            logger.warning("Roles encontrados: " + this.getEstimatedRowCount());
            
            if (this.getEstimatedRowCount() > 0) {
                RowSetIterator rowRolesAccion = createRowSetIterator(null);
                rowRolesAccion.reset();

                while (rowRolesAccion.hasNext()) {
                    RolesAccionVORowImpl rowRol = (RolesAccionVORowImpl) rowRolesAccion.next();
                    
                    if (rowRol.getDescripcionCorta() != null) {
                        logger.warning(rowRol.getDescripcionCorta());
                        listRoles.add(rowRol.getDescripcionCorta());
                    }
                }
                rowRolesAccion.closeRowSetIterator();
            } else {
                logger.warning("No se encontraron roles para la accion.");
            }
            
        } catch(Exception e) {
            logger.log(ADFLogger.WARNING, "Error al buscar por idAccion: " + e);     
        } finally {
            getViewCriteriaManager().removeApplyViewCriteriaName("RolesAccionVOCriteria");
            executeQuery();       
        }
        
        return listRoles;
    }
}