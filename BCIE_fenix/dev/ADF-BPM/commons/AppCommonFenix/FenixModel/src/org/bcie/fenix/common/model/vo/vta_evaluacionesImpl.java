package org.bcie.fenix.common.model.vo;
 

import oracle.adf.share.logging.ADFLogger;

import oracle.jbo.Row;
import oracle.jbo.server.ViewObjectImpl;

import org.bcie.fenix.common.model.vo.common.vta_evaluaciones;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Mon Nov 02 10:04:13 CST 2020
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class vta_evaluacionesImpl extends ViewObjectImpl implements vta_evaluaciones {
    
    private static ADFLogger logger = null;
    
    
    /**
     * This is the default constructor (do not remove).
     */
    public vta_evaluacionesImpl() {
    }

    /**
     * Returns the bind variable value for id_operacion.
     * @return bind variable value for id_operacion
     */
    public Long getid_operacion() {
        return (Long) getNamedWhereClauseParam("id_operacion");
    }

    /**
     * Sets <code>value</code> for bind variable id_operacion.
     * @param value value to bind as id_operacion
     */
    public void setid_operacion(Long value) {
        setNamedWhereClauseParam("id_operacion", value);
    }

    /**
     * Returns the bind variable value for codigo_tipo_evaluacion.
     * @return bind variable value for codigo_tipo_evaluacion
     */
    public Long getcodigo_tipo_evaluacion() {
        return (Long) getNamedWhereClauseParam("codigo_tipo_evaluacion");
    }

    /**
     * Sets <code>value</code> for bind variable codigo_tipo_evaluacion.
     * @param value value to bind as codigo_tipo_evaluacion
     */
    public void setcodigo_tipo_evaluacion(Long value) {
        setNamedWhereClauseParam("codigo_tipo_evaluacion", value);
    }
    
    public String poseeCuestionarioBase(Long id_operacion, Long codigo_tipo_evaluacion)
    {   
        logger.log(ADFLogger.WARNING, "inicia metodo poseeCuestionarioBase");
        logger.log(ADFLogger.WARNING, "id_operacion: " + id_operacion);
        logger.log(ADFLogger.WARNING, "codigo_tipo_evaluacion: " + codigo_tipo_evaluacion);
        
        String valorRespuesta = "";
        Long tipoEvaluacion_CuestionarioBase = null;
        
        if(codigo_tipo_evaluacion.compareTo(2L) == 0 || codigo_tipo_evaluacion.compareTo(4L) == 0 || codigo_tipo_evaluacion.compareTo(5L) == 0)
        {
            //Ex ante es para Medio Término, Seguimiento de Ejecución y Seguimiento de operación
            tipoEvaluacion_CuestionarioBase = 1L;
        }
        else if(codigo_tipo_evaluacion.compareTo(3L) == 0)
        {
            //Medio Término para Ex Post
            tipoEvaluacion_CuestionarioBase = 2L;
        }
        else if(codigo_tipo_evaluacion.compareTo(1L) == 0)
        {
            //Ex ante no necesita cuestionario
            valorRespuesta = "OK";
        }
        logger.log(ADFLogger.WARNING, "tipoEvaluacion_CuestionarioBase: " + tipoEvaluacion_CuestionarioBase);
        
        //Si es Ex ante no se consultaran las evaluaciones
        if(valorRespuesta.equals("OK"))
        {
            logger.log(ADFLogger.WARNING, "valorRespuesta: " + valorRespuesta);
        }
        else
        {
            try{
                this.setid_operacion(id_operacion);
                this.setcodigo_tipo_evaluacion(tipoEvaluacion_CuestionarioBase);
                this.executeQuery();
                
                long count = this.getEstimatedRowCount();  
                logger.log(ADFLogger.WARNING, "count: " + count);
                
                Row row = this.getCurrentRow();
                
                Long cantidaEvaluaciones = (Long)row.getAttribute("cantidad");
                
                if(cantidaEvaluaciones.compareTo(0L) == 0)
                {
                    valorRespuesta = "No existe cuestionario base.";
                }
                else
                {
                    valorRespuesta ="OK";
                }
            }
            catch(Exception exp)
            {
                logger.log(ADFLogger.WARNING, "Error poseeCuestionarioBase: " + exp);
            }     
        }
        logger.log(ADFLogger.WARNING, "Finalizo metodo poseeCuestionarioBase");
        return valorRespuesta;
    }
}

