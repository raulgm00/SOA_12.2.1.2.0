package org.bcie.fenix.common.model.vo;

import oracle.adf.share.logging.ADFLogger;

import oracle.jbo.Row;
import oracle.jbo.RowSetIterator;
import oracle.jbo.ViewCriteria;
import oracle.jbo.server.ViewObjectImpl;

import org.bcie.fenix.common.model.vo.common.RespuestaComentarioVO;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Thu May 18 10:13:53 CDT 2017
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class RespuestaComentarioVOImpl extends ViewObjectImpl implements RespuestaComentarioVO {
    /**
     * This is the default constructor (do not remove).
     */
    
    private static ADFLogger logger = null;
    
    public RespuestaComentarioVOImpl() {
        if (logger == null) {
            logger = ADFLogger.createADFLogger(this.getClass());
        }
    }
    
    public Boolean eliminarComentarioIndividual(Integer idComentario){
        logger.warning("Inicia metodo eliminarComentarioIndividual... ");
        Boolean resultado = Boolean.TRUE;
        Row filaRecuperada = null;
        ViewCriteria criteria = null;
        Long id = null;

        logger.warning("idComentario recibido: " + idComentario);

        if (idComentario == null) {
            logger.warning("*** El parametro id es requerido para actualizar los campos requeridos");
            return null;
        }
        try {
            criteria = this.getViewCriteriaManager().getViewCriteria("RespuestaComentarioVOCriteriaById");
            criteria.ensureVariableManager().setVariableValue("varIdComentario", idComentario);
            this.applyViewCriteria(criteria);
            this.executeQuery();

            if (getEstimatedRowCount() > 0) {
                setCurrentRow(first());
                filaRecuperada = getCurrentRow();
                logger.warning("Id: " + filaRecuperada.getAttribute("Id"));
                id = Long.parseLong(filaRecuperada.getAttribute("Id").toString());
                filaRecuperada.setAttribute("BanEstatus", 0);
                try {
                    getDBTransaction().commit();
                    logger.warning("Se hace commit a la DB");
                    resultado = Boolean.TRUE;
                    executeQuery();
                } catch (Exception e) {
                    logger.log(ADFLogger.ERROR,
                          "Error al intentar hacer el eliminado logico en el metodo eliminarComentarioIndividual ->: ", e);
                    //getDBTransaction().rollback();
                    resultado = Boolean.FALSE;
                }
            } else {
                logger.warning("El row recuperado es Null no hay coincidencias en la busqueda");
                getViewCriteriaManager().removeApplyViewCriteriaName("RespuestaComentarioVOCriteriaById");
                resultado = Boolean.FALSE;
                executeQuery();
            }
        } catch (Exception e) {
            logger.log(ADFLogger.WARNING, "*** Error al BuscarPorId  ->", e);
        } finally {
            getViewCriteriaManager().removeApplyViewCriteriaName("RespuestaComentarioVOCriteriaById");
        }
        
        logger.warning("Valor a retornar de resultado: " + resultado);
        logger.warning("Finaliza metodo eliminarComentarioIndividual... ");

        return resultado;
    }
    
    public Boolean eliminarComentarioPadreCascada(Integer idComentarioPadre){
        logger.warning("Inicia metodo eliminarComentarioPadreCascada... ");
        Boolean resultado = Boolean.FALSE;
        ViewCriteria criteria = null;
        int contador = 0;

        logger.warning("idComentarioPadre recibido: " + idComentarioPadre);

        if (idComentarioPadre == null) {
            logger.warning("*** El parametro id es requerido para actualizar los campos requeridos");
            return null;
        }
        try {
            criteria = this.getViewCriteriaManager().getViewCriteria("RespuestaComentarioVOCriteriaByIdComentarioOperacion");
            criteria.ensureVariableManager().setVariableValue("varIdComentarioOperacion", idComentarioPadre);
            this.applyViewCriteria(criteria);
            this.executeQuery();
            
            logger.warning("Numero de comentarios encontrados: " + getEstimatedRowCount());
            
            if(getEstimatedRowCount() > 0){
                RowSetIterator rowsRespuestaComentarioVo = createRowSetIterator(null);
                rowsRespuestaComentarioVo.reset();
                while (rowsRespuestaComentarioVo.hasNext()) {
                    RespuestaComentarioVORowImpl rowL = (RespuestaComentarioVORowImpl) rowsRespuestaComentarioVo.next();
                    if(rowL.getAttribute("Id") != null){
                        logger.warning("Id de comentario a eliminar: " + rowL.getAttribute("Id"));
                        rowL.setAttribute("BanEstatus", 0);
                        try {
                            getDBTransaction().commit();
                            logger.warning("Se hace commit a la DB");
                            contador++;
                        } catch (Exception e) {
                            logger.log(ADFLogger.WARNING,
                                  "Error al intentar hacer el eliminado logico en el metodo eliminarComentarioPadreCascada ->: ", e);
                            //getDBTransaction().rollback();
                        }
                    }
                }
                if(contador == getEstimatedRowCount())
                    resultado = Boolean.TRUE;
                else
                    resultado = Boolean.FALSE;
                
                rowsRespuestaComentarioVo.closeRowSetIterator();
            } else {
                resultado = Boolean.TRUE;
            }
        } catch (Exception e) {
            logger.log(ADFLogger.WARNING, "*** Error al BuscarPorId  ->", e);
        } finally {
            getViewCriteriaManager().removeApplyViewCriteriaName("RespuestaComentarioVOCriteriaByIdComentarioOperacion");
        }
        
        logger.warning("Valor a retornar de resultado: " + resultado);
        logger.warning("Finaliza metodo eliminarComentarioPadreCascada... ");

        return resultado;
    }

    /**
     * Returns the variable value for varIdInstanciaTarea.
     * @return variable value for varIdInstanciaTarea
     */
    public String getvarIdInstanciaTarea() {
        return (String) ensureVariableManager().getVariableValue("varIdInstanciaTarea");
    }

    /**
     * Sets <code>value</code> for variable varIdInstanciaTarea.
     * @param value value to bind as varIdInstanciaTarea
     */
    public void setvarIdInstanciaTarea(String value) {
        ensureVariableManager().setVariableValue("varIdInstanciaTarea", value);
    }

    /**
     * Returns the variable value for varTarea.
     * @return variable value for varTarea
     */
    public Integer getvarTarea() {
        return (Integer) ensureVariableManager().getVariableValue("varTarea");
    }

    /**
     * Sets <code>value</code> for variable varTarea.
     * @param value value to bind as varTarea
     */
    public void setvarTarea(Integer value) {
        ensureVariableManager().setVariableValue("varTarea", value);
    }

    /**
     * Returns the variable value for varIdComentario.
     * @return variable value for varIdComentario
     */
    public Integer getvarIdComentario() {
        return (Integer) ensureVariableManager().getVariableValue("varIdComentario");
    }

    /**
     * Sets <code>value</code> for variable varIdComentario.
     * @param value value to bind as varIdComentario
     */
    public void setvarIdComentario(Integer value) {
        ensureVariableManager().setVariableValue("varIdComentario", value);
    }

    /**
     * Returns the variable value for varIdComentarioOperacion.
     * @return variable value for varIdComentarioOperacion
     */
    public Integer getvarIdComentarioOperacion() {
        return (Integer) ensureVariableManager().getVariableValue("varIdComentarioOperacion");
    }

    /**
     * Sets <code>value</code> for variable varIdComentarioOperacion.
     * @param value value to bind as varIdComentarioOperacion
     */
    public void setvarIdComentarioOperacion(Integer value) {
        ensureVariableManager().setVariableValue("varIdComentarioOperacion", value);
    }
}

