package org.bcie.fenix.common.model.vo;

import java.sql.Timestamp;

import oracle.adf.share.logging.ADFLogger;

import oracle.jbo.JboException;
import oracle.jbo.Row;
import oracle.jbo.ViewCriteria;
import oracle.jbo.server.ViewObjectImpl;

import org.bcie.fenix.common.model.vo.common.ConsultarNumeroSolicitudVO;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Tue Nov 15 10:46:12 CST 2016
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class ConsultarNumeroSolicitudVOImpl extends ViewObjectImpl implements ConsultarNumeroSolicitudVO {
    
    private static ADFLogger logger = null;
    
    /**
     * This is the default constructor (do not remove).
     */
    public ConsultarNumeroSolicitudVOImpl() {
        if (logger == null) {
            logger = ADFLogger.createADFLogger(this.getClass());
        }
    }

    /**
     * Returns the variable value for IdOperacion1.
     * @return variable value for IdOperacion1
     */
    public Long getIdOperacion1() {
        return (Long) ensureVariableManager().getVariableValue("IdOperacion1");
    }

    /**
     * Sets <code>value</code> for variable IdOperacion1.
     * @param value value to bind as IdOperacion1
     */
    public void setIdOperacion1(Long value) {
        ensureVariableManager().setVariableValue("IdOperacion1", value);
    }
    
    /**
     * M&eacute;todo para recuperar el &uacute;ltimo n&uacute;mero de 
     * resoluci&oacute;n generado en los ciclos de aprobaci&oacute;n
     * @param idOperacion Id de la operaci&oacute;n
     * @return &uacute;ltimo n&uacute;mero de resoluci&oacute;n generado
     */
    public String obtenerUltimoNumeroResolucion(Long idOperacion) {
        String numeroResolucion = null;
        
        try {
            ViewCriteria criteria =this.getViewCriteriaManager().getViewCriteria("ConsultarNumeroSolicitudVOCriteria");
            criteria.ensureVariableManager().setVariableValue("IdOperacion1", idOperacion);
            this.applyViewCriteria(criteria);
            this.executeQuery();
            
            if(null != this.getRowAtRangeIndex(0)){
                Row rowZero = this.getRowAtRangeIndex(0);
                Object rowObject = rowZero.getAttribute(ConsultarNumeroSolicitudVORowImpl.NUMERORESOLUCION);
                if (rowObject != null) {
                    numeroResolucion = (String)rowObject;
                }
            }
        } catch(Exception e) {
            logger.log(ADFLogger.ERROR, e.getMessage());
            
            JboException ex = new JboException(e);
            ex.addToExceptions(new Exception("Error al consultar el \u00FAltimo n\u00FAmero de resoluci\u00F3n, favor de intentar m\u00E1s tarde."));
            throw ex;
        }
        
        return numeroResolucion;
    }
}

