package org.bcie.fenix.common.model.vo;

import java.math.BigDecimal;

import java.sql.ResultSet;

import oracle.adf.share.logging.ADFLogger;

import oracle.jbo.Row;
import oracle.jbo.RowSetIterator;
import oracle.jbo.server.ViewObjectImpl;
import oracle.jbo.server.ViewRowImpl;
import oracle.jbo.server.ViewRowSetImpl;

import org.bcie.fenix.common.model.FenixModelConstants;
import org.bcie.fenix.common.model.am.FenixAMImpl;
import org.bcie.fenix.common.model.am.FenixAdquisicionAMImpl;
import org.bcie.fenix.common.model.vo.common.AdjudicatariosContratoVO;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Tue Feb 21 11:19:23 CST 2017
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class AdjudicatariosContratoVOImpl extends ViewObjectImpl implements AdjudicatariosContratoVO {
    
    private static ADFLogger logger = null;
    
    /**
     * This is the default constructor (do not remove).
     */
    public AdjudicatariosContratoVOImpl() {
        if (logger == null) {
            logger = ADFLogger.createADFLogger(this.getClass());
        }
        
    }
    
    public void crearRowAdjudicatarioContrato(Row row) {
        logger.warning("inside crearRowAdjudicatarioContrato.");

        Row rowAdjudicatarioContrato = null;

        if (row.getAttribute("Id") != null) {
            
            rowAdjudicatarioContrato = this.createRow();
            rowAdjudicatarioContrato.setAttribute("Id", row.getAttribute("Id"));
            rowAdjudicatarioContrato.setAttribute("NumeroCorrespondencia", row.getAttribute("NumeroCorrespondencia"));
            rowAdjudicatarioContrato.setAttribute("Nombre", row.getAttribute("Nombre"));
            rowAdjudicatarioContrato.setAttribute("Nacionalidad", row.getAttribute("Nacionalidad"));
            rowAdjudicatarioContrato.setAttribute("Monto", row.getAttribute("Monto"));
            this.insertRow(rowAdjudicatarioContrato);
        }
    }
    
    public void crearRowAdjudicatarioContrato2(Long id,String correspondencia, String nacionalidad, String nombre, BigDecimal monto) {
        logger.warning("inside crearRowAdjudicatarioContrato2.");

        Row rowAdjudicatarioContrato = null;

        if (id!= null && nombre!=null && nacionalidad!=null) {
            
            rowAdjudicatarioContrato = this.createRow();
            rowAdjudicatarioContrato.setAttribute("Id", id);
            rowAdjudicatarioContrato.setAttribute("NumeroCorrespondencia", correspondencia);
            rowAdjudicatarioContrato.setAttribute("Nombre", nombre);
            rowAdjudicatarioContrato.setAttribute("Nacionalidad", nacionalidad);
            rowAdjudicatarioContrato.setAttribute("Monto", monto);
            this.insertRow(rowAdjudicatarioContrato);
        }
    }
    
    public void eliminarAdjudicatarioContrato(Row adjudicatario){
        logger.warning("Into eliminarAdjudicatarioContrato.");        
        
       try {       
            adjudicatario.remove();
            logger.warning("adjudicatario eliminando id: "+adjudicatario.getAttribute("Id")+" Nombre:"+adjudicatario.getAttribute("Nombre"));
         }catch(Exception e){
             logger.warning("Ha ocurrido un error al eliminar el adjudicatario ->", e);
         }
            
    }
    
    
    public void limpiarVO(){
        logger.warning("Into eliminarAdjudicatarioContrato.");        
        this.executeQuery();
    }
    
    /**
     * executeQueryForCollection - overridden for custom java data source support.
     */
    @Override
    protected void executeQueryForCollection(Object qc, Object[] params, int noUserParams) {
        super.executeQueryForCollection(qc, params, noUserParams);
    }

    /**
     * hasNextForCollection - overridden for custom java data source support.
     */
    @Override
    protected boolean hasNextForCollection(Object qc) {
        boolean bRet = super.hasNextForCollection(qc);
        return bRet;
    }

    /**
     * createRowFromResultSet - overridden for custom java data source support.
     */
    @Override
    protected ViewRowImpl createRowFromResultSet(Object qc, ResultSet resultSet) {
        ViewRowImpl value = super.createRowFromResultSet(qc, resultSet);
        return value;
    }

    /**
     * getQueryHitCount - overridden for custom java data source support.
     */
    @Override
    public long getQueryHitCount(ViewRowSetImpl viewRowSet) {
        long value = super.getQueryHitCount(viewRowSet);
        return value;
    }

    /**
     * getCappedQueryHitCount - overridden for custom java data source support.
     */
    @Override
    public long getCappedQueryHitCount(ViewRowSetImpl viewRowSet, Row[] masterRows, long oldCap, long cap) {
        long value = super.getCappedQueryHitCount(viewRowSet, masterRows, oldCap, cap);
        return value;
    }

    public void fusionarCamposTrasient(Long idNoObjecion) {
        logger.warning("into method fusionarCamposTrasient in AdjudicatariosContratoVO");
        FenixAMImpl fenixAMImpl = (FenixAMImpl) this.getRootApplicationModule();
        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = (FenixAdquisicionAMImpl) fenixAMImpl.getFenixAdquisicionAM();
        if (getEstimatedRowCount() > 0) {
            RowSetIterator rs = this.createRowSetIterator(null);
            rs.reset();

            while (rs.hasNext()) {
                AdjudicatariosContratoVORowImpl contratadoRow = (AdjudicatariosContratoVORowImpl) rs.next();
                fenixAdquisicionesAMImpl.getConcursanteActivoVO().actualizaPerfil(contratadoRow.getId(), idNoObjecion,
                                                                                  FenixModelConstants.CONCURSANTE_ADJUDICADO);
                logger.warning("contratado.Id:" + contratadoRow.getId());
                logger.warning("contratado.Nombre:" + contratadoRow.getNombre());
                logger.warning("contratado.Nacionalidad:" + contratadoRow.getNacionalidad());

            }
            rs.closeRowSetIterator();
        }
    }
}

