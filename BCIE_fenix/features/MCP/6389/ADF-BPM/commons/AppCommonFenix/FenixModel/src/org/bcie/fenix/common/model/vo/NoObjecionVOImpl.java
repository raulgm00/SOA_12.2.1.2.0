package org.bcie.fenix.common.model.vo;

import com.bcie.xmlns.adquisicionservice.AdquisicionPT;
import com.bcie.xmlns.adquisicionservice.AdquisicionPT12BndQSService;
import com.bcie.xmlns.operacionservice.Operacion12BndQSService;
import com.bcie.xmlns.operacionservice.Operacion12Port;

import com.oracle.xmlns.bpmn.bpmnprocess.procesosalternos.ProcesosAlternosBindingQSService;
import com.oracle.xmlns.bpmn.bpmnprocess.procesosalternos.ProcesosAlternosPortType;

import oracle.adf.model.binding.DCIteratorBinding;

import oracle.adf.share.logging.ADFLogger;

import oracle.javatools.resourcebundle.BundleFactory;

import oracle.jbo.JboException;
import oracle.jbo.Key;
import oracle.jbo.Row;
import oracle.jbo.RowSetIterator;
import oracle.jbo.ViewCriteria;
import oracle.jbo.ViewObject;

import oracle.jbo.server.SequenceImpl;
import oracle.jbo.server.ViewObjectImpl;

import oracle.sql.TIMESTAMP;

import org.bcie.adquisicionmo.InformeNoObjecionRequestType;
import org.bcie.adquisicionmo.InformeNoObjecionResponseType;

import org.bcie.fenix.common.model.FenixModelConstants;
import org.bcie.fenix.common.model.am.FenixAMImpl;
import org.bcie.fenix.common.model.am.FenixAdquisicionAMImpl;
import org.bcie.fenix.common.model.utils.IWsdlLocation;
import org.bcie.fenix.common.model.utils.ModelUtils;
import org.bcie.fenix.common.model.vo.common.NoObjecionVO;

import org.bcie.operacionbo.Operacion;

import org.bcie.operacionmo.ConsultarOperacionByIdOperacionRequestType;
import org.bcie.operacionmo.ConsultarOperacionResponseType;

import org.bcie.resultbo.Resultado;

import org.bcie.xmlns.objetoproceso.comun.header.v1.Header;
import org.bcie.xmlns.objetoproceso.comun.parameter.v1.ParameterType;

import java.io.StringWriter;

import java.math.BigDecimal;

import java.sql.Timestamp;

import java.util.Date;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.ResourceBundle;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import javax.xml.bind.JAXBContext;
import javax.xml.bind.JAXBElement;
import javax.xml.bind.JAXBException;
import javax.xml.bind.Marshaller;
import javax.xml.namespace.QName;


// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Mon Nov 14 12:25:55 CST 2016
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class NoObjecionVOImpl extends ViewObjectImpl implements NoObjecionVO {
    private static ADFLogger logger = null;
    private Integer vIdTcaResultadoProceso = null;

    /**
     * This is the default constructor (do not remove).
     */
    public NoObjecionVOImpl() {
        if (logger == null) {
            logger = ADFLogger.createADFLogger(this.getClass());
        }
    }

    public Long agregar(Long idAdquisicion) {
        logger.warning("Entrando en agregar.");
        logger.warning("Para la adquisicion: " + idAdquisicion);

        Long nuevoId = null;

        if (null != idAdquisicion) {
            Row noObjecion = null;
            oracle.jbo.domain.Number idNoobjecion = null;
            NoObjecionVORowImpl nvpObjecion = (NoObjecionVORowImpl) this.createRow();
            SequenceImpl seqNoObjecion = null;
            Integer ban = 0;

            seqNoObjecion = new SequenceImpl("NO_OBJECION_SEQ",
                    getDBTransaction());
            idNoobjecion = seqNoObjecion.getSequenceNumber();

            nvpObjecion.setAttribute(NoObjecionVORowImpl.BANESTATUS, ban);
            nvpObjecion.setAttribute(NoObjecionVORowImpl.FECHAREGISTRO,
                new java.sql.Timestamp(System.currentTimeMillis()));
            nvpObjecion.setAttribute(NoObjecionVORowImpl.SEHAREVISADOPUBLICACION,
                0);
            nvpObjecion.setAttribute(NoObjecionVORowImpl.ID, idNoobjecion);
            nvpObjecion.setAttribute(NoObjecionVORowImpl.IDADQUISICION,
                idAdquisicion);
            nvpObjecion.setAttribute(NoObjecionVORowImpl.SEOTORGONOOBJECION,
                null);
            nvpObjecion.setAttribute(NoObjecionVORowImpl.SEOTORGONOOBJECIONTRANSIENT,
                null);

            insertRow(nvpObjecion);
            noObjecion = nvpObjecion;
            // getDBTransaction().commit();
            logger.warning("IdSeguiminto" +
                (Long) noObjecion.getAttribute("Id"));
            nuevoId = (Long) noObjecion.getAttribute("Id");
            setCurrentRow(noObjecion);
        }
        else {
            logger.warning("No se obtuvo el id de adquisicion");
        }

        return nuevoId;
    }

    public void remover(Long idNoobjecion) {
    }

    /**
     * Returns the bind variable value for varIdAdquisicion.
     * @return bind variable value for varIdAdquisicion
     */
    public Long getvarIdAdquisicion() {
        return (Long) getNamedWhereClauseParam("varIdAdquisicion");
    }

    /**
     * Sets <code>value</code> for bind variable varIdAdquisicion.
     * @param value value to bind as varIdAdquisicion
     */
    public void setvarIdAdquisicion(Long value) {
        logger.warning("Adquisiciones " + value);

        if (null != value) {
            setNamedWhereClauseParam("varIdAdquisicion", value);
        }

        executeQuery();
    }

    public Map precargarAdquisicion(Long idAdquisicion, Long idNoObjecion) {
        logger.warning("Ingresa metodo precargarAdquisicionVO");
        logger.warning("idAdquisicion recibido: " + idAdquisicion);
        logger.warning("idNoObjecion recibido: " + idNoObjecion);

        logger.warning(
            "Precarga.inicio. fenixAdquisicionesAMImpl.getOferentesVO().rowCount() : " +
            getFenixAdquisicionAM().getOferentesVO().getEstimatedRowCount());

        //setvarIdAdquisicion(idAdquisicion);
        //executeQuery();
        Map resultado = new HashMap<String, Object>();
        Map resultado2 = new HashMap<String, Object>();
        Boolean resultado3 = Boolean.FALSE;
        Boolean consultaObjecion = Boolean.FALSE;
        Integer catalogo = null;

        if (null != idAdquisicion) {
            FenixAMImpl fenixAMImpl = null;
            fenixAMImpl = (FenixAMImpl) this.getRootApplicationModule();

            FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = (FenixAdquisicionAMImpl) fenixAMImpl.getFenixAdquisicionAM();
            resultado2 = fenixAdquisicionesAMImpl.getAdquisicionVO()
                                                 .aplicarNoobjecion(idAdquisicion);
            logger.warning("valor resultado2.get(resultado)" +
                resultado2.get("resultado"));

            if (null != (Boolean) resultado2.get("resultado")) {
                logger.warning("Ingresa if resultado2");
                consultaObjecion = (Boolean) resultado2.get("resultado");

                Boolean esPrevia = (Boolean) resultado2.get("previa");
                resultado.put("resultado", consultaObjecion);
                resultado.put("previa", esPrevia);
                logger.warning("valor de resultado: " + consultaObjecion);
                logger.warning("valor de previa: " + esPrevia);
            } else {
                logger.warning("Ingresa else resultado2");
                resultado.put("resultado", consultaObjecion);
            }

            if (consultaObjecion) {
                logger.warning("Ingresa if consultaObjecion");
                logger.warning("modalidad " +
                    (Integer) resultado2.get("modalidad"));

                if (null != (Integer) resultado2.get("modalidad")) {
                    //precargaModalidad((Integer) resultado2.get("modalidad"));
                    fenixAdquisicionesAMImpl.getTcaTipoNoObjecionVO()
                                            .setvarModalidad((Integer) resultado2.get(
                            "modalidad"));

                    catalogo = (Integer) resultado2.get("modalidad");
                    resultado.put("modalidad", catalogo);

                    switch (catalogo) {
                    case FenixModelConstants.MODALIDAD_LICITACION1:
                    case FenixModelConstants.MODALIDAD_LICITACION2:
                    case FenixModelConstants.MODALIDAD_CONCURSO5:
                    case FenixModelConstants.MODALIDAD_CONCURSO6:
                        logger.warning("Aplica categoria 1");
                        resultado.put("categoria1", Boolean.TRUE);
                        resultado.put("categoria2", Boolean.FALSE);
                        resultado.put("categoria3", Boolean.FALSE);

                        break;

                    case FenixModelConstants.MODALIDAD_COMPARACION3:
                    case FenixModelConstants.MODALIDAD_COMPARACION7:
                        logger.warning("Aplica categoria 2");
                        resultado.put("categoria2", Boolean.TRUE);
                        resultado.put("categoria1", Boolean.FALSE);
                        resultado.put("categoria3", Boolean.FALSE);

                        break;

                    case FenixModelConstants.MODALIDAD_DIRECTO4:
                        logger.warning("Aplica categoria 3");
                        resultado.put("categoria3", Boolean.TRUE);
                        resultado.put("categoria2", Boolean.FALSE);
                        resultado.put("categoria1", Boolean.FALSE);

                        break;

                    default:
                        logger.warning("Aplica categoria ninguna");
                        resultado.put("categoria1", Boolean.FALSE);
                        resultado.put("categoria2", Boolean.FALSE);
                        resultado.put("categoria3", Boolean.FALSE);

                        break;
                    }
                } else {
                    logger.warning("Aplica categoria ninguna");
                    resultado.put("categoria1", Boolean.FALSE);
                    resultado.put("categoria2", Boolean.FALSE);
                    resultado.put("categoria3", Boolean.FALSE);
                }

                Integer valorTipo = null;
                Integer valorResultado = null;
                setvarIdAdquisicion(idAdquisicion);

                //executeQuery();
                Long primero = null;

                if (null == idNoObjecion) {
                    logger.warning(
                        "idNoObjecion recibido como parametro es nulo.");

                    Row primerRegistro = this.getRowAtRangeIndex(0);
                    iniciarCamposTransient(primerRegistro);

                    if (null != primerRegistro) {
                        primerRegistro.setAttribute("modalidad", catalogo);
                        logger.warning("ID adquisicion primer registro" +
                            (Long) primerRegistro.getAttribute("Id"));

                        if (null != (Long) primerRegistro.getAttribute("Id")) {
                            primero = (Long) primerRegistro.getAttribute("Id");
                            resultado.put("claveobjecion", primero);

                            if (null != (Integer) primerRegistro.getAttribute(
                                        "IdTcaTipoNoObjecion")) {
                                valorTipo = (Integer) primerRegistro.getAttribute(
                                        "IdTcaTipoNoObjecion");
                                resultado.put("tipoobjecion", valorTipo);

                                fenixAdquisicionesAMImpl.getNoObjecionParticipantesVO()
                                                        .cargarDatos(primero,
                                    valorTipo);
                            }

                            if (null != (Integer) primerRegistro.getAttribute(
                                        "IdTcaResultadoProceso")) {
                                valorResultado = (Integer) primerRegistro.getAttribute(
                                        "IdTcaResultadoProceso");
                                resultado.put("resultadoobjecion",
                                    valorResultado);
                            }

                            //resultado3=precargaNoObjecion(primero,valorTipo,valorResultado);
                        } else {
                            logger.warning(
                                "ID adquisicion primer registro no obtenido");
                        }
                    } else {
                        logger.warning(
                            "ID adquisicion primer registro no obtenido");
                    }
                } else {
                    Row rowNoObjecionObtenido = null;

                    if (null != idNoObjecion) {
                        // rowNoObjecionObtenido=fenixAdquisicionesAMImpl.getNoObjecionEstableVO().obtenerObjecion(idNoObjecion);
                        rowNoObjecionObtenido = getNoObjecionTarea(idNoObjecion,
                                idAdquisicion);
                    }

                    logger.warning(
                        "idNoObjecion recibido por parametro NO Nulo.");

                    Row noObjecionrow = null;
                    noObjecionrow = rowNoObjecionObtenido;

                    if (null != noObjecionrow) {
                        noObjecionrow.setAttribute("modalidad", catalogo);
                        iniciarCamposTransient(noObjecionrow);
                        setCurrentRow(noObjecionrow);
                        logger.warning("ID adquisicion primer registro" +
                            (Long) noObjecionrow.getAttribute("Id"));

                        if (null != (Long) noObjecionrow.getAttribute("Id")) {
                            primero = idNoObjecion;
                            resultado.put("claveobjecion", primero);

                            if (null != (Integer) noObjecionrow.getAttribute(
                                        "IdTcaTipoNoObjecion")) {
                                valorTipo = (Integer) noObjecionrow.getAttribute(
                                        "IdTcaTipoNoObjecion");
                                resultado.put("tipoobjecion", valorTipo);

                                // Carga de Adjudicatarios anteriores en caso de NoObjecion tipo Contrato
                                if ((null != valorTipo) &&
                                        (valorTipo.compareTo(
                                            FenixModelConstants.NO_OBJECION_CONTRATO) == 0)) {
                                    fenixAdquisicionesAMImpl.llenarAdjudicatariosContrato(idAdquisicion);
                                }

                                // Carga de Participantes
                                fenixAdquisicionesAMImpl.getNoObjecionParticipantesVO()
                                                        .cargarDatos(primero,
                                    valorTipo);
                            }

                            if (null != (Integer) noObjecionrow.getAttribute(
                                        "IdTcaResultadoProceso")) {
                                valorResultado = (Integer) noObjecionrow.getAttribute(
                                        "IdTcaResultadoProceso");
                                resultado.put("resultadoobjecion",
                                    valorResultado);
                            }

                            //resultado3=precargaNoObjecion(primero,valorTipo,valorResultado);
                        } else {
                            logger.warning(
                                "ID adquisicion primer registro no obtenido");
                        }

                        // noObjecionUnica(idNoObjecion);
                    } else {
                        logger.warning(
                            "ID adquisicion primer registro no obtenido");
                    }
                }
            }
        } else {
            logger.warning("Ingresa else consultaObjecion");
            logger.warning("No se consultan los datos de la no objecion");

            logger.warning("Aplica categoria ninguna");
            resultado.put("categoria1", Boolean.FALSE);
            resultado.put("categoria2", Boolean.FALSE);
            resultado.put("categoria3", Boolean.FALSE);
        }

        logger.warning(
            "Precarga.terminar. fenixAdquisicionesAMImpl.getOferentesVO().rowCount() : " +
            getFenixAdquisicionAM().getOferentesVO().getEstimatedRowCount());

        return resultado;
    }

    public Boolean precargaNoObjecion(Long idNoObjecion, Integer tipo,
        Integer resultadoProceso) {
        logger.warning("idNoObjecion " + idNoObjecion);
        logger.warning("tipo " + tipo);
        logger.warning("resultadoProceso " + resultadoProceso);

        Boolean resultado = Boolean.FALSE;

        if (null != idNoObjecion) {
            FenixAMImpl fenixAMImpl = null;
            fenixAMImpl = (FenixAMImpl) this.getRootApplicationModule();

            FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = (FenixAdquisicionAMImpl) fenixAMImpl.getFenixAdquisicionAM();

            try {
                if (null == tipo) {
                    Row objecionRow = null;
                    objecionRow = getNoObjecion(idNoObjecion, null);

                    Integer valorTipo = null;
                    Integer valorResultado = null;
                    Integer obligatorio = null;

                    if (null != objecionRow) {
                        if (null != (Integer) objecionRow.getAttribute(
                                    "IdTcaTipoNoObjecion")) {
                            valorTipo = (Integer) objecionRow.getAttribute(
                                    "IdTcaTipoNoObjecion");
                            resultado = Boolean.TRUE;
                            fenixAdquisicionesAMImpl.getNoObjecionParticipantesVO()
                                                    .cargarDatos(idNoObjecion,
                                valorTipo);

                            if (null != (Integer) objecionRow.getAttribute(
                                        "IdTcaResultadoProceso")) {
                                // carga de metodos de las tablas de oferentes y adjudicatarios
                                precargaConcursantes(idNoObjecion, valorTipo);
                            } else {
                                logger.warning(
                                    "ID IdTcaResultadoProceso no obtenido");
                            }
                        } else {
                            logger.warning("ID IdTcaTipoNoObjecion no obtenido");
                        }
                    } else {
                        logger.warning("Row no obtenido");
                    }
                } else {
                    resultado = Boolean.TRUE;
                    fenixAdquisicionesAMImpl.getNoObjecionParticipantesVO()
                                            .cargarDatos(idNoObjecion, tipo);

                    if (null != resultadoProceso) {
                        // carga de metodos de las tablas de oferentes y adjudicatarios
                        precargaConcursantes(idNoObjecion, tipo);
                    } else {
                        logger.warning("resultadoProceso no obtenido");
                    }
                }
            } catch (Exception ex) {
                ex.printStackTrace();
            }
        } else {
            logger.warning("idNoObjecion no obtenido");
        }

        //    fenixAdquisicionesAMImpl.getNoObjecionVO().setvarIdAdquisicion(primero);
        return resultado;
    }

    public void recargaConcursantes(Long idNoObjecion) {
        logger.log(ADFLogger.WARNING, "Iniciando recargaConcursantes.");
        logger.log(ADFLogger.WARNING, "idNoObjecion: " + idNoObjecion);

        Row rowNoObjecion = getNoObjecion(idNoObjecion, null);

        if (null != rowNoObjecion) {
            Integer idTcaTipoNoObjecion = (Integer) rowNoObjecion.getAttribute(NoObjecionVORowImpl.IDTCATIPONOOBJECION);

            if ((null != idNoObjecion) && (null != idTcaTipoNoObjecion)) {
                precargaConcursantes(idNoObjecion, idTcaTipoNoObjecion);
            } else {
                logger.log(ADFLogger.WARNING,
                    "Error idNoObjecion o idTcaTipoNoObjecion son nulos.");
            }
        } else {
            logger.log(ADFLogger.WARNING, "Error rowNoObjecion es nulo.");
        }
    }

    /**
     * M&eacute;todo para establecer los par&aacute;metros where de las consultas de
     * concursantes
     * @author Jonathan Ruiz
     * @param idNoObjecion
     * @param idTcaTipoNoObjecion
     */
    public void precargaConcursantes(Long idNoObjecion,
        Integer idTcaTipoNoObjecion) {
        logger.info("precargaConcursantes. idNoObjecion:" + idNoObjecion +
            ", idTcaTipoNoObjecion:" + idTcaTipoNoObjecion);

        Integer idTcaTipoPerfil;
        FenixAMImpl fenixAMImpl = null;
        fenixAMImpl = (FenixAMImpl) this.getRootApplicationModule();

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = (FenixAdquisicionAMImpl) fenixAMImpl.getFenixAdquisicionAM();

        if (idTcaTipoNoObjecion.equals(
                    FenixModelConstants.ID_NO_OBJECION_INFORME_RESULTADOS)) {
            // Informe de resultados
            idTcaTipoPerfil = FenixModelConstants.ID_TIPO_PERFIL_OFERENTE;
            fenixAdquisicionesAMImpl.getOferentesVO()
                                    .setWhereParams(idNoObjecion,
                idTcaTipoPerfil);

            idTcaTipoPerfil = FenixModelConstants.ID_TIPO_PERFIL_ADJUDICATARIO;
            fenixAdquisicionesAMImpl.getAdjudicatariosVO()
                                    .setWhereParams2(idNoObjecion,
                idTcaTipoPerfil);
        } else if (idTcaTipoNoObjecion.equals(
                    FenixModelConstants.ID_NO_OBJECION_CONTRATADO)) {
            // Contratado
            idTcaTipoPerfil = FenixModelConstants.ID_TIPO_PERFIL_ADJUDICATARIO;
            fenixAdquisicionesAMImpl.getAdjudicatariosVO()
                                    .setWhereParams(idNoObjecion,
                idTcaTipoPerfil);

            idTcaTipoPerfil = FenixModelConstants.ID_TIPO_PERFIL_CONTRATADO;
            fenixAdquisicionesAMImpl.getContratadosVO()
                                    .setWhereParams(idNoObjecion,
                idTcaTipoPerfil);
        } else if (idTcaTipoNoObjecion.equals(
                    FenixModelConstants.ID_NO_OBJECION_RESULTDO_PROCESO)) {
            // Resultados del proceso
            idTcaTipoPerfil = FenixModelConstants.ID_TIPO_PERFIL_ADJUDICATARIO;
            fenixAdquisicionesAMImpl.getAdjudicatariosVO()
                                    .setWhereParams(idNoObjecion,
                idTcaTipoPerfil);
        } else if (idTcaTipoNoObjecion.equals(
                    FenixModelConstants.ID_NO_OBJECION_ORDEN_COMPRA)) {
            // Contrato u Orden de compra
            idTcaTipoPerfil = FenixModelConstants.ID_TIPO_PERFIL_CONTRATADO;
            fenixAdquisicionesAMImpl.getContratadosVO()
                                    .setWhereParams(idNoObjecion,
                idTcaTipoPerfil);
        } else {
            // Limpiamos busqueda
            fenixAdquisicionesAMImpl.getContratadosVO().setWhereParams(0L, 0);
        }
    }

    /**
     * M&eacute;todo para obtener la implementaci&oacute;n del FenixAdquisicionAM
     * @return FenixAdquisicionAMImpl
     */
    private FenixAdquisicionAMImpl getFenixAdquisicionAM() {
        FenixAMImpl fenixAMImpl = null;
        fenixAMImpl = (FenixAMImpl) this.getRootApplicationModule();

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = (FenixAdquisicionAMImpl) fenixAMImpl.getFenixAdquisicionAM();

        return fenixAdquisicionesAMImpl;
    }

    /**
     *  M&eacujte;todo para crear un nuevo registro de oferentes
     *  @author Jonathan Ruiz
     */
    public void crearRowOferente(Long idNoObjecion) {
        logger.log(ADFLogger.WARNING,
            "Into crearRowOferente. idNoObjecion: " + idNoObjecion);

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();
        fenixAdquisicionesAMImpl.getOferentesVO().crearRowOferente(idNoObjecion);
    }

    public Row crearRowOferenteByExcel(Long idNoObjecion, String nombre,
        String nacionalidad) {
        logger.log(ADFLogger.WARNING,
            "Into crearRowOferenteByExcel. idNoObjecion: " + idNoObjecion);

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();
        Row fila = fenixAdquisicionesAMImpl.getOferentesVO()
                                           .crearRowOferenteByExcel(idNoObjecion,
                nombre, nacionalidad);

        return fila;
    }

    /**
     *  M&eacujte;todo para eliminar el oferente seleccionado
     *  @author Jonathan Ruiz
     *  @param id del oferente
     */
    public void eliminarOferente(Long id) {
        logger.log(ADFLogger.WARNING, "Into eliminarOferente.");

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();
        Row oferenteSeleccionado = fenixAdquisicionesAMImpl.getOferentesVO()
                                                           .getRow(new Key(
                    new Object[] { id }));
        fenixAdquisicionesAMImpl.getOferentesVO()
                                .eliminarOferente(oferenteSeleccionado);
    }

    /**
     *  M&eacujte;todo para adjudicar el oferente seleccionado
     *  @author Jonathan Ruiz
     *  @param id del oferente
     */
    public void adjudicarOferente(Long id) {
        logger.log(ADFLogger.WARNING, "Into adjudicarOferente. id:" + id);

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();

        Row oferenteSeleccionado = fenixAdquisicionesAMImpl.getOferentesVO()
                                                           .getRow(new Key(
                    new Object[] { id }));
        fenixAdquisicionesAMImpl.getAdjudicatariosVO()
                                .adjudicarOferente(oferenteSeleccionado);
        fenixAdquisicionesAMImpl.getOferentesVO()
                                .eliminarOferente(oferenteSeleccionado);
    }

    public Row adjudicarOferenteByExcel(Row oferente, String nacionalidad,
        BigDecimal monto) {
        logger.log(ADFLogger.WARNING, "Into adjudicarOferenteByExcel.");

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();
        Row rowAdjudicatario = fenixAdquisicionesAMImpl.getAdjudicatariosVO()
                                                       .adjudicarOferenteByExcel(oferente,
                nacionalidad, monto);

        return rowAdjudicatario;
    }

    public void cargaAdquisicion(Long idAdquisicion, Long idNoObjecion) {
        if (null != idNoObjecion) {
            Row adquisicionRow = null;
            adquisicionRow = getRow(new Key(new Object[] { idAdquisicion }));

            if (null != adquisicionRow) {
                logger.warning("el row seleccionado con id  " + idAdquisicion);
                setCurrentRow(adquisicionRow);
            } else {
                logger.warning("No existe row");
            }
        } else {
            logger.warning("No existe row");
        }
    }

    public String comitNoObjecion() {
        logger.warning("Inicio comitNoObjecion");

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();
        String respuesta = "";
        Integer IdTcaResultadoProceso = 0;

        try{
            Row rowCurrent = getCurrentRow();
            
            if(null != rowCurrent)
            {
                logger.warning("**idNoObjecion: " + rowCurrent.getAttribute("Id"));
                logger.warning("***IdTcaResultadoProceso: " + rowCurrent.getAttribute("IdTcaResultadoProceso"));
                
                if (rowCurrent.getAttribute("IdTcaResultadoProceso") != null)
                {
                    IdTcaResultadoProceso = (Integer) rowCurrent.getAttribute("IdTcaResultadoProceso");
                    logger.warning("**IdTcaResultadoProceso: " + IdTcaResultadoProceso);
                } 
                else 
                {
                    IdTcaResultadoProceso = 0;
                    logger.warning("**IdTcaResultadoProceso es null: " + IdTcaResultadoProceso);
                }
            }

            if(IdTcaResultadoProceso.compareTo(3) == 0) 
            {
                logger.warning("**El tipo de resultado es desierto ");
                getDBTransaction().commit();
                respuesta = "OK";
            }
            else 
            {
                long vn_getOferentesVO_rows = fenixAdquisicionesAMImpl.getOferentesVO().getEstimatedRowCount();
                logger.warning("fenixAdquisicionesAMImpl.getOferentesVO().rowCount() : " + vn_getOferentesVO_rows);

                if(vn_getOferentesVO_rows > 0) 
                {
                    fenixAdquisicionesAMImpl.getOferentesVO().fusionarCamposTrasient();
                    logger.warning("vn_getOferentesVO_rows : " + vn_getOferentesVO_rows);
                }

                long vn_getAdjudicatariosVO_rows = fenixAdquisicionesAMImpl.getAdjudicatariosVO().getEstimatedRowCount();
                logger.warning( "fenixAdquisicionesAMImpl.getAdjudicatariosVO().rowCount() : " + vn_getAdjudicatariosVO_rows);

                if (vn_getAdjudicatariosVO_rows > 0) 
                {
                    fenixAdquisicionesAMImpl.getAdjudicatariosVO().fusionarCamposTrasient();
                    logger.warning("vn_getAdjudicatariosVO_rows : " + vn_getAdjudicatariosVO_rows);
                }

                long vn_getContratadosVO_rows = fenixAdquisicionesAMImpl.getContratadosVO().getEstimatedRowCount();
                logger.warning("fenixAdquisicionesAMImpl.getContratadosVO().rowCount() : " + vn_getContratadosVO_rows);

                if (vn_getContratadosVO_rows > 0) 
                {
                    fenixAdquisicionesAMImpl.getContratadosVO().fusionarCamposTrasient();
                    logger.warning("vn_getContratadosVO_rows : " + vn_getContratadosVO_rows);
                }

                fusionarCamposTransient();

                getDBTransaction().commit();
                respuesta = "OK";
            }
        } catch (Exception e) {
            logger.warning("Error al intentar guardar la no objecion ->: ", e);
            respuesta = "Ha ocurrido un error en el metodo NoObjecionVoImpl.comitNoObjecion, ver la bitácora para obtener más información.";
            rollBackNoObjecion();
        }

        logger.warning("respuesta: " + respuesta);
        logger.warning("Fin comitNoObjecion");
        return respuesta;
    }

    public String comitNoObjecionRealizar(Long idNoObjecion) {
        logger.warning("*** Inicia metodo comitNoObjecionRealizar");
        logger.warning("**idNoObjecion: " + idNoObjecion);

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();
        String respuesta = "";

        try {
            long vn_getAdjudicatariosContratoVO_rows = fenixAdquisicionesAMImpl.getAdjudicatariosContratoVO().getEstimatedRowCount();
            logger.warning("fenixAdquisicionesAMImpl.getAdjudicatariosContratoVO().rowCount() : " + vn_getAdjudicatariosContratoVO_rows);

            if (vn_getAdjudicatariosContratoVO_rows > 0) {
                fenixAdquisicionesAMImpl.getAdjudicatariosContratoVO().fusionarCamposTrasient(idNoObjecion);
                logger.warning("vn_getAdjudicatariosContratoVO_rows : " + vn_getAdjudicatariosContratoVO_rows);
            }

            long vn_getContratadosAdjudicatariosVO_rows = fenixAdquisicionesAMImpl.getContratadosAdjudicatariosVO().getEstimatedRowCount();
            logger.warning("fenixAdquisicionesAMImpl.getContratadosAdjudicatariosVO().rowCount() : " + vn_getContratadosAdjudicatariosVO_rows);

            if (vn_getContratadosAdjudicatariosVO_rows > 0) {
                fenixAdquisicionesAMImpl.getContratadosAdjudicatariosVO().fusionarCamposTrasient(idNoObjecion);
                logger.warning("vn_getContratadosAdjudicatariosVO_rows : " + vn_getContratadosAdjudicatariosVO_rows);
            }

            getDBTransaction().commit();
            respuesta = "OK";
        } catch (Exception e) {
            logger.warning("Error al intentar guardar la no objecion ->: ", e);
            respuesta = "Ha ocurrido un error en el metodo NoObjecionVoImpl.comitNoObjecionRealizar, ver la bitácora para obtener más información.";
            rollBackNoObjecion();
        }

        return respuesta;
    }

    public Boolean rollBackNoObjecion() {
        Boolean respuesta = Boolean.FALSE;

        try {
            getDBTransaction().rollback();
            respuesta = Boolean.TRUE;
        } catch (Exception e) {
            logger.log(ADFLogger.ERROR,
                "Error al intentar hacer rollback a la noobjecion ->: " +
                e.getMessage());
            respuesta = Boolean.FALSE;
        }

        return respuesta;
    }

    public Boolean iniciarProceso(Long idAdquisicion, Long idNoObjecion,
        Long idOperacion, String usuario) {
        logger.warning("Dentro de iniciarProceso");
        logger.warning("idAdquisicion :" + idAdquisicion);
        logger.warning("idNoObjecion :" + idNoObjecion);
        logger.warning("idOperacion :" + idOperacion);
        logger.warning("usuario :" + usuario);

        Boolean respuesta = Boolean.TRUE;

        FenixAMImpl fenixAMImpl = null;
        fenixAMImpl = (FenixAMImpl) this.getRootApplicationModule();

        String wsdl = fenixAMImpl.getWsdl(IWsdlLocation.OPERACION);
        fenixAMImpl.obtenerDetalleOperacion(idOperacion.toString());

        org.bcie.xmlns.objetoproceso.comun.operacion.v1.Operacion operacion = new org.bcie.xmlns.objetoproceso.comun.operacion.v1.Operacion();
        Operacion12BndQSService operacion12BndQSService = IWsdlLocation.Service.getInstance(Operacion12BndQSService.class,
                wsdl);
        Operacion12Port operacion12Port = operacion12BndQSService.getOperacion12BndQSPort();

        try {
            logger.log(ADFLogger.WARNING, ">HNWS" + operacion12Port.toString());
        } catch (Exception ex) {
            logger.warning("Error al consultar la configuracion");
        }

        try {
            // Add your code to call the desired methods.
            ConsultarOperacionByIdOperacionRequestType request = new ConsultarOperacionByIdOperacionRequestType();
            request.setIdOperacion(idOperacion);

            Date horaInicio = ModelUtils.logStartWS(logger, request,
                    FenixModelConstants.WSC_CONSULTAR_DETALLE_OPERACION);
            ConsultarOperacionResponseType obtenerOperacion = operacion12Port.consultarOperacionByIdOperacion(request);
            ModelUtils.logEndWS(logger, obtenerOperacion,
                FenixModelConstants.WSC_CONSULTAR_DETALLE_OPERACION, horaInicio);

            List<Operacion> listaOperacionesObtenidas = obtenerOperacion.getOperacion();

            if (!listaOperacionesObtenidas.isEmpty()) {
                Operacion operacion2 = listaOperacionesObtenidas.get(0);
                operacion.setCodigoOperacion(idOperacion.intValue());
                operacion.setResponsableOperacion(usuario);

                if (null != operacion2.getNombre()) {
                    logger.warning("Nombre operacion " +
                        operacion2.getNombre());
                    operacion.setNombreOperacion(operacion2.getNombre());
                } else {
                    logger.severe("Nombre operacion es nulo");
                }

                if (null != operacion2.getCliente()) {
                    Long claveCliente = operacion2.getCliente().getIdCliente();
                    operacion.setCodigoCliente(claveCliente.toString());

                    if (null != operacion2.getCliente().getRazonSocial()) {
                        operacion.setNombreCliente(operacion2.getCliente()
                                                             .getRazonSocial());
                    }

                    if (null != operacion2.getCliente().getPais()
                                              .getDescripcion()) {
                        operacion.setPais(operacion2.getCliente().getPais()
                                                    .getDescripcion());
                    }
                }

                if (null != operacion2.getProducto()) {
                    Long claveProducto = operacion2.getProducto().getIdProducto();
                    operacion.setCodigoProducto(claveProducto.intValue());

                    if (null != operacion2.getProducto().getDescripcion()) {
                        operacion.setNombreProducto(operacion2.getProducto()
                                                              .getDescripcion());
                    }
                }
            }
        } catch (Exception ex) {
            logger.warning("mensaje error " + ex.getMessage());
        }

        Header header = new Header();

        if (null != operacion) {
            String wsdl2 = fenixAMImpl.getWsdl(IWsdlLocation.PROCESOS_ALTERNOS);
            ProcesosAlternosBindingQSService procesosAlternosBindingQSService = IWsdlLocation.Service.getInstance(ProcesosAlternosBindingQSService.class,
                    wsdl2);
            ProcesosAlternosPortType procesosAlternosPortType = procesosAlternosBindingQSService.getProcesosAlternosBindingQSPort();
            ParameterType idAdquisiciones = new ParameterType();
            idAdquisiciones.setParameterName("ID_ADQUISICION");
            idAdquisiciones.setParameterValue(idAdquisicion.toString());
            header.getParameterType().add(idAdquisiciones);

            ParameterType idObjecion = new ParameterType();
            idObjecion.setParameterName("ID_NO_OBJECION");
            idObjecion.setParameterValue(idNoObjecion.toString());
            header.getParameterType().add(idObjecion);
            header.setOperacion(operacion);

            String msgError = "";
            String mensajeError = "";
            String detalleError = "";

            try {
                Date horaInicio2 = ModelUtils.logStartWS(logger, header,
                        FenixModelConstants.WSC_INICIO_ADQUISCION);
                Resultado response2 = procesosAlternosPortType.inicioAdquisicion(header);
                ModelUtils.logEndWS(logger, response2,
                    FenixModelConstants.WSC_INICIO_ADQUISCION, horaInicio2);

                if ((null != response2.getError()) ||
                        ((response2.getResult() != null) &&
                        (response2.getResult().value() == "ERROR"))) {
                    if ((null != response2.getMessage()) &&
                            (response2.getMessage().trim().length() > 0)) {
                        mensajeError = response2.getMessage();
                    }

                    if ((null != response2.getError()) &&
                            (null != response2.getError().getErrorDescription()) &&
                            (response2.getError().getErrorDescription().trim()
                                          .length() > 0)) {
                        detalleError = response2.getError().getErrorDescription();
                    }

                    msgError = "No es posible iniciar el proceso de adquisciones. " +
                        ". Mensaje: " + mensajeError + ". " + detalleError;
                    throw new Exception();
                }
            } catch (Exception e) {
                logger.log(ADFLogger.ERROR,
                    "Error en inicio adquisiciones" + e.getClass() + ":" +
                    e.getMessage());

                JboException ex;

                if (msgError != null) {
                    ex = new JboException(msgError);
                } else {
                    ex = new JboException(e);
                    ex.addToExceptions(new Exception(
                            "Error en inicio adquisiciones " + e.getClass() +
                            ":" + e.getMessage()));
                }

                throw ex;
            }
        }

        logger.warning("Fuera de iniciarProceso,return :" + respuesta);

        return respuesta;
    }

    /**
     *  Se validan campos requeridos para finalizar tarea de Emitir Respuesta Cliente
     *  @author Josue Hernandez
     */
    public Boolean validaCamposEmitir() {
        logger.log(ADFLogger.WARNING, "Into validaCamposEmitir.");

        Boolean result = Boolean.FALSE;
        Row emitirRespuestaRow = this.getCurrentRow();

        if (emitirRespuestaRow != null) {
            if ((emitirRespuestaRow.getAttribute("SeHaRevisadoPublicacion") != null) &&
                    (emitirRespuestaRow.getAttribute("NumeroCorrespondencia") != null) &&
                    (emitirRespuestaRow.getAttribute("SeOtorgoNoObjecion") != null) &&
                    (emitirRespuestaRow.getAttribute("FechaFirmaDocto") != null)) {
                result = Boolean.TRUE;
            }
        }

        logger.log(ADFLogger.WARNING, "result: " + result);

        return result;
    }

    /**
     *  M&eacujte;todo para crear un nuevo registro de adjudicatarios
     *  @author Jonathan Ruiz
     */
    public void crearRowAdjudicatario(Long idNoObjecion) {
        logger.log(ADFLogger.WARNING, "Into crearRowAdjudicatario.");
        logger.log(ADFLogger.WARNING, "idNoObjecion: " + idNoObjecion);

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();
        fenixAdquisicionesAMImpl.getAdjudicatariosVO()
                                .crearRowAdjudicatario(idNoObjecion);
    }

    /**
     *  M&eacujte;todo para eliminar el adjudicatario seleccionado
     *  @author Jonathan Ruiz
     *  @param id
     */
    public void eliminarAdjudicatario(Long id) {
        logger.log(ADFLogger.WARNING, "Into eliminarAdjudicatario.");

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();
        Row seleccionado = fenixAdquisicionesAMImpl.getAdjudicatariosVO()
                                                   .getRow(new Key(
                    new Object[] { id }));
        fenixAdquisicionesAMImpl.getAdjudicatariosVO()
                                .eliminarAdjudicatario(seleccionado);
    }

    /**
     *  M&eacujte;todo para crear un nuevo registro de contratados
     *  @author Jonathan Ruiz
     */
    public void crearRowContratado(Long idNoObjecion) {
        logger.log(ADFLogger.WARNING, "Into crearRowContratado.");
        logger.log(ADFLogger.WARNING, "idNoObjecion: " + idNoObjecion);

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();
        fenixAdquisicionesAMImpl.getContratadosVO()
                                .crearRowContratado(idNoObjecion);
    }

    /**
     *  M&eacujte;todo para eliminar el contratado seleccionado
     *  @author Jonathan Ruiz
     *  @param id
     */
    public void eliminarContratado(Long id) {
        logger.log(ADFLogger.WARNING, "Into eliminarContratado.");

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();
        Row contratadoSeleccionado = fenixAdquisicionesAMImpl.getContratadosVO()
                                                             .getRow(new Key(
                    new Object[] { id }));
        fenixAdquisicionesAMImpl.getContratadosVO()
                                .eliminarContratado(contratadoSeleccionado);
    }

    /**
     *  M&eacujte;todo para contratar el adjudicatario seleccionado
     *  @author Jonathan Ruiz
     *  @param id del oferente
     */
    public void contratarAdjudicatario(Long id) {
        logger.warning("Into contratarAdjudicatario.");

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();
        Row adjudicatarioSeleccionado = fenixAdquisicionesAMImpl.getAdjudicatariosVO()
                                                                .getRow(new Key(
                    new Object[] { id }));
        fenixAdquisicionesAMImpl.getContratadosVO()
                                .contratarAdjudicatario(adjudicatarioSeleccionado);
        fenixAdquisicionesAMImpl.getAdjudicatariosVO()
                                .eliminarAdjudicatario(adjudicatarioSeleccionado);
    }

    /**
     *  M&eacujte;todo para remover el adjudicatario seleccionado
     *  @author Jonathan Ruiz
     *  @param id
     */
    public void removerAdjudicatario(Long id) {
        logger.log(ADFLogger.WARNING, "Into removerAdjudicatario." + id);

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();
        Row adjudicatarioSeleccionado = fenixAdquisicionesAMImpl.getAdjudicatariosVO()
                                                                .getRow(new Key(
                    new Object[] { id }));
        fenixAdquisicionesAMImpl.getOferentesVO()
                                .removerAdjudicatario(adjudicatarioSeleccionado);
        fenixAdquisicionesAMImpl.getAdjudicatariosVO()
                                .eliminarAdjudicatario(adjudicatarioSeleccionado);
    }

    /**
     *  M&eacujte;todo para eliminar todos los concursantes
     *  @author Jonathan Ruiz
     */
    public void eliminarConcursantes() {
        logger.log(ADFLogger.WARNING, "Into eliminarConcursantes.");

        // TODO implementar
    }

    /**
     *  M&eacujte;todo para remover el contratado seleccionado
     *  @author Jonathan Ruiz
     *  @param id
     */
    public void removerContratado(Long id) {
        logger.log(ADFLogger.WARNING, "Into removerContratado.");
        logger.log(ADFLogger.WARNING, "Id Contratado:" + id);

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();
        Row adjudicatarioSeleccionado = fenixAdquisicionesAMImpl.getContratadosVO()
                                                                .getRow(new Key(
                    new Object[] { id }));

        Row noObjecionCurrentRow = getCurrentRow();
        Integer idTipoNoObjecion = (Integer) noObjecionCurrentRow.getAttribute(
                "IdTcaTipoNoObjecion");

        if ((null != idTipoNoObjecion) &&
                (idTipoNoObjecion.compareTo(11) != 0)) {
            fenixAdquisicionesAMImpl.getAdjudicatariosVO()
                                    .removerContratado(adjudicatarioSeleccionado);
        }

        fenixAdquisicionesAMImpl.getContratadosVO()
                                .eliminarContratado(adjudicatarioSeleccionado);
    }

    /**
     *  M&eacujte;todo para los campos de la no objeci&oacujte;n
     *  @author Jonathan Ruiz
     *  @param id
     */
    @SuppressWarnings("unchecked")
    public Map validarCampos(Long idAdquisicion) {
        logger.log(ADFLogger.WARNING, "Into validarCampos." + idAdquisicion);

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();
        Row adquisicionRow = fenixAdquisicionesAMImpl.getAdquisicionVO()
                                                     .getRow(new Key(
                    new Object[] { idAdquisicion }));
        Boolean noObjecionContrato = Boolean.FALSE;

        Map<String, Object> map = new HashMap<String, Object>();
        Row row = getCurrentRow();

        int idTcaTipoNoObjecion = 0;

        if (null != row) {
            idTcaTipoNoObjecion = (Integer) row.getAttribute(NoObjecionVORowImpl.AttributesEnum.IdTcaTipoNoObjecion.toString());
        }

        int modalidad = 0;

        if ((null != adquisicionRow) &&
                (null != adquisicionRow.getAttribute(
                    "IdTcaTipoModalidadProceso"))) {
            modalidad = (Integer) adquisicionRow.getAttribute(
                    "IdTcaTipoModalidadProceso");
        }

        int resultadoProceso = 0;

        if (null != row) {
            if (null != (Integer) row.getAttribute(
                        NoObjecionVORowImpl.AttributesEnum.IdTcaResultadoProceso.toString())) {
                resultadoProceso = (Integer) row.getAttribute(NoObjecionVORowImpl.AttributesEnum.IdTcaResultadoProceso.toString());
            }
        }

        logger.warning("idTcaTipoNoObjecion: " + idTcaTipoNoObjecion);
        logger.warning("resultadoProceso: " + resultadoProceso);

        switch (idTcaTipoNoObjecion) {
        case FenixModelConstants.NO_OBJECION_AVISO:
            map = anexarValidaciones(map, validarCamposAviso(row));

            break;

        case FenixModelConstants.NO_OBJECION_INFORME_RESULTADOS:
            map = anexarValidaciones(map, validarCamposInforme(row));
            map = anexarValidaciones(map,
                    validarCamposOferentes(row, idTcaTipoNoObjecion));

            if (resultadoProceso == FenixModelConstants.NO_OBJECION_RESULTADO_ADJUDICADO) {
                map = anexarValidaciones(map,
                        validarCamposAdjudicatarios(row, idTcaTipoNoObjecion,
                            Boolean.TRUE));
            }

            break;

        case FenixModelConstants.NO_OBJECION_CONTRATO:
            noObjecionContrato = validaContratos(row);

            if (noObjecionContrato) {
                map = anexarValidaciones(map, validarContratados(row));
            } else {
                map = anexarValidaciones(map, validarCamposContrato(row));
                map = anexarValidaciones(map,
                        validarCamposContratados(row, modalidad));
            }

            break;

        case FenixModelConstants.NO_OBJECION_RESULTADO_PROCESO:
            map = anexarValidaciones(map, validarCamposProceso(row));
            map = anexarValidaciones(map,
                    validarCamposAdjudicatarios(row, idTcaTipoNoObjecion,
                        Boolean.FALSE));

            break;

        case FenixModelConstants.NO_OBJECION_CARGO_COMPRA:
            logger.info(
                "NO_OBJECION_CARGO_COMPRA.validarCamposContratados.modalidad:" +
                modalidad);
            map = anexarValidaciones(map, validarCamposContrato(row));
            map = anexarValidaciones(map,
                    validarCamposContratados(row, modalidad));

            break;
        }

        return map;
    }

    private Map validarCamposAviso(Row noObjecion) {
        ResourceBundle rb = BundleFactory.getBundle(
                "org.bcie.fenix.common.model.FenixModelBundle");

        Map<String, Object> map = new HashMap<String, Object>();
        Map<String, Object> mapMensajes = new HashMap<String, Object>();

        String lugarObtenerDocBase = null;
        Timestamp fechaPublicacion = null;
        Timestamp fechaInicioDocBase = null;
        Timestamp fechaFinDocBase = null;
        Timestamp fechaRecepcion = null;
        String correoInfoAdicional = null;
        String dirPresentPropuesta = null;

        Boolean RN_05 = Boolean.FALSE;
        Boolean RN_06 = Boolean.FALSE;
        Boolean RN_07 = Boolean.FALSE;
        Boolean RN_08 = Boolean.FALSE;
        Boolean VA_50 = Boolean.FALSE;

        if (null != noObjecion) {
            if (null != noObjecion.getAttribute(
                        NoObjecionVORowImpl.AttributesEnum.LugarObtenerDoctoBase.toString())) {
                lugarObtenerDocBase = (String) noObjecion.getAttribute(NoObjecionVORowImpl.AttributesEnum.LugarObtenerDoctoBase.toString());
            }

            if (null != noObjecion.getAttribute(
                        NoObjecionVORowImpl.AttributesEnum.FechaPublicacion.toString())) {
                fechaPublicacion = (Timestamp) noObjecion.getAttribute(NoObjecionVORowImpl.AttributesEnum.FechaPublicacion.toString());
            }

            if (null != noObjecion.getAttribute(
                        NoObjecionVORowImpl.AttributesEnum.FechaInicioDispDoctoBase.toString())) {
                fechaInicioDocBase = (Timestamp) noObjecion.getAttribute(NoObjecionVORowImpl.AttributesEnum.FechaInicioDispDoctoBase.toString());
            }

            if (null != noObjecion.getAttribute(
                        NoObjecionVORowImpl.AttributesEnum.FechaFinDispDoctoBase.toString())) {
                fechaFinDocBase = (Timestamp) noObjecion.getAttribute(NoObjecionVORowImpl.AttributesEnum.FechaFinDispDoctoBase.toString());
            }

            if (null != noObjecion.getAttribute(
                        NoObjecionVORowImpl.AttributesEnum.FechaRecepcionPropuesta.toString())) {
                fechaRecepcion = (Timestamp) noObjecion.getAttribute(NoObjecionVORowImpl.AttributesEnum.FechaRecepcionPropuesta.toString());
            }

            if (null != noObjecion.getAttribute(
                        NoObjecionVORowImpl.AttributesEnum.CorreoInformacionAdicional.toString())) {
                correoInfoAdicional = (String) noObjecion.getAttribute(NoObjecionVORowImpl.AttributesEnum.CorreoInformacionAdicional.toString());
            }

            if (null != noObjecion.getAttribute(
                        NoObjecionVORowImpl.AttributesEnum.DirPresentacionPropuesta.toString())) {
                dirPresentPropuesta = (String) noObjecion.getAttribute(NoObjecionVORowImpl.AttributesEnum.DirPresentacionPropuesta.toString());
            }
        }

        if (null != correoInfoAdicional) {
            String expression = "^[_A-Za-z0-9-]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9]+)*(\\.[A-Za-z]{2,})$";
            Pattern pattern = Pattern.compile(expression);
            Matcher matcher = pattern.matcher(correoInfoAdicional);

            //el correo ingresado debe corresponder al formato de una direccion de correo electronica.
            if (!matcher.matches()) {
                VA_50 = Boolean.TRUE;
                mapMensajes.put("VA_50",
                    rb.getString(
                        "org.bcie.fenix.common.model.vo.NoObjecionVO.VA50"));
            }
        }

        map.put("noObjecion", (null == noObjecion));

        map.put("lugarObtenerDocBase", (null == lugarObtenerDocBase));
        map.put("fechaPublicacion", (null == fechaPublicacion));
        map.put("fechaInicioDocBase", (null == fechaInicioDocBase));
        map.put("fechaFinDocBase", (null == fechaFinDocBase));
        map.put("fechaRecepcion", (null == fechaRecepcion));
        map.put("correoInfoAdicional", (null == correoInfoAdicional));
        map.put("dirPresentPropuesta", (null == dirPresentPropuesta));

        //mensajes
        if (null == lugarObtenerDocBase) {
            mapMensajes.put("lugarObtenerDocBase",
                rb.getString(
                    "org.bcie.fenix.common.model.vo.NoObjecionVO.Lugar.vacio"));
        }

        if (null == fechaPublicacion) {
            mapMensajes.put("fechaPublicacion",
                rb.getString(
                    "org.bcie.fenix.common.model.vo.NoObjecionVO.FechaPub.requerido"));
        }

        if (null == fechaInicioDocBase) {
            mapMensajes.put("fechaInicioDocBase",
                rb.getString(
                    "org.bcie.fenix.common.model.vo.NoObjecionVO.FechaIni.requerido"));
        }

        if (null == fechaFinDocBase) {
            mapMensajes.put("fechaFinDocBase",
                rb.getString(
                    "org.bcie.fenix.common.model.vo.NoObjecionVO.FechaFin.requerido"));
        }

        if (null == fechaRecepcion) {
            mapMensajes.put("fechaRecepcion",
                rb.getString(
                    "org.bcie.fenix.common.model.vo.NoObjecionVO.FechaRep.requerido"));
        }

        if (null == correoInfoAdicional) {
            mapMensajes.put("correoInfoAdicional",
                rb.getString(
                    "org.bcie.fenix.common.model.vo.NoObjecionVO.Correo.requerido"));
        }

        if (null == dirPresentPropuesta) {
            mapMensajes.put("dirPresentPropuesta",
                rb.getString(
                    "org.bcie.fenix.common.model.vo.NoObjecionVO.Direcc.requerido"));
        }

        if ((null != fechaPublicacion) && (null != fechaInicioDocBase)) {
            Integer compDateRN05 = fechaPublicacion.compareTo(fechaInicioDocBase);

            //La fecha de publicacion debe ser menor o igual a la fecha de inicio de disponibilidad de documento base.
            if ((null != RN_05) && (Integer.compare(compDateRN05, 1) == 0)) {
                RN_05 = Boolean.TRUE;
                mapMensajes.put("RN_05",
                    rb.getString(
                        "org.bcie.fenix.common.model.vo.NoObjecionVO.RN05"));
            }
        }

        if ((null != fechaInicioDocBase) && (null != fechaFinDocBase)) {
            Integer compDateRN06 = fechaInicioDocBase.compareTo(fechaFinDocBase);
            Integer compDateRN07 = fechaFinDocBase.compareTo(fechaInicioDocBase);

            //La fecha de inicio de disponibilidad de documento base debe ser menor a la fecha de fin de disponibilidad de documento base.
            if ((null != RN_06) && (Integer.compare(compDateRN06, -1) > 0)) {
                RN_06 = Boolean.TRUE;
                mapMensajes.put("RN_06",
                    rb.getString(
                        "org.bcie.fenix.common.model.vo.NoObjecionVO.RN06"));
            }

            //La fecha de fin de disponibilidad de documento base debe ser mayor a la fecha inicio de disponibilidad de documento base.
            if ((null != RN_07) && (Integer.compare(compDateRN07, 1) < 0)) {
                RN_07 = Boolean.TRUE;
                mapMensajes.put("RN_07",
                    rb.getString(
                        "org.bcie.fenix.common.model.vo.NoObjecionVO.RN07"));
            }
        }

        if ((null != fechaRecepcion) && (null != fechaFinDocBase)) {
            Integer compDateRN08 = fechaRecepcion.compareTo(fechaFinDocBase);

            //La fecha de recepcion de propuestas debe ser mayor o igual a la fecha de fin de disponibilidad de documento base.
            if ((null != RN_08) && (Integer.compare(compDateRN08, 0) < 0)) {
                RN_08 = Boolean.TRUE;
                mapMensajes.put("RN_08",
                    rb.getString(
                        "org.bcie.fenix.common.model.vo.NoObjecionVO.RN08"));
            }
        }

        map.put("fechaPublicacion", (null == fechaPublicacion));
        map.put("fechaInicioDocBase", (null == fechaInicioDocBase));
        map.put("fechaFinDocBase", (null == fechaFinDocBase));
        map.put("fechaRecepcion", (null == fechaRecepcion));
        map.put("correoInfoAdicional", (null == correoInfoAdicional));
        map.put("dirPresentPropuesta", (null == dirPresentPropuesta));

        map.put("RN_05", RN_05);
        map.put("RN_06", RN_06);
        map.put("RN_07", RN_07);
        map.put("RN_08", RN_08);
        map.put("VA_50", VA_50);

        map.put("mensajes", mapMensajes);

        return map;
    }

    private Map validarCamposContrato(Row noObjecion) {
        ResourceBundle rb = BundleFactory.getBundle(
                "org.bcie.fenix.common.model.FenixModelBundle");
        logger.warning("rb.is:" + rb);

        Map<String, Object> map = new HashMap<String, Object>();
        Map<String, Object> mapMensajes = new HashMap<String, Object>();

        boolean contratadosRequeridos = Boolean.FALSE;

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();

        if (fenixAdquisicionesAMImpl.getContratadosVO().numRegistros() == 0) {
            contratadosRequeridos = Boolean.TRUE;
        }

        map.put("noObjecion", (null == noObjecion));
        map.put("contratadosRequeridos", contratadosRequeridos);

        //logger.warning("***bundle: "+rb.getString("org.bcie.fenix.common.model.vo.ContratadosVO.requerido"));

        //mensajes
        if (contratadosRequeridos == true) {
            mapMensajes.put("contratadosRequeridos",
                rb.getString(
                    "org.bcie.fenix.common.model.vo.ContratadosVO.requerido"));
        }

        map.put("mensajes", mapMensajes);

        return map;
    }

    private Map validarContratados(Row noObjecion) {
        ResourceBundle rb = BundleFactory.getBundle(
                "org.bcie.fenix.common.model.FenixModelBundle");
        logger.warning("rb.is:" + rb);

        Map<String, Object> map = new HashMap<String, Object>();
        Map<String, Object> mapMensajes = new HashMap<String, Object>();

        boolean contratadosRequeridos = Boolean.FALSE;

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();

        if (fenixAdquisicionesAMImpl.getContratadosAdjudicatariosVO()
                                        .numRegistros() == 0) {
            contratadosRequeridos = Boolean.TRUE;
        }

        map.put("noObjecion", (null == noObjecion));
        map.put("contratadosRequeridos", contratadosRequeridos);

        //logger.warning("***bundle: "+rb.getString("org.bcie.fenix.common.model.vo.ContratadosVO.requerido"));

        //mensajes
        if (contratadosRequeridos == true) {
            mapMensajes.put("contratadosRequeridos",
                rb.getString(
                    "org.bcie.fenix.common.model.vo.ContratadosVO.requerido"));
        }

        map.put("mensajes", mapMensajes);

        return map;
    }

    private Map validarCamposProceso(Row noObjecion) {
        ResourceBundle rb = BundleFactory.getBundle(
                "org.bcie.fenix.common.model.FenixModelBundle");

        Map<String, Object> map = new HashMap<String, Object>();
        Map<String, Object> mapMensajes = new HashMap<String, Object>();

        Boolean adjudicatariosRequeridos = Boolean.FALSE;

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();

        if (fenixAdquisicionesAMImpl.getAdjudicatariosVO().numRegistros() == 0) {
            adjudicatariosRequeridos = Boolean.TRUE;
        }

        map.put("noObjecion", (null == noObjecion));
        map.put("adjudicatariosRequeridos", adjudicatariosRequeridos);

        //mensajes
        if (adjudicatariosRequeridos) {
            mapMensajes.put("adjudicatariosRequeridos",
                rb.getString(
                    "org.bcie.fenix.common.model.vo.AdjudicatariosVO.requerido"));
        }

        map.put("mensajes", mapMensajes);

        return map;
    }

    private Map validarCamposInforme(Row noObjecion) {
        ResourceBundle rb = BundleFactory.getBundle(
                "org.bcie.fenix.common.model.FenixModelBundle");

        Map<String, Object> map = new HashMap<String, Object>();
        Map<String, Object> mapMensajes = new HashMap<String, Object>();

        Boolean idTcaResultadoProceso = Boolean.FALSE;

        if (null != noObjecion) {
            if (null == noObjecion.getAttribute(
                        NoObjecionVORowImpl.AttributesEnum.IdTcaResultadoProceso.toString())) {
                idTcaResultadoProceso = Boolean.TRUE;
            }
        }

        map.put("noObjecion", (null == noObjecion));
        map.put("idTcaResultadoProceso", idTcaResultadoProceso);

        //mensajes
        if (idTcaResultadoProceso) {
            mapMensajes.put("idTcaResultadoProceso",
                rb.getString(
                    "org.bcie.fenix.common.model.vo.NoObjecionVO.Resultado.requerido"));
        }

        map.put("mensajes", mapMensajes);

        return map;
    }

    private Map validarCamposOferentes(Row noObjecion, int idTcaTipoNoObjecion) {
        ResourceBundle rb = BundleFactory.getBundle(
                "org.bcie.fenix.common.model.FenixModelBundle");

        Map<String, Object> map = new HashMap<String, Object>();
        Map<String, Object> mapMensajes = new HashMap<String, Object>();

        Boolean nombreOferente = Boolean.FALSE;
        Boolean nacionalidadOferente = Boolean.FALSE;
        Boolean ambosOferente = Boolean.FALSE;

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();

        int oferentesValidos = fenixAdquisicionesAMImpl.getOferentesVO()
                                                       .validarCampos();

        switch (oferentesValidos) {
        case 0:
            nombreOferente = Boolean.TRUE;
            mapMensajes.put("nombreOferente",
                rb.getString(
                    "org.bcie.fenix.common.model.vo.OferentesVO.nombre.requerido"));

            break;

        case 1:
            nacionalidadOferente = Boolean.TRUE;
            mapMensajes.put("nacionalidadOferente",
                rb.getString(
                    "org.bcie.fenix.common.model.vo.OferentesVO.nacionalidad.requerido"));

            break;

        case 2:
            ambosOferente = Boolean.TRUE;
            mapMensajes.put("ambosOferente",
                rb.getString(
                    "org.bcie.fenix.common.model.vo.OferentesVO.nacionalidad.requerido"));

            break;
        }

        map.put("noObjecion", (null == noObjecion));
        map.put("nombreOferente", nombreOferente);
        map.put("nacionalidadOferente", nacionalidadOferente);
        map.put("ambosOferente", ambosOferente);

        map.put("mensajes", mapMensajes);

        return map;
    }

    private Map validarCamposContratados(Row noObjecion, int modalidad) {
        ResourceBundle rb = BundleFactory.getBundle(
                "org.bcie.fenix.common.model.FenixModelBundle");

        Map<String, Object> map = new HashMap<String, Object>();
        Map<String, Object> mapMensajes = new HashMap<String, Object>();

        Boolean todosContatado = Boolean.FALSE;
        Boolean instanciaContratado = Boolean.FALSE;

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();

        boolean validarInstancia = (modalidad == FenixModelConstants.MODALIDAD_DIRECTO4);
        int contratadosValidos = fenixAdquisicionesAMImpl.getContratadosVO()
                                                         .validarCampos(validarInstancia);

        switch (contratadosValidos) {
        case 0:
            todosContatado = Boolean.TRUE;
            mapMensajes.put("todosContatado",
                rb.getString(
                    "org.bcie.fenix.common.model.vo.ContratadosVO.todos.requerido"));

            break;

        case 1:
            instanciaContratado = Boolean.TRUE;
            mapMensajes.put("instanciaContratado",
                rb.getString(
                    "org.bcie.fenix.common.model.vo.ContratadosVO.instancia.requerido"));

            break;
        }

        map.put("noObjecion", (null == noObjecion));
        map.put("todosContatado", todosContatado);
        map.put("instanciaContratado", instanciaContratado);

        map.put("mensajes", mapMensajes);

        return map;
    }

    private Map validarCamposAdjudicatarios(Row noObjecion,
        int idTcaTipoNoObjecion, boolean soloMonto) {
        logger.warning("Entrando en validarCamposAdjudicatarios.");

        ResourceBundle rb = BundleFactory.getBundle(
                "org.bcie.fenix.common.model.FenixModelBundle");

        Map<String, Object> map = new HashMap<String, Object>();
        Map<String, Object> mapMensajes = new HashMap<String, Object>();

        Boolean todosAdjudicatarios = Boolean.FALSE;
        Boolean montoAdjudicatarios = Boolean.FALSE;
        Boolean adjudicatariosRequeridos = Boolean.FALSE;
        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = getFenixAdquisicionAM();

        int adjudicatariosValidos = fenixAdquisicionesAMImpl.getAdjudicatariosVO()
                                                            .validarCampos(soloMonto);

        switch (adjudicatariosValidos) {
        case 0:
            todosAdjudicatarios = Boolean.TRUE;
            mapMensajes.put("todosAdjudicatarios",
                rb.getString(
                    "org.bcie.fenix.common.model.vo.AdjudicatariosVO.todos.requerido"));

            break;

        case 1:
            montoAdjudicatarios = Boolean.TRUE;
            mapMensajes.put("montoAdjudicatarios",
                rb.getString(
                    "org.bcie.fenix.common.model.vo.AdjudicatariosVO.monto.requerido"));

            break;

        default:
            break;
        }

        if (fenixAdquisicionesAMImpl.getAdjudicatariosVO().getEstimatedRowCount() <= 0) {
            adjudicatariosRequeridos = Boolean.TRUE;
            mapMensajes.put("adjudicatariosRequeridos",
                rb.getString(
                    "org.bcie.fenix.common.model.vo.AdjudicatariosVO.requerido"));
        }

        map.put("noObjecion", (null == noObjecion));
        map.put("todosAdjudicatarios", todosAdjudicatarios);
        map.put("montoAdjudicatarios", montoAdjudicatarios);
        map.put("adjudicatariosRequeridos", adjudicatariosRequeridos);

        map.put("mensajes", mapMensajes);

        return map;
    }

    private Map anexarValidaciones(Map<String, Object> map,
        Map<String, Object> newMap) {
        if (null == map) {
            map = new HashMap<String, Object>();
        }

        if (null == newMap) {
            newMap = new HashMap<String, Object>();
        }

        Map<String, Object> mapMensajes = (Map<String, Object>) map.get(
                "mensajes");
        Map<String, Object> newMapMensajes = (Map<String, Object>) newMap.get(
                "mensajes");

        if (null == mapMensajes) {
            mapMensajes = new HashMap<String, Object>();
        }

        if (null == newMapMensajes) {
            newMapMensajes = new HashMap<String, Object>();
        }

        mapMensajes.putAll(newMapMensajes);
        map.putAll(newMap);
        map.put("mensajes", mapMensajes);

        return map;
    }

    /**
     *  M&eacujte;todo para los campos de la emisi&oacute;n
     *  @author Jonathan Ruiz
     *  @param id
     */
    @SuppressWarnings("unchecked")
    public Map validarCamposEmision() {
        logger.log(ADFLogger.WARNING, "Into validarCamposEmision.");

        ResourceBundle rb = BundleFactory.getBundle(
                "org.bcie.fenix.common.model.FenixModelBundle");
        Row noObjecionRow = getCurrentRow();
        Map<String, Object> map = new HashMap<String, Object>();
        Map<String, Object> mapMensajes = new HashMap<String, Object>();

        Boolean seHaRevisadoPublicacion = null;
        String numeroCorrespondencia = null;
        Boolean seOtorgoNoObjecion = null;
        Timestamp fechaFirmaDocto = null;

        Boolean seHaRevisado = Boolean.FALSE;

        try {
            if (null != noObjecionRow) {
                if (null != noObjecionRow.getAttribute(
                            NoObjecionVORowImpl.AttributesEnum.SeHaRevisadoPubTransient.toString())) {
                    seHaRevisadoPublicacion = (Boolean) noObjecionRow.getAttribute(NoObjecionVORowImpl.AttributesEnum.SeHaRevisadoPubTransient.toString());
                }

                if (null != noObjecionRow.getAttribute(
                            NoObjecionVORowImpl.AttributesEnum.NumCorrespondenciaTransient.toString())) {
                    numeroCorrespondencia = (String) noObjecionRow.getAttribute(NoObjecionVORowImpl.AttributesEnum.NumCorrespondenciaTransient.toString());
                }

                if (null != noObjecionRow.getAttribute(
                            NoObjecionVORowImpl.AttributesEnum.SeOtorgoNoObjecionTransient.toString())) {
                    seOtorgoNoObjecion = (Boolean) noObjecionRow.getAttribute(NoObjecionVORowImpl.AttributesEnum.SeOtorgoNoObjecionTransient.toString());
                }

                if (null != noObjecionRow.getAttribute(
                            NoObjecionVORowImpl.AttributesEnum.FechaFirmaDocTransient.toString())) {
                    fechaFirmaDocto = (Timestamp) noObjecionRow.getAttribute(NoObjecionVORowImpl.AttributesEnum.FechaFirmaDocTransient.toString());
                }
            }

            if ((null != seHaRevisadoPublicacion) &&
                    seHaRevisadoPublicacion.equals(Boolean.TRUE)) {
                seHaRevisado = Boolean.TRUE;
            }

            map.put("noObjecion", (null == noObjecionRow));

            map.put("seHaRevisadoPublicacion", !seHaRevisado);
            map.put("numeroCorrespondencia",
                (seHaRevisado && (null == numeroCorrespondencia)));
            map.put("seOtorgoNoObjecion",
                (seHaRevisado && (null == seOtorgoNoObjecion)));
            map.put("fechaFirmaDocto",
                (seHaRevisado && (null == fechaFirmaDocto)));

            //mensajes
            if (seHaRevisado.equals(Boolean.FALSE)) {
                mapMensajes.put("seHaRevisadoPublicacion",
                    rb.getString(
                        "org.bcie.fenix.common.model.vo.NoObjecionVO.revInformacion.requerido"));
            }

            if (seHaRevisado && (null == numeroCorrespondencia)) {
                mapMensajes.put("numeroCorrespondencia",
                    rb.getString(
                        "org.bcie.fenix.common.model.vo.NoObjecionVO.numCorrespondencia.requerido"));
            }

            if (seHaRevisado && (null == seOtorgoNoObjecion)) {
                mapMensajes.put("seOtorgoNoObjecion",
                    rb.getString(
                        "org.bcie.fenix.common.model.vo.NoObjecionVO.otroga.requerido"));
            }

            if (seHaRevisado && (null == fechaFirmaDocto)) {
                mapMensajes.put("fechaFirmaDocto",
                    rb.getString(
                        "org.bcie.fenix.common.model.vo.NoObjecionVO.fechaFirma.requerido"));
            }

            map.put("mensajes", mapMensajes);
            logger.warning("seHaRevisadoPublicacion:" +
                seHaRevisadoPublicacion);
            logger.warning("numeroCorrespondencia:" + numeroCorrespondencia);
            logger.warning("seOtorgoNoObjecion:" + seOtorgoNoObjecion);
            logger.warning("fechaFirmaDocto:" + fechaFirmaDocto);
        } catch (Exception e) {
            logger.warning("Error al validar los campos de la tarea de emision",
                e);
        }

        return map;
    }

    private void iniciarCamposTransient(Row noObjecionRow) {
        if (null != noObjecionRow) {
            Integer seHaRevisadoPublicacion = (Integer) noObjecionRow.getAttribute(
                    "SeHaRevisadoPublicacion");
            Integer seOtorgoNoObjecion = (Integer) noObjecionRow.getAttribute(
                    "SeOtorgoNoObjecion");
            String numCorrespondencia = (String) noObjecionRow.getAttribute(
                    "NumeroCorrespondencia");
            Timestamp fechaFirmaDoc = (Timestamp) noObjecionRow.getAttribute(
                    "FechaFirmaDocto");

            boolean seHaRevisadoPublicacionBol = Boolean.FALSE;
            Boolean seOtorgoNoObjecionBol = null;

            if ((null != seHaRevisadoPublicacion) &&
                    seHaRevisadoPublicacion.equals(new Integer(1))) {
                seHaRevisadoPublicacionBol = Boolean.TRUE;
            }

            if (null != seOtorgoNoObjecion) {
                if (seOtorgoNoObjecion.equals(new Integer(1))) {
                    seOtorgoNoObjecionBol = Boolean.TRUE;
                } else {
                    seOtorgoNoObjecionBol = Boolean.FALSE;
                }
            }

            noObjecionRow.setAttribute("SeHaRevisadoPubTransient",
                seHaRevisadoPublicacionBol);
            noObjecionRow.setAttribute("SeOtorgoNoObjecionTransient",
                seOtorgoNoObjecionBol);
            noObjecionRow.setAttribute("NumCorrespondenciaTransient",
                numCorrespondencia);
            noObjecionRow.setAttribute("FechaFirmaDocTransient", fechaFirmaDoc);
        }
    }

    public void precargaModalidad(Integer modalidad) {
        logger.log(ADFLogger.WARNING, "Entrando en precargaModalidad.");
        executeQuery();
        this.setRangeSize(-1);

        logger.warning("Registros encontrados " + getEstimatedRowCount());

        Row[] rows = this.getAllRowsInRange();

        for (Row iterador : rows) {
            logger.warning("row actual " + (Long) iterador.getAttribute("Id"));
            iterador.setAttribute("modalidad", modalidad);
            logger.warning("row modalidad registrada " +
                (Integer) iterador.getAttribute("modalidad"));
        }

        logger.log(ADFLogger.WARNING, "Saliendo de precargaModalidad.");
    }

    /**
     * Metodo para establecer la modalidad en una tarea
     * @param modalidad
     * @param idNoObjecion
     */
    public void precargaModalidadTarea(Integer modalidad, Long idNoObjecion) {
        logger.log(ADFLogger.WARNING, "Entrando en precargaModalidadTarea.");
        logger.log(ADFLogger.WARNING, "modalidad: " + modalidad);
        logger.log(ADFLogger.WARNING, "idNoObjecion: " + idNoObjecion);

        if ((null != modalidad) && (null != idNoObjecion)) {
            ViewCriteria viewCriteria = this.getViewCriteriaManager()
                                            .getViewCriteria("NoObjecionVOUnico");
            viewCriteria.ensureVariableManager()
                        .setVariableValue("varobjecion", idNoObjecion);
            this.applyViewCriteria(viewCriteria);

            executeQuery();
            this.setRangeSize(-1);

            logger.warning("Registros encontrados " + getEstimatedRowCount());

            Row[] rows = this.getAllRowsInRange();

            for (Row iterador : rows) {
                logger.warning("row actual " +
                    (Long) iterador.getAttribute("Id"));
                iterador.setAttribute("modalidad", modalidad);
                logger.warning("row modalidad registrada " +
                    (Integer) iterador.getAttribute("modalidad"));
            }

            //Se establece CurrentRow para evitar su perdida en ejecucion de ViewCriteria
            Row row = getRowAtRangeIndex(0);
            setCurrentRow(row);
        } else {
        }

        logger.log(ADFLogger.WARNING, "Saliendo de precargaModalidadTarea.");
    }

    private void fusionarCamposTransient() {
        logger.log(ADFLogger.WARNING, "inicio fusionarCamposTransient");
        Row noObjecionRow = getCurrentRow();
        
        if(noObjecionRow != null){ 
            Boolean seHaRevisadoPublicacionTr = noObjecionRow.getAttribute("SeHaRevisadoPubTransient") != null? (Boolean) noObjecionRow.getAttribute("SeHaRevisadoPubTransient") : false;
            Boolean seOtorgoNoObjecionTr = noObjecionRow.getAttribute("SeOtorgoNoObjecionTransient") != null? (Boolean) noObjecionRow.getAttribute("SeOtorgoNoObjecionTransient") : false;
            String numCorrespondenciaTr = noObjecionRow.getAttribute("NumCorrespondenciaTransient") != null? (String) noObjecionRow.getAttribute("NumCorrespondenciaTransient") : "";
            Timestamp fechaFirmaDocTr = noObjecionRow.getAttribute("FechaFirmaDocTransient") != null? (Timestamp) noObjecionRow.getAttribute("FechaFirmaDocTransient") : null;
    
            logger.log(ADFLogger.WARNING, "seHaRevisadoPublicacionTr: " + seHaRevisadoPublicacionTr);
            logger.log(ADFLogger.WARNING, "seOtorgoNoObjecionTr: " + seOtorgoNoObjecionTr);
            logger.log(ADFLogger.WARNING, "numCorrespondenciaTr: " + numCorrespondenciaTr);
            logger.log(ADFLogger.WARNING, "fechaFirmaDocTr: " + fechaFirmaDocTr);
            
            
            Integer seHaRevisadoPublicacion = 0;
            Integer seOtorgoNoObjecion = null; 
            if ((null != seHaRevisadoPublicacionTr) && seHaRevisadoPublicacionTr.equals(Boolean.TRUE)) 
            {
                seHaRevisadoPublicacion = 1;
            }

            if (null != seOtorgoNoObjecionTr) {
                if (seOtorgoNoObjecionTr.equals(Boolean.TRUE)) 
                {
                    seOtorgoNoObjecion = 1;
                }
                else 
                {
                    seOtorgoNoObjecion = 0;
                }
            }
            logger.log(ADFLogger.WARNING, "seHaRevisadoPublicacion: " + seHaRevisadoPublicacion);
            logger.log(ADFLogger.WARNING, "seOtorgoNoObjecion: " + seOtorgoNoObjecion);

            noObjecionRow.setAttribute("SeHaRevisadoPublicacion", seHaRevisadoPublicacion);
            noObjecionRow.setAttribute("SeOtorgoNoObjecion", seOtorgoNoObjecion);
            noObjecionRow.setAttribute("NumeroCorrespondencia", numCorrespondenciaTr);
            noObjecionRow.setAttribute("FechaFirmaDocto", fechaFirmaDocTr); 
        }
        else
        {
            logger.log(ADFLogger.WARNING, "noObjecionRow es null");
        }
        logger.log(ADFLogger.WARNING, "FIN fusionarCamposTransient");
    } 

    public void seleccionarNoObjecion(Long idNoObjecion) {
        if (null != idNoObjecion) {
            logger.warning("se recupera el valor");

            Row row = getNoObjecion(idNoObjecion, null);

            if (null != row) {
                logger.warning("se aplica el seteo del valor");
                setCurrentRow(row);
            } else {
                logger.warning("No se encuentra el row noObjecion");
            }
        } else {
            logger.warning("No se encuentra idNoObjecion");
        }
    }

    public void seleccionarNoObjecion2(Long idNoObjecion, Integer modalidad) {
        logger.warning("Inicia ");
        logger.warning("idNoObjecion " + idNoObjecion);
        logger.warning("modalidad  " + modalidad);

        if (null != idNoObjecion) {
            logger.warning("se recupera el valor");

            Row row = getNoObjecion(idNoObjecion, null);

            if (null != row) {
                logger.warning("se aplica el seteo del valor");
                logger.warning("valor de modalidad: " +
                    row.getAttribute("modalidad"));

                if (null != modalidad) {
                    row.setAttribute("modalidad", modalidad);
                }

                logger.warning("valor de modalidad actual: " +
                    row.getAttribute("modalidad"));
                logger.warning("Se encuentra el row noObjecion con id  " +
                    row.getAttribute("Id"));
                setCurrentRow(row);
            } else {
                logger.warning("No se encuentra el row noObjecion");
            }
        } else {
            logger.warning("No se encuentra idNoObjecion");
        }
    }

    /**
     * Returns the variable value for varobjecion.
     * @return variable value for varobjecion
     */
    public Long getvarobjecion() {
        return (Long) ensureVariableManager().getVariableValue("varobjecion");
    }

    /**
     * Sets <code>value</code> for variable varobjecion.
     * @param value value to bind as varobjecion
     */
    public void setvarobjecion(Long value) {
        ensureVariableManager().setVariableValue("varobjecion", value);
    }

    public void noObjecionUnica(Long idObjecion) {
        logger.warning("Entra a consulta  idObjecion: " + idObjecion);

        Boolean resultado = null;

        try {
            ViewCriteria viewCriteria = this.getViewCriteriaManager()
                                            .getViewCriteria("NoObjecionVOUnico");
            viewCriteria.ensureVariableManager()
                        .setVariableValue("varobjecion", idObjecion);
            this.applyViewCriteria(viewCriteria);
            this.executeQuery();

            //resultado = (this.getEstimatedRowCount() > 0) ? Boolean.TRUE : Boolean.FALSE;
            if (this.getEstimatedRowCount() > 0) {
                logger.warning("Existe row");

                Row row = getRowAtRangeIndex(0);

                if (null != row) {
                    setCurrentRow(row);
                    logger.warning("Existe row y se selecciona");
                }
            }
        } catch (Exception ex) {
            logger.log(ADFLogger.ERROR, "Error en a consulta  idObjecion ", ex);
        } finally {
            //This takes care of removing the applied VC.
            // this.getViewCriteriaManager().removeApplyViewCriteriaName("ConsultaAdquisicionPorTipoAdquisicionVC");
        }
    }

    public Boolean validaContratos(Row row) {
        logger.warning("Inside validaContratos.");

        Boolean result = Boolean.FALSE;

        if (row != null) {
            Integer idTcaTipoNoObjecion = (Integer) row.getAttribute(
                    "IdTcaTipoNoObjecion");

            if (idTcaTipoNoObjecion.compareTo(9) == 0) {
                result = Boolean.TRUE;
            }
        } else {
            logger.warning("No Objecion sin seleccionar.");
        }

        return result;
    }

    public Map recuperaDatos(Long idObjecion) {
        logger.log(ADFLogger.WARNING, "Entrado en recuperaDatos.");
        logger.log(ADFLogger.WARNING, "idObjecion: " + idObjecion);

        Map dato = new HashMap();
        Boolean respuesta = Boolean.TRUE;
        Long claveObjecion = null;
        Integer idtipo = null;
        Integer resultado = null;
        FenixAMImpl fenixAMImpl = null;
        fenixAMImpl = (FenixAMImpl) this.getRootApplicationModule();

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = (FenixAdquisicionAMImpl) fenixAMImpl.getFenixAdquisicionAM();

        if (null != idObjecion) {
            logger.warning(
                " existen datos de la noobjecion se precarga no objecion");
            seteaNoObjecion(idObjecion);

            Row fila = getCurrentRow();

            if (null != fila) {
                if (null != (Long) fila.getAttribute("Id")) {
                    claveObjecion = (Long) fila.getAttribute("Id");
                    dato.put("claveObjecion", claveObjecion);
                }

                if (null != (Integer) fila.getAttribute("IdTcaTipoNoObjecion")) {
                    idtipo = (Integer) fila.getAttribute("IdTcaTipoNoObjecion");
                    dato.put("idtipo", idtipo);
                }

                if (null != (Integer) fila.getAttribute("IdTcaResultadoProceso")) {
                    resultado = (Integer) fila.getAttribute(
                            "IdTcaResultadoProceso");
                    dato.put("resultado", resultado);
                }
            }

            if ((null != claveObjecion) && (null != idtipo)) {
                fenixAdquisicionesAMImpl.getOferentesVO().executeQuery();
                fenixAdquisicionesAMImpl.getAdjudicatariosVO().executeQuery();
                fenixAdquisicionesAMImpl.getContratadosVO().executeQuery();
                precargaConcursantes(claveObjecion, idtipo);
                logger.warning("se aplica el refrescado de las tabla");
            }
        } else {
            Row row = getCurrentRow();

            if (null != row) {
                if (null != (Long) row.getAttribute("Id")) {
                    claveObjecion = (Long) row.getAttribute("Id");
                    dato.put("claveObjecion", claveObjecion);
                }

                if (null != (Integer) row.getAttribute("IdTcaTipoNoObjecion")) {
                    idtipo = (Integer) row.getAttribute("IdTcaTipoNoObjecion");
                    dato.put("idtipo", idtipo);
                }

                if (null != (Integer) row.getAttribute("IdTcaResultadoProceso")) {
                    resultado = (Integer) row.getAttribute(
                            "IdTcaResultadoProceso");
                    dato.put("resultado", resultado);
                }
            }

            if ((null != claveObjecion) && (null != idtipo)) {
                fenixAdquisicionesAMImpl.getOferentesVO().executeQuery();
                fenixAdquisicionesAMImpl.getAdjudicatariosVO().executeQuery();
                fenixAdquisicionesAMImpl.getContratadosVO().executeQuery();
                precargaConcursantes(claveObjecion, idtipo);
                logger.warning("se aplica el refrescado de las tabla");
            }
        }

        Row currentRow = getCurrentRow();

        if (null != currentRow) {
            logger.log(ADFLogger.WARNING,
                "idNoObjecion al salir: " +
                currentRow.getAttribute(NoObjecionVORowImpl.ID));
        } else {
            logger.log(ADFLogger.WARNING,
                "Error, el current row de no objecion es nulo.");
        }

        logger.log(ADFLogger.WARNING, "Saliendo de recuperaDatos.");

        return dato;
    }

    public Boolean seteaNoObjecion(Long idNoObjecion) {
        logger.warning("Ingresa metodo seteaNoObjecion.");
        logger.log(ADFLogger.WARNING, "idNoObjecion: " + idNoObjecion);

        Boolean respuesta = Boolean.TRUE;
        FenixAMImpl fenixAMImpl = null;
        fenixAMImpl = (FenixAMImpl) this.getRootApplicationModule();

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = (FenixAdquisicionAMImpl) fenixAMImpl.getFenixAdquisicionAM();

        if (null == idNoObjecion) {
            respuesta = Boolean.FALSE;
            logger.warning(
                "se esta recibiendo el valor idNoObjecion como null ");
        } else {
            Long idAdquisicion = fenixAdquisicionesAMImpl.getAdquisicionesVO()
                                                         .getIdAdquisicionGetCurrentRow();
            Map resultado2 = new HashMap<String, Object>();
            resultado2 = fenixAdquisicionesAMImpl.getAdquisicionVO()
                                                 .aplicarNoobjecion(idAdquisicion);

            if (null != idAdquisicion) {
                setvarIdAdquisicion(idAdquisicion);

                Row noObjecionrow = null;

                if (null != (Integer) resultado2.get("modalidad")) {
                    Integer moda = (Integer) resultado2.get("modalidad");
                    precargaModalidad(moda);
                    noObjecionrow = getNoObjecion(idNoObjecion, null);

                    if (null != noObjecionrow) {
                        noObjecionrow.setAttribute("modalidad", moda);
                        setCurrentRow(noObjecionrow);
                    }
                } else {
                    noObjecionrow = getNoObjecion(idNoObjecion, null); //idNoObjecion

                    if (null != noObjecionrow) {
                        setCurrentRow(noObjecionrow);
                    }
                }
            }
        }

        logger.warning("Valor a retornar: " + respuesta);
        logger.warning("Finaliza el metodo setCurrentRowNoObjecion ");

        return respuesta;
    }

    public Boolean setCurrentRowNoObjecion(Long idNoObjecion) {
        logger.warning("Ingresa metodo setCurrentRowNoObjecion");

        Boolean respuesta = Boolean.FALSE;
        FenixAMImpl fenixAMImpl = null;
        fenixAMImpl = (FenixAMImpl) this.getRootApplicationModule();

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = (FenixAdquisicionAMImpl) fenixAMImpl.getFenixAdquisicionAM();

        try {
            if (null == idNoObjecion) {
                respuesta = Boolean.FALSE;
                logger.warning(
                    "se esta recibiendo el valor idNoObjecion como null ");
            } else {
                Long idAdquisicion = fenixAdquisicionesAMImpl.getAdquisicionesVO()
                                                             .getIdAdquisicionGetCurrentRow();
                logger.warning("idAdquisicion obtenido del selectionListener: " +
                    idAdquisicion);

                setvarIdAdquisicion(idAdquisicion);

                logger.warning("se recibe el valor idNoObjecion: " +
                    idNoObjecion);

                ViewCriteria criteria = this.getViewCriteriaManager()
                                            .getViewCriteria("NoObjecionVOCriteriaById");
                criteria.ensureVariableManager()
                        .setVariableValue("varIdNoObjecion", idNoObjecion);
                this.applyViewCriteria(criteria);
                this.executeQuery();

                if (getEstimatedRowCount() > 0) {
                    setCurrentRow(first());
                    logger.warning(
                        "se realiza la accion setCurrentRow con exito");
                    respuesta = Boolean.TRUE;
                } else {
                    logger.warning(
                        "No se encontro el registro de la no objecion con el id " +
                        idNoObjecion);
                    logger.warning("no se realiza la accion setCurrentRow");
                }
            }
        } catch (Exception e) {
            logger.warning(
                "Ocurrio un error al intentar realizar el setCurrentRow..." +
                e.getClass() + e.getMessage());
        } finally {
            //This takes care of removing the applied VC.
            this.getViewCriteriaManager()
                .removeApplyViewCriteriaName("NoObjecionVOCriteriaById");
        }

        logger.warning("Valor a retornar: " + respuesta);
        logger.warning("Finaliza el metodo setCurrentRowNoObjecion ");

        return respuesta;
    }

    public void obtenerNoObjecion() {
        Row row = getCurrentRow();

        if (null != row) {
            logger.warning("id no objecion actual: " +
                (Long) row.getAttribute("Id"));
        } else {
            logger.warning("No hay datos");
        }
    }

    public Map obtenerRowNoObjecion(Long idNoObjecion) {
        logger.log(ADFLogger.WARNING, "Into obtenerRowNoObjecion.");
        logger.log(ADFLogger.WARNING, "idNoObjecion : " + idNoObjecion);

        Row filaRecuperada = null;
        ViewCriteria criteria = null;
        Map map = new HashMap<String, Object>();
        String idResultadoProceso = null;
        String idTipoNoObjecion = null;

        if (idNoObjecion == null) {
            logger.warning(
                "*** El parametro id es requerido para obtener los campos requeridos de la No Objecion");

            return null;
        }

        try {
            criteria = this.getViewCriteriaManager()
                           .getViewCriteria("NoObjecionVOCriteriaById");
            criteria.ensureVariableManager()
                    .setVariableValue("varIdNoObjecion", idNoObjecion);
            this.applyViewCriteria(criteria);
            this.executeQuery();

            if (getEstimatedRowCount() > 0) {
                setCurrentRow(first());
                filaRecuperada = getCurrentRow();
                logger.warning("IdNoObjecion recuperado: " +
                    filaRecuperada.getAttribute("Id"));
                logger.warning("IdAdquisicion recuperado: " +
                    filaRecuperada.getAttribute("IdAdquisicion"));
                logger.warning("IdTcaResultadoProceso recuperado: " +
                    filaRecuperada.getAttribute("IdTcaResultadoProceso"));
                logger.warning("IdTcaTipoNoObjecion recuperado: " +
                    filaRecuperada.getAttribute("IdTcaTipoNoObjecion"));
            } else {
                logger.warning(
                    "El row recuperado es Null no hay coincidencias en la busqueda");
            }
        } catch (Exception e) {
            logger.log(ADFLogger.WARNING,
                "*** Error al BuscarPorId  ->" + e.getClass() + ":" +
                e.getMessage());
        } finally {
            getViewCriteriaManager()
                .removeApplyViewCriteriaName("NoObjecionVOCriteriaById");

            //executeQuery();              
        }

        logger.log(ADFLogger.WARNING, "Finaliza obtenerRowNoObjecion.");
        map.put("IdTcaResultadoProceso", idResultadoProceso);
        map.put("IdTcaTipoNoObjecion", idTipoNoObjecion);

        return map;
    }

    /**
     * Returns the variable value for varIdNoObjecion.
     * @return variable value for varIdNoObjecion
     */
    public Long getvarIdNoObjecion() {
        return (Long) ensureVariableManager().getVariableValue("varIdNoObjecion");
    }

    /**
     * Sets <code>value</code> for variable varIdNoObjecion.
     * @param value value to bind as varIdNoObjecion
     */
    public void setvarIdNoObjecion(Long value) {
        ensureVariableManager().setVariableValue("varIdNoObjecion", value);
    }

    public String actualizaEmitirRespuesta
    (
        Long idObjecion,
        String correspondencia, 
        TIMESTAMP fechaFirma, 
        Boolean revisado,
        Boolean otorgado
    ){
        logger.warning("Inicio actualizaEmitirRespuesta");
        String respuesta = "";
        logger.warning("idObjecion: " + idObjecion);
        logger.warning("correspondencia: " + correspondencia);
        logger.warning("fechaFirma: " + fechaFirma);
        logger.warning("revisado: " + revisado);
        logger.warning("otorgado: " + otorgado);

        Integer revisadoOotrga = 1;
        Integer noAplica = 0;
        //Row row = getNoObjecion(idObjecion, null);
        
        try
        {
            Row row = getCurrentRow();
    
            if (null != row) {
                row.setAttribute("NumeroCorrespondencia", correspondencia);
                row.setAttribute("FechaFirmaDocto", fechaFirma);
                row.setAttribute("SeHaRevisadoPublicacion", otorgado?  revisadoOotrga : noAplica); 
                row.setAttribute("SeOtorgoNoObjecion", otorgado?  revisadoOotrga : noAplica);
                
                try
                {
                    getDBTransaction().commit();
                    respuesta = "OK";
                } 
                catch (Exception e)
                {
                    respuesta = "Error NoObjecionVOImpl.actualizaEmitirRespuesta: " + e;
                    logger.warning(respuesta);
                    rollBackNoObjecion();
                }
                
            } else {
                respuesta = "getCurrentRow retorno null";
                logger.warning(respuesta);
            }
        }
        catch (Exception exp)
        {
            respuesta = "Error NoObjecionVOImpl.actualizaEmitirRespuesta: " + exp;
            logger.warning(respuesta);
            rollBackNoObjecion();
        }        
        logger.warning("respuesta: " + respuesta);
        logger.warning("Fin actualizaEmitirRespuesta");

        return respuesta;
    }

    public Map obtenerTipoResultado(Long idObjecion) {
        logger.warning("Inicio obtenerTipoResultado");
        logger.warning("idObjecion: " + idObjecion);
        Map respuesta = new HashMap(); 

        Integer tipoObjecion = null;
        Integer tipoResultado = null;
        //Row row = getNoObjecion(idObjecion, null);
        Row row = getCurrentRow();

        if (null != row) {
            respuesta.put("resultado", Boolean.TRUE);

            if (null != (Integer) row.getAttribute("IdTcaTipoNoObjecion")) {
                tipoObjecion = (Integer) row.getAttribute("IdTcaTipoNoObjecion");
                respuesta.put("tipoObjecion", tipoObjecion);

                if (tipoObjecion.compareTo(FenixModelConstants.NO_OBJECION_INFORME_RESULTADOS) == 0) {
                    if (null != (Integer) row.getAttribute("IdTcaResultadoProceso")) {
                        tipoResultado = (Integer) row.getAttribute("IdTcaResultadoProceso");
                        respuesta.put("tipoResultado", tipoResultado);
                    } else {
                        logger.warning("no se encuentra el Valor IdTcaResultadoProceso");
                    }
                } else {
                    logger.warning("el tipo de no objecion no es informe de resultados por lo tanto no se busca el resultado");
                }
            } else {
                logger.warning("no se encuentra el Valor IdTcaTipoNoObjecion");
            }
        } else {
            logger.warning("no se encuentra el Valor con el id objecion seleccionado");
            respuesta.put("resultado", Boolean.FALSE);
        }

        logger.warning("respuesta: " + respuesta);
        logger.warning("Fin obtenerTipoResultado");
        return respuesta;
    }

    public Map crearDoc(long adquisicionId, Long noObjecion,
        Integer vistaPublicar) {
        Map resultado = new HashMap();

        String mensajeError = null;
        Boolean esError = Boolean.FALSE;
        FenixAMImpl fenixAMImpl = null;
        fenixAMImpl = (FenixAMImpl) this.getRootApplicationModule();

        String wsdl2 = fenixAMImpl.getWsdl(IWsdlLocation.ADQUISICION);
        InformeNoObjecionRequestType request = new InformeNoObjecionRequestType();
        InformeNoObjecionResponseType response = null;

        try {
            AdquisicionPT12BndQSService adquisicion = IWsdlLocation.Service.getInstance(AdquisicionPT12BndQSService.class,
                    wsdl2);
            AdquisicionPT adquisicionPT = adquisicion.getAdquisicionPT12BndQSPort();
            // Add your code to call the desired methods.
            request.setIdAdquisicion(adquisicionId);
            request.setIdNoObjecion(noObjecion);
            request.setRequierePublicacion(vistaPublicar);

            Date horaInicio = ModelUtils.logStartWS(logger, request,
                    FenixModelConstants.WS_ADQUISICION_PREVIA);
            String mensaje = null;
            mensaje = "Invocando Servicio - Aviso de cobro comision-";

            response = adquisicionPT.publicarNoObjecion(request);
            mensaje = "Invocando Servicio - Aviso de cobro comision -";
            ModelUtils.logEndWS(logger, response,
                FenixModelConstants.WS_ADQUISICION_PREVIA, horaInicio);

            if (null != response) {
                byte[] cadenaBytes = response.getDocumento().getContent();
                // logger.warning("cadenaBytes: "+cadenaBytes); 
                resultado.put("cadena", cadenaBytes);
                resultado.put("resultado", Boolean.TRUE);
            }

            if (response.getResultado().getResult().value() == "ERROR") {
                mensajeError = response.getResultado().getMessage();
                mensajeError = mensajeError.concat(response.getResultado()
                                                           .getError()
                                                           .getErrorDescription());
                resultado.put("mensaje", mensajeError);
                resultado.put("resultado", Boolean.FALSE);
                esError = Boolean.TRUE;
            }
        } catch (Exception e) {
            esError = Boolean.TRUE;
            logger.log(ADFLogger.ERROR,
                "Error al generar el documento de no objecion " + e.getClass() +
                ":" + e.getMessage());

            JboException ex;

            if (mensajeError != null) {
                ex = new JboException(mensajeError);
            } else {
                ex = new JboException(e);
                ex.addToExceptions(new Exception(
                        "Error en inicio adquisiciones " + e.getClass() + ":" +
                        e.getMessage()));
            }

            throw ex;
        }

        return resultado;
    }

    public void recargaConcursantes2(Long idNoObjecion, Integer tipo) {
        logger.log(ADFLogger.WARNING, "Iniciando recargaConcursantes.");
        logger.log(ADFLogger.WARNING, "idNoObjecion: " + idNoObjecion);
        logger.log(ADFLogger.WARNING, "tipo: " + tipo);

        if ((null != idNoObjecion) && (null != tipo)) {
            precargaConcursantes(idNoObjecion, tipo);
        } else {
            logger.log(ADFLogger.WARNING,
                "Error idNoObjecion o idTcaTipoNoObjecion son nulos.");
        }
    }

    public Boolean validarNoObjecion(Long idAdquisicion, Long noObjecion) {
        Boolean respuesta = Boolean.FALSE;
        logger.warning("Inicia proceso validarNoObjecion");

        if ((null != idAdquisicion) && (null != noObjecion)) {
            setvarIdAdquisicion(idAdquisicion);
            executeQuery();

            if (this.getEstimatedRowCount() > 0) {
                try {
                    ViewCriteria viewCriteria = this.getViewCriteriaManager()
                                                    .getViewCriteria("NoObjecionVOUnico");
                    viewCriteria.ensureVariableManager()
                                .setVariableValue("varIdNoObjecion", noObjecion);
                    this.applyViewCriteria(viewCriteria);
                    this.executeQuery();

                    //resultado = (this.getEstimatedRowCount() > 0) ? Boolean.TRUE : Boolean.FALSE;
                    if (this.getEstimatedRowCount() > 0) {
                        logger.warning("Existe row");
                        respuesta = Boolean.TRUE;
                    } else {
                        logger.warning("Los campos no coinciden");
                    }
                } catch (Exception ex) {
                    logger.log(ADFLogger.ERROR,
                        "Error en a consulta  idObjecion ", ex);
                } finally {
                    //This takes care of removing the applied VC.
                    this.getViewCriteriaManager()
                        .removeApplyViewCriteriaName("ConsultaAdquisicionPorTipoAdquisicionVC");
                }
            } else {
                logger.warning("registros vacios");
            }
        } else {
            logger.warning(
                "Los parametros de adquisicion y no objecion vienen vacios");
        }

        logger.warning("respuesta: " + respuesta);

        return respuesta;
    }

    private Row getNoObjecion(Long idNoObjecion, Long adquisicion) {
        logger.log(ADFLogger.WARNING, "Inside getNoObjecion.");
        logger.warning("idNoObjecion " + idNoObjecion);
        logger.warning("adquisicion " + adquisicion);

        Row objecionRow = null;

        /*
        ViewCriteria criteriaByClienteInstanciaProceso = null;
        if (null != adquisicion) {
            setvarIdAdquisicion(adquisicion);
        }
        if (idNoObjecion != null) {
            criteriaByClienteInstanciaProceso =
                this.getViewCriteriaManager().getViewCriteria("NoObjecionVOCriteriaById");
            criteriaByClienteInstanciaProceso.ensureVariableManager().setVariableValue("varIdNoObjecion", idNoObjecion);
        
            this.applyViewCriteria(criteriaByClienteInstanciaProceso);
            this.executeQuery();
            logger.warning("Elementos encontrados " + this.getEstimatedRowCount());
            // 2) Asignamos valor de retorno
            if (this.getEstimatedRowCount() > 0) {
                objecionRow = this.getRowAtRangeIndex(0);
        
                // Removemos criteria del VO
                this.getViewCriteriaManager().removeApplyViewCriteriaName("NoObjecionVOCriteriaById");
        
                // Re-ejecutamos el query
                // this.executeQuery();
            } else {
                logger.warning("Elementos no encontrados ");
            }
        }
        else{
                logger.warning("la no objecion se encuentra vacia ");
            }
        */
        if (null != adquisicion) {
            setvarIdAdquisicion(adquisicion);
        }

        if (null != idNoObjecion) {
            logger.warning("se recupera el valor");

            int count = this.getRowCount();
            logger.warning("EstimatedRowCount:" + this.getRowCount());

            if (count == 0) {
                this.executeQuery();
            }

            for (int index = 0; index < count; index++) {
                objecionRow = getRowAtRangeIndex(index);

                if (null != objecionRow) {
                    logger.warning("No objecion con Id: " +
                        objecionRow.getAttribute("Id"));

                    if (idNoObjecion.compareTo(
                                (Long) objecionRow.getAttribute("Id")) == 0) {
                        logger.warning("Row encontrado");

                        break;
                    }
                }
            }

            if (count == 0) {
                logger.warning("sigue vacion count " + count);
                objecionRow = obtenerObjecionRow(idNoObjecion);
            }
        } else {
            logger.warning("No se encuentra idNoObjecion");
        }

        return objecionRow;
    }

    private Row getNoObjecionTarea(Long idNoObjecion, Long adquisicion) {
        logger.log(ADFLogger.WARNING, "Inside getNoObjecion.");
        logger.warning("idNoObjecion " + idNoObjecion);
        logger.warning("adquisicion " + adquisicion);

        Row objecionRow = null;

        ViewCriteria criteriaByClienteInstanciaProceso = null;

        if (null != adquisicion) {
            setvarIdAdquisicion(adquisicion);
        }

        if (idNoObjecion != null) {
            criteriaByClienteInstanciaProceso = this.getViewCriteriaManager()
                                                    .getViewCriteria("NoObjecionVOCriteriaById");
            criteriaByClienteInstanciaProceso.ensureVariableManager()
                                             .setVariableValue("varIdNoObjecion",
                idNoObjecion);

            this.applyViewCriteria(criteriaByClienteInstanciaProceso);
            this.executeQuery();
            logger.warning("Elementos encontrados " +
                this.getEstimatedRowCount());

            // 2) Asignamos valor de retorno
            if (this.getEstimatedRowCount() > 0) {
                objecionRow = this.getRowAtRangeIndex(0);

                // Removemos criteria del VO
                this.getViewCriteriaManager()
                    .removeApplyViewCriteriaName("NoObjecionVOCriteriaById");

                // Re-ejecutamos el query
                // this.executeQuery();
            } else {
                logger.warning("Elementos no encontrados ");
            }
        } else {
            logger.warning("la no objecion se encuentra vacia ");
        }

        return objecionRow;
    }

    public boolean validarMontoAdjudicatarios(Long idAdquisicion,
        Long idNoObjecion) {
        logger.warning("Entrando en validarMontoAdjudicatarios.");
        logger.warning("idAdquisicion: " + idAdquisicion);
        logger.warning("idNoObjecion: " + idNoObjecion);

        boolean montoValido = Boolean.FALSE;
        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = obtenerFenixAdquisicionAM();

        if ((null != idAdquisicion) && (null != idNoObjecion)) {
            BigDecimal montoPresupuestado = null;
            BigDecimal montoAdquisiciones = null;
            RowSetIterator rowSetIterator = fenixAdquisicionesAMImpl.getAdquisicionesVO()
                                                                    .createRowSetIterator(null);

            rowSetIterator.reset();

            while (rowSetIterator.hasNext()) {
                Row row = rowSetIterator.next();

                if ((null != row) &&
                        (idAdquisicion.compareTo((Long) row.getAttribute("Id")) == 0)) {
                    montoPresupuestado = (BigDecimal) row.getAttribute(
                            "MontoPresupuestado");

                    break;
                }
            }

            rowSetIterator.closeRowSetIterator();

            if (null != montoPresupuestado) {
                montoAdquisiciones = BigDecimal.ZERO;

                Row rowNoObjecion = obtenerObjecionRow(idNoObjecion);

                if (null != rowNoObjecion) {
                    if ((FenixModelConstants.ID_NO_OBJECION_INFORME_RESULTADOS.compareTo(
                                (Integer) rowNoObjecion.getAttribute(
                                    "IdTcaTipoNoObjecion")) == 0) ||
                            (FenixModelConstants.ID_NO_OBJECION_CONTRATADO.compareTo(
                                (Integer) rowNoObjecion.getAttribute(
                                    "IdTcaTipoNoObjecion")) == 0)) {
                        montoAdquisiciones = obtenerMontoAdjudicatarios(rowNoObjecion);
                    } else {
                        logger.warning(
                            "No aplica obtener monto adjudicatarios.");
                    }
                } else {
                    logger.warning("No objecion nula.");
                }
            }

            logger.warning("montoPresupuestado: " + montoPresupuestado);
            logger.warning("montoAdquisiciones: " + montoAdquisiciones);

            if ((null != montoPresupuestado) & (null != montoAdquisiciones)) {
                montoPresupuestado = montoPresupuestado.setScale(2,
                        BigDecimal.ROUND_FLOOR);
                montoAdquisiciones = montoAdquisiciones.setScale(2,
                        BigDecimal.ROUND_FLOOR);

                if (montoPresupuestado.compareTo(montoAdquisiciones) >= 0) {
                    montoValido = Boolean.TRUE;
                }
            } else {
                montoValido = Boolean.TRUE;
            }
        }

        return montoValido;
    }

    private Row obtenerObjecionRow(Long idNoObjecion) {
        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = obtenerFenixAdquisicionAM();
        Row rowNoObjecion = null;
        RowSetIterator rowSetIterator = fenixAdquisicionesAMImpl.getNoObjecionVO()
                                                                .createRowSetIterator(null);

        rowSetIterator.reset();

        while (rowSetIterator.hasNext()) {
            Row row = rowSetIterator.next();

            if ((null != row) &&
                    (idNoObjecion.compareTo((Long) row.getAttribute("Id")) == 0)) {
                rowNoObjecion = row;

                break;
            }
        }

        rowSetIterator.closeRowSetIterator();

        return rowNoObjecion;
    }

    private BigDecimal obtenerMontoAdjudicatarios(Row rowNoObjecion) {
        logger.warning("Entrando en obtenerMontoAdjudicatarios.");

        final int ID_NO_OBJECION_CONTRATADO = 9;
        final int ID_NO_OBJECION_RESULTDO_PROCESO = 10;
        Integer idTcaTipoNoObjecion = (Integer) rowNoObjecion.getAttribute(
                "IdTcaTipoNoObjecion");
        Integer idTcaResultadoProceso = (Integer) rowNoObjecion.getAttribute(
                "IdTcaResultadoProceso");
        BigDecimal montoAdjudicatarios = null;

        logger.warning("idTcaTipoNoObjecion: " + idTcaTipoNoObjecion);
        logger.warning("idTcaResultadoProceso: " + idTcaResultadoProceso);

        if (null != idTcaTipoNoObjecion) {
            switch (idTcaTipoNoObjecion.intValue()) {
            case ID_NO_OBJECION_CONTRATADO:
                logger.warning("Obteniendo monto de AdjudicatariosContratoVO.");
                montoAdjudicatarios = montoAdjudicatariosContrato();

                break;

            case ID_NO_OBJECION_RESULTDO_PROCESO:
                logger.warning("Obteniendo monto de AdjudicatariosVO.");
                montoAdjudicatarios = montoAdjudicatarios();

                break;
            }
        }

        if (montoAdjudicatarios == null) {
            if ((null != idTcaResultadoProceso) &&
                    (idTcaResultadoProceso.compareTo(1) == 0)) {
                logger.warning("Obteniendo monto de AdjudicatariosVO.");
                montoAdjudicatarios = montoAdjudicatarios();
            }
        }

        vIdTcaResultadoProceso = idTcaResultadoProceso;

        return montoAdjudicatarios;
    }

    private BigDecimal montoAdjudicatariosContrato() {
        BigDecimal montoAdjudicatarios = BigDecimal.ZERO;
        RowSetIterator rowSetIterator = obtenerFenixAdquisicionAM()
                                            .getAdjudicatariosContratoVO()
                                            .createRowSetIterator(null);

        rowSetIterator.reset();

        while (rowSetIterator.hasNext()) {
            Row row = rowSetIterator.next();

            if ((null != row) && (null != row.getAttribute("Monto"))) {
                montoAdjudicatarios = montoAdjudicatarios.add((BigDecimal) row.getAttribute(
                            "Monto"));
            }
        }

        rowSetIterator.closeRowSetIterator();

        return montoAdjudicatarios;
    }

    private BigDecimal montoAdjudicatarios() {
        BigDecimal montoAdjudicatarios = BigDecimal.ZERO;
        RowSetIterator rowSetIterator = obtenerFenixAdquisicionAM()
                                            .getAdjudicatariosVO()
                                            .createRowSetIterator(null);

        rowSetIterator.reset();

        while (rowSetIterator.hasNext()) {
            Row row = rowSetIterator.next();

            if ((null != row) && (null != row.getAttribute("Monto"))) {
                montoAdjudicatarios = montoAdjudicatarios.add((BigDecimal) row.getAttribute(
                            "Monto"));
            }
        }

        rowSetIterator.closeRowSetIterator();

        return montoAdjudicatarios;
    }

    private FenixAdquisicionAMImpl obtenerFenixAdquisicionAM() {
        FenixAMImpl fenixAMImpl = null;
        fenixAMImpl = (FenixAMImpl) this.getRootApplicationModule();

        FenixAdquisicionAMImpl fenixAdquisicionesAMImpl = (FenixAdquisicionAMImpl) fenixAMImpl.getFenixAdquisicionAM();

        return fenixAdquisicionesAMImpl;
    }

    public void setDatosFormNoObjecion(Timestamp fechaPublicacion,
        Timestamp fechaInicioDispDoctoBase, Timestamp fechaFinDispDoctoBase,
        Timestamp fechaRecepcionPropuesta, String lugarObtenerDoctoBase,
        String correoInformacionAdicional, String dirPresentacionPropuesta) {
        logger.warning("Inicia metodo setDatosFormNoObjecion()");

        if (getCurrentRow() != null) {
            getCurrentRow().setAttribute("FechaPublicacion", fechaPublicacion);
            getCurrentRow()
                .setAttribute("FechaInicioDispDoctoBase",
                fechaInicioDispDoctoBase);
            getCurrentRow()
                .setAttribute("FechaFinDispDoctoBase", fechaFinDispDoctoBase);
            getCurrentRow()
                .setAttribute("FechaRecepcionPropuesta", fechaRecepcionPropuesta);
            getCurrentRow()
                .setAttribute("LugarObtenerDoctoBase", lugarObtenerDoctoBase);
            getCurrentRow()
                .setAttribute("CorreoInformacionAdicional",
                correoInformacionAdicional);
            getCurrentRow()
                .setAttribute("DirPresentacionPropuesta",
                dirPresentacionPropuesta);
        } else {
            logger.warning(
                "No se ha podido cargar la plantilla aviso, currentRow Null");
        }
    }
}
