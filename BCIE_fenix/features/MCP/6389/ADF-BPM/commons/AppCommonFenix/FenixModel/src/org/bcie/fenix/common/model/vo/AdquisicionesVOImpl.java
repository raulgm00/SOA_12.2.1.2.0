package org.bcie.fenix.common.model.vo;

import java.math.BigDecimal;

import java.sql.Timestamp;

import java.text.SimpleDateFormat;

import java.util.Date;

import java.util.HashMap;
import java.util.Map;

import oracle.adf.share.logging.ADFLogger;

import oracle.jbo.Row;
import oracle.jbo.Key;
import oracle.jbo.NameValuePairs;
import oracle.jbo.Row;
import oracle.jbo.ViewCriteria;
import oracle.jbo.server.SequenceImpl;
import oracle.jbo.server.ViewObjectImpl;

import org.bcie.fenix.common.model.FenixModelConstants;
import org.bcie.fenix.common.model.am.FenixAMImpl;
import org.bcie.fenix.common.model.am.FenixAdquisicionAMImpl;
import org.bcie.fenix.common.model.vo.common.AdquisicionesVO;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Mon Nov 14 12:07:48 CST 2016
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class AdquisicionesVOImpl extends ViewObjectImpl implements AdquisicionesVO {
    private static ADFLogger logger = null;

    /**
     * This is the default constructor (do not remove).
     */
    
    public AdquisicionesVOImpl() {
        if (logger == null) {
            logger = ADFLogger.createADFLogger(this.getClass());
        }
    }

    /**
     * Returns the bind variable value for varIdOperacion.
     * @return bind variable value for varIdOperacion
     */
    public Long getvarIdOperacion() {
        return (Long) getNamedWhereClauseParam("varIdOperacion");
    }

    /**
     * Sets <code>value</code> for bind variable varIdOperacion.
     * @param value value to bind as varIdOperacion
     */
    public void setvarIdOperacion(Long value) {
        logger.warning("IdOperacion " + value);
        if (null != value) {
            setNamedWhereClauseParam("varIdOperacion", value);
        }
    }
    
        
    public void actualizarAdquisicion(Long id, Long idOperacion, Integer cuentaConAdquisicionPrevia, Integer tipoAdquiscion, Integer tipoAlcanceProceso,
                                      Integer tipoModalidadProceso, Integer tipoMonedaAsociado, Integer tipoMonedaContratado,
                                      Integer tipoMonedaPresupuestado, Integer tipoNotmativaAplicada,
                                      BigDecimal montoAsociado, BigDecimal montoContratado, BigDecimal montoPresupuestado,
                                      String nacionalidadAdjudicatario, String nombreAdjudicatario, String normativaEspecifica,
                                      String numeroAdquisicion, String objetivoAdquisicion, String tituloAdquisicion, Date fechaContrato, String instanciaProceso){
        
        logger.warning("Entra a actualizarAdquisicion");
        logger.warning("id: " + id);
        logger.warning("idOperacion: " + idOperacion);
        logger.warning("cuentaConAdquisicionPrevia: " + cuentaConAdquisicionPrevia);
        logger.warning("tipoAdquisicion: " + tipoAdquiscion);
        logger.warning("idTcaTipoAlcanceProceso: " + tipoAlcanceProceso);
        logger.warning("idTcaTipoModalidadProceso: " + tipoModalidadProceso);
        logger.warning("idTcaTipoMonedaAsociado: " + tipoMonedaAsociado);
        logger.warning("idTcaTipoMonedaContratado: " + tipoMonedaContratado);
        logger.warning("idTcaTipoMonedaPresupuesto: " + tipoMonedaPresupuestado);
        logger.warning("idTcaTipoNormativaAplicada: " + tipoNotmativaAplicada);
        logger.warning("montoAsociado: " + montoAsociado);
        logger.warning("montoContratado" + montoContratado);
        logger.warning("montoPresupuestado: " + montoPresupuestado);
        logger.warning("nacionalidadAdjudicatario: " + nacionalidadAdjudicatario);
        logger.warning("nombreAdjudicatario: " + nombreAdjudicatario);
        logger.warning("normativaEspecifica: " + normativaEspecifica);
        logger.warning("numeroAdquisicion: " + numeroAdquisicion);
        logger.warning("objetivoAdquisicion: " + objetivoAdquisicion);
        logger.warning("tituloAdquisicion: " + tituloAdquisicion);
        logger.warning("fechaContrato: " + fechaContrato);
        logger.warning("instanciaProceso: " + instanciaProceso);
        
        oracle.jbo.domain.Number idAdquisicion = null;
        NameValuePairs nvpAdquisicion = null;
        SequenceImpl seqAdquisicion = null;
        logger.warning("Continua porceso actualizarAdquisicion 1");
        /*seqAdquisicion = new SequenceImpl("ADQUISICION_SEQ", getDBTransaction());
        idAdquisicion = seqAdquisicion.getSequenceNumber();
      */
        Row adquisicionRow = null;
        //adquisicionRow = getRow(new Key(new Object[] { id })); //original
        adquisicionRow = getCurrentRow();
        
        adquisicionRow.setAttribute("CuentaConAdquisicionPrevia", cuentaConAdquisicionPrevia);
        adquisicionRow.setAttribute("IdTcaTipoAdquisicion", tipoAdquiscion);
        adquisicionRow.setAttribute("IdTcaTipoAlcanceProceso", tipoAlcanceProceso);
        adquisicionRow.setAttribute("IdTcaTipoModalidadProceso", tipoModalidadProceso);
        adquisicionRow.setAttribute("IdTcaTipoMonedaAsociado", tipoMonedaAsociado);
        adquisicionRow.setAttribute("IdTcaTipoMonedaContratado", tipoMonedaContratado);
        adquisicionRow.setAttribute("IdTcaTipoMonedaPresupuesto", tipoMonedaPresupuestado);
        adquisicionRow.setAttribute("IdTcaTipoNormativaAplicada", tipoNotmativaAplicada);
        adquisicionRow.setAttribute("MontoAsociado", montoAsociado);
        adquisicionRow.setAttribute("MontoContratado", montoContratado);
        adquisicionRow.setAttribute("MontoPresupuestado", montoPresupuestado);
        adquisicionRow.setAttribute("NacionalidadAdjudicatario", nacionalidadAdjudicatario);
        adquisicionRow.setAttribute("NombreAdjudicatario", nombreAdjudicatario);
        adquisicionRow.setAttribute("NormativaEspecifica", normativaEspecifica);
        adquisicionRow.setAttribute("NumeroAdquisicion", numeroAdquisicion);
        adquisicionRow.setAttribute("ObjetivoAdquisicion", objetivoAdquisicion);
        adquisicionRow.setAttribute("TituloAdquisicion", tituloAdquisicion);
        adquisicionRow.setAttribute("FechaContrato", fechaContrato);
        //adquisicionRow.setAttribute("InstanciaProceso", instanciaProceso);
        
        adquisicionRow.setAttribute("IdOperacion", idOperacion);
        adquisicionRow.setAttribute("BanEstatus", 1);
        adquisicionRow.setAttribute("FechaRegistro", new Date());
        //this.createAndInitRow(nvpAdquisicion);
        logger.warning("Continua proceso actualizarAdquisicion 4");
                
        getDBTransaction().commit();
        executeQuery();
        logger.warning("Continua porceso actualizarAdquisicion 5 (se hace commit a la VO)");
       
    }
    
    public Long agregarNuevaRow(Long idOperacion){
            
        logger.warning("*** Inicia metodo agregarNuevaRow");
        Row adquisicionRow = null;
        Long idAdquisicionLong = null;
                                
        logger.warning("*** creando nueva fila para Adquisicion");
    
        try{        
            oracle.jbo.domain.Number idAdquisicion = null;                            
            SequenceImpl seqAdquisicion = null;
            seqAdquisicion = new SequenceImpl("ADQUISICION_SEQ", getDBTransaction());
            idAdquisicion = seqAdquisicion.getSequenceNumber();
            
            idAdquisicionLong = new Long (idAdquisicion.longValue());
            logger.warning("** Nuevo Id generado para la Adquisicion ->"+idAdquisicionLong);
        }catch(Exception e){
            e.printStackTrace();
        }     
                                                    
        adquisicionRow = createRow();
        adquisicionRow.setAttribute("Id", idAdquisicionLong);
        adquisicionRow.setAttribute("CuentaConAdquisicionPrevia", 0);
        adquisicionRow.setAttribute("IdTcaTipoAdquisicion", null);
        adquisicionRow.setAttribute("IdTcaTipoAlcanceProceso", null);
        adquisicionRow.setAttribute("IdTcaTipoModalidadProceso", null);
        adquisicionRow.setAttribute("IdTcaTipoMonedaAsociado", null);
        adquisicionRow.setAttribute("IdTcaTipoMonedaContratado", null);
        adquisicionRow.setAttribute("IdTcaTipoMonedaPresupuesto", null);
        adquisicionRow.setAttribute("IdTcaTipoNormativaAplicada", null);
        adquisicionRow.setAttribute("MontoAsociado", null);
        adquisicionRow.setAttribute("MontoContratado", null);
        adquisicionRow.setAttribute("MontoPresupuestado", null);
        adquisicionRow.setAttribute("NacionalidadAdjudicatario", null);
        adquisicionRow.setAttribute("NombreAdjudicatario", null);
        adquisicionRow.setAttribute("NormativaEspecifica", null);
        adquisicionRow.setAttribute("NumeroAdquisicion", null);
        adquisicionRow.setAttribute("ObjetivoAdquisicion", null);
        adquisicionRow.setAttribute("TituloAdquisicion", null);
        
        adquisicionRow.setAttribute("IdOperacion", idOperacion);
        adquisicionRow.setAttribute("BanEstatus", 1);
        //adquisicionRow.setAttribute("InstanciaProceso", 2222);
        adquisicionRow.setAttribute("FechaRegistro", new Date());
       
        insertRow(adquisicionRow);
        setCurrentRow(adquisicionRow);
                              
        logger.warning("*** Termina metodo agregarNuevaRow");
        
        return idAdquisicionLong;
    
    }
    
    public Boolean cambiarAdquisicionABanEstatusCero() {
        logger.warning("inicia metodo cambiarAdquisicionABanEstatusCero");
        Boolean resultado = Boolean.FALSE;
        Row filaActual = null;
        FenixAMImpl fenixAMImpl = null;

        if (getEstimatedRowCount() > 0) {
            filaActual = getCurrentRow();
            filaActual.setAttribute("BanEstatus", 0);
            try {
                getDBTransaction().commit();
                logger.warning("Commit realizado con exito");
                logger.warning("Refrescando tabla...");
                executeQuery();
                logger.warning("Se realizó Query");
            } catch (Exception e) {
                logger.warning("Ocurrió un problema al realizar el COMMIT se realizara un rollBack: ", e);
                getDBTransaction().rollback();

            }
        } else {
            logger.warning("No hay un Current no se puede continuar con el cambio del Ban Estatus");
        }


        logger.warning("Termina metodo cambiarTransferenciaABanEstatusCero");
        return resultado;
    }
    

      public void precargarAdquisicion(Long idOperacion) {
        if (null != idOperacion) {
            setvarIdOperacion(idOperacion);
            executeQuery();
            Row primerRegistro = this.getRowAtRangeIndex(0);
            Long primero = null;

            if (null != primerRegistro) {
                logger.warning("ID adquisicion primer registro" +(Long) primerRegistro.getAttribute("Id"));
                if (null != (Long) primerRegistro.getAttribute("Id")) {
                    primero = (Long) primerRegistro.getAttribute("Id");

                    FenixAMImpl fenixAMImpl = null;
                    fenixAMImpl = (FenixAMImpl) this.getRootApplicationModule();
                    FenixAdquisicionAMImpl fenixAdquisicionesAMImpl =
                        (FenixAdquisicionAMImpl) fenixAMImpl.getFenixAdquisicionAM();
                    fenixAdquisicionesAMImpl.getNoObjecionVO().setvarIdAdquisicion(primero);
                }
                else{
                        logger.warning("ID adquisicion primer registro no obtenido");
                    }
            }
            else{
                    logger.warning("ID adquisicion primer registro no obtenido");
                }
        }
    }
      
      public Long cargaAdquisicion(Long idAdquisicion, Long idOperacion, Boolean aplicaPGA){
              Integer pga=5;
              Long respuesta=null;
              logger.warning("idOperacion  "+ idOperacion);
              logger.warning("aplicaPGA  "+ aplicaPGA);
              FenixAMImpl fenixAMImpl = null;
              fenixAMImpl = (FenixAMImpl) this.getRootApplicationModule();
              FenixAdquisicionAMImpl fenixAdquisicionesAMImpl =
                  (FenixAdquisicionAMImpl) fenixAMImpl.getFenixAdquisicionAM();
              long startTime = System.currentTimeMillis();                    
              startTime = System.currentTimeMillis();
              logger.warning("Tiempo de inicio del metodo de carga de adquisiciones del: "
              + startTime);
             
              logger.warning("Inicio AdquisicionTF. estimated: " + fenixAdquisicionesAMImpl.getOferentesVO().getEstimatedRowCount());
             
              if(null!=idOperacion){
                      setvarIdOperacion(idOperacion);
                      executeQuery();
                      if(aplicaPGA){
                              logger.warning("se empieza con la consulta de aplicaPGA  ");
                              consultaAdquisicionPorTipoAdquisicion(pga, idOperacion);
                          }
                      else{
                              logger.warning("no se consulta la PGA  ");
                          }
                      fenixAdquisicionesAMImpl.getDocumentosTrazabilidadOperacionAdquisicionesVO().ejecutarVO(idOperacion);
                      executeQuery();
                  }

              logger.warning("idAdquisicion  cargado "+ idAdquisicion);
          if(null!= idAdquisicion){
              setvarIdOperacion(idOperacion);
              getRowAtRangeIndex(-1);
              respuesta=idAdquisicion;
              Row adquisicionRow = null;
              adquisicionRow = getRow(new Key(new Object[] { idAdquisicion }));
              if(null!=adquisicionRow){
                      logger.warning("el row seleccionado con id  "+ idAdquisicion);
                      fenixAdquisicionesAMImpl.getEvidenciasAdquisicionVO().setpIdAdquisicionEviAdq(idAdquisicion);
                    this.setCurrentRow(adquisicionRow); 
                    //  adquisicionUnica(idAdquisicion);
                  }
              else{
                      logger.warning("No existe row de la adquisicion seleccionada");
                  }
              }
          else{
                  setvarIdOperacion(idOperacion);
                  getRowAtRangeIndex(-1);
                  Row primerRegistro = this.getRowAtRangeIndex(0);
                  if (null != primerRegistro) {
                      logger.warning("ID adquisicion primer registro" +(Long) primerRegistro.getAttribute("Id"));
                      if (null != (Long) primerRegistro.getAttribute("Id")) {
                          respuesta = (Long) primerRegistro.getAttribute("Id");
                          fenixAdquisicionesAMImpl.getEvidenciasAdquisicionVO().setpIdAdquisicionEviAdq((Long) primerRegistro.getAttribute("Id"));
                      }
                      else{
                              logger.warning("No se obtuvo el id de adquisicion");
                          }
                  }
                  else{
                          logger.warning("No existe el primer registro");
                      }
              }
              long endTime = System.currentTimeMillis();
              logger.warning("Tiempo de fin respuesta: " + endTime);
              logger.warning("Tiempo de respuesta del fin del metodo de carga de adquisiciones "
              + (endTime - startTime)/1000 + " segundos");
        logger.warning("Fin AdquisicionTF. estimated: " + fenixAdquisicionesAMImpl.getOferentesVO().getEstimatedRowCount());
              
          
        return respuesta;
          }

      public Map aplicarNoobjecion(Long idAdquisicion){
              Map resultado = new HashMap<String, Object>();
          logger.warning("Valores a ingresar");
          logger.warning("idAdquisicion " + idAdquisicion);
              if(null!=idAdquisicion){
                      Integer tipo=null;
                      Integer normativa=null;
                      Integer modalidad=null;
                      Row adquisicionRow = null;
                      adquisicionRow = getRow(new Key(new Object[] { idAdquisicion }));
                      if(null!=adquisicionRow){
                      logger.warning("IdTcaTipoNormativaAplicada " +(Integer)adquisicionRow.getAttribute("IdTcaTipoNormativaAplicada"));
                      if(null!=(Integer)adquisicionRow.getAttribute("IdTcaTipoNormativaAplicada")){
                              normativa=(Integer)adquisicionRow.getAttribute("IdTcaTipoAdquisicion");
                              if(normativa.compareTo(FenixModelConstants.NORMATIVA_BCIE)==0){
                                      logger.warning("IdTcaTipoAdquisicion " +(Integer)adquisicionRow.getAttribute("IdTcaTipoAdquisicion"));
                                      if(null!=(Integer)adquisicionRow.getAttribute("IdTcaTipoAdquisicion")){
                                              tipo=(Integer)adquisicionRow.getAttribute("IdTcaTipoAdquisicion");
                                              if(tipo.compareTo(FenixModelConstants.ADQUISICION_PGA)!=0){
                                                      logger.warning("se muestra la no objecion");
                                                      resultado.put("resultado", Boolean.TRUE);
                                                      logger.warning("IdTcaTipoModalidadProceso " +(Integer)adquisicionRow.getAttribute("IdTcaTipoModalidadProceso"));
                                                      if(null!=(Integer)adquisicionRow.getAttribute("IdTcaTipoModalidadProceso")){
                                                              logger.warning("modalidad a enviar: "+(Integer)adquisicionRow.getAttribute("IdTcaTipoModalidadProceso"));
                                                              modalidad=(Integer)adquisicionRow.getAttribute("IdTcaTipoModalidadProceso");
                                                              resultado.put("modalidad", modalidad);
                                                          }
                                                      if(null!=(Integer)adquisicionRow.getAttribute("CuentaConAdquisicionPrevia")){
                                                              resultado.put("previa", Boolean.FALSE);
                                                          }
                                                      else{
                                                          if(((Integer)adquisicionRow.getAttribute("CuentaConAdquisicionPrevia")).compareTo(1)==0){
                                                                  resultado.put("previa", Boolean.TRUE);
                                                              }
                                                          else{
                                                                  resultado.put("previa", Boolean.FALSE);
                                                              }
                                                          }
                                                     
                                                  }
                                              
                                          }
                                  }
                          }


                      }
                  
                  }

        return resultado;
      }
      
      public void eliminarRowTemporal(){
          
          logger.warning("Entra a eliminarRowTemporal");
          
          Row rowTemporal = getCurrentRow();
          rowTemporal.removeFromCollection();
          rowTemporal.remove();
          //executeQuery();  
      }
      
    public void cancelarAdquisicion() {
        logger.warning("Entra a cancelarAdquisicion");
        try {
            getDBTransaction().setClearCacheOnRollback(true);
            getDBTransaction().rollback();
        } catch(Exception e) {
            logger.log(ADFLogger.ERROR,"Error al cancelar la adquisicion.", e);
        }
    }
    
    public String fechaCadena(){
        String cadena=null;
           
           String DATE_FORMAT_NOW = "dd/MMM/yyyy";
            Date date = new Date();
            SimpleDateFormat sdf = new SimpleDateFormat(DATE_FORMAT_NOW);
            cadena = sdf.format(date );
               try {
                   Date date2 = sdf.parse(cadena);
               }catch(Exception e){
                //handle exception
               }

        return cadena;
        }
      
    public void consultaAdquisicionPorTipoAdquisicion(Integer tipoAdquisicion, Long idOperacion){
        logger.warning("Entra a consultaAdquisicionPorTipoAdquisicion tipoAdquisicion: " + tipoAdquisicion);
        Boolean resultado = null;
        try{
            ViewCriteria viewCriteria =this.getViewCriteriaManager().getViewCriteria("ConsultaAdquisicionPorTipoAdquisicionVC");
            viewCriteria.ensureVariableManager().setVariableValue("varTipoAdquisicion", tipoAdquisicion);
            this.applyViewCriteria(viewCriteria);
            this.executeQuery();
            //resultado = (this.getEstimatedRowCount() > 0) ? Boolean.TRUE : Boolean.FALSE;
            
            if(this.getEstimatedRowCount() > 0){
                
                logger.warning("cuenta con Adquisicion de tipo PGA");
                
            }else{
                
                logger.warning("No cuenta con Adquisicion de tipo PGA");
                    
                Row adquisicionRow=null;
                NameValuePairs rowAdquisicion = null;
                rowAdquisicion = new NameValuePairs();
                logger.warning("*** creando nueva fila para Adquisicion");
                Long idAdquisicion =null;// this.agregarNuevaRow(idOperacion);
                String numeroAdquisicion = FenixModelConstants.PGA_ADQUISICION2 + fechaCadena();
                
                SequenceImpl seqAdquisicion = null;
                logger.warning("Continua porceso actualizarAdquisicion 1");
                seqAdquisicion = new SequenceImpl("ADQUISICION_SEQ", getDBTransaction());
                idAdquisicion = seqAdquisicion.getSequenceNumber().longValue();
                
                rowAdquisicion.setAttribute("Id",idAdquisicion);
                rowAdquisicion.setAttribute("IdOperacion",idOperacion);
                rowAdquisicion.setAttribute("IdTcaTipoNormativaAplicada",FenixModelConstants.ID_NORMATIVA_BCIE);
                rowAdquisicion.setAttribute("IdTcaTipoAdquisicion",FenixModelConstants.ID_TIPO_PGA);
                rowAdquisicion.setAttribute("NumeroAdquisicion",numeroAdquisicion);
                rowAdquisicion.setAttribute("TituloAdquisicion",FenixModelConstants.PGA_ADQUISICION);
                rowAdquisicion.setAttribute("BanEstatus",FenixModelConstants.ESTATUS_ADQUISICION);
                rowAdquisicion.setAttribute("FechaRegistro",new java.sql.Timestamp(System.currentTimeMillis()));
                adquisicionRow = this.createAndInitRow(rowAdquisicion);
                          try {
                              getDBTransaction().commit();
                          } catch (Exception e) {
                              logger.log(ADFLogger.ERROR, "Error al intentar guardar la adquiscicion PGA->: ",e);
                              getDBTransaction().rollback();
                          }
                          executeQuery();
                      }
            
        }catch(Exception ex){
            logger.log(ADFLogger.ERROR, "Error en consultaAdquisicionPorTipoAdquisicion ", ex);
        }finally{
            //This takes care of removing the applied VC.
            this.getViewCriteriaManager().removeApplyViewCriteriaName("ConsultaAdquisicionPorTipoAdquisicionVC");
        }       
    }
    
    

    /**
     * Returns the variable value for varTipoAdquisicion.
     * @return variable value for varTipoAdquisicion
     */
    public Integer getvarTipoAdquisicion() {
        return (Integer) ensureVariableManager().getVariableValue("varTipoAdquisicion");
    }

    /**
     * Sets <code>value</code> for variable varTipoAdquisicion.
     * @param value value to bind as varTipoAdquisicion
     */
    public void setvarTipoAdquisicion(Integer value) {
        ensureVariableManager().setVariableValue("varTipoAdquisicion", value);
    }
    
    public void seleccionarAdquisicion(Long idAdquisicion){
        logger.warning("inicia metodo seleccionarAdquisicion2");
        executeQuery();
        if(null!=idAdquisicion){
                logger.warning("se recupera el valor");
                Row row=getRow(new Key(new Object[] { idAdquisicion }));
                if(null!=row){
                    logger.warning("se aplica el seteo del valor");
                    setCurrentRow(row);
                    }
                else{
                        logger.warning("No se encuentra el row adquisicion");
                    }
            }
        else{
                logger.warning("No se encuentra idAdquisicion");
            }
            logger.warning("termina metodo seleccionarAdquisicion2");
        }
    
    public Long recuperarIdAdquisicion() {
        logger.warning("Inside recuperarIdAdquisicion.");
        
        Long idAdquisicion = null;
        Row row = getCurrentRow();
        
        if (row != null) {
            idAdquisicion = (Long) row.getAttribute("Id");    
        } else {
            logger.warning("El row es Null.");
        }
        
        logger.warning("idAdquisicion: " + idAdquisicion);
        
        return idAdquisicion;
    }
    
    public Boolean commitAdquisiciones() {
        logger.warning("*** Inicia metodo guardar adquisicion");
        FenixAMImpl fenixAMImpl = null;

        Boolean respuesta = Boolean.FALSE;
        try {
            getDBTransaction().commit();
            respuesta = Boolean.TRUE;
        } catch (Exception e) {
            logger.log(ADFLogger.ERROR, "Error al intentar guardar la adquiscicion ->: " + e.getMessage());
            getDBTransaction().rollback();
        }
        //executeQuery();
        return respuesta;
    }
    
    public Boolean rollbackAdquisiciones() {
        logger.warning("*** Inicia metodo cancelar adquisciion");

        Boolean respuesta = Boolean.FALSE;
        try {
            getDBTransaction().rollback();
            respuesta = Boolean.TRUE;
        } catch (Exception e) {
            logger.log(ADFLogger.ERROR, "Error al intentar guardar la adquiscicion ->: " + e.getMessage());
        }
        executeQuery();
        return respuesta;
    }

    /**
     * Returns the variable value for varadquisicion.
     * @return variable value for varadquisicion
     */
    public Long getvaradquisicion() {
        return (Long) ensureVariableManager().getVariableValue("varadquisicion");
    }

    /**
     * Sets <code>value</code> for variable varadquisicion.
     * @param value value to bind as varadquisicion
     */
    public void setvaradquisicion(Long value) {
        ensureVariableManager().setVariableValue("varadquisicion", value);
    }
    
    public void adquisicionUnica(Long idAdquiscion){
                logger.warning("Entra a consulta idAdquiscion: " + idAdquiscion);
                Boolean resultado = null;
                Row row=null;
                try{
                    ViewCriteria viewCriteria =this.getViewCriteriaManager().getViewCriteria("AdquisicionesVOUnico");
                    viewCriteria.ensureVariableManager().setVariableValue("varadquisicion", idAdquiscion);
                    this.applyViewCriteria(viewCriteria);
                    this.executeQuery();
                    //resultado = (this.getEstimatedRowCount() > 0) ? Boolean.TRUE : Boolean.FALSE;
                    
                    if(this.getEstimatedRowCount() > 0){
                    logger.warning("Existe row"); 
                    row=getRowAtRangeIndex(0);
                        this.getViewCriteriaManager().removeApplyViewCriteriaName("AdquisicionesVOUnico");
                        if(null!=row){
                                setCurrentRow(row);
                                logger.warning("Existe row y se selecciona");                        
                            }
                    }
        
    }catch(Exception ex){
        logger.log(ADFLogger.ERROR, "Error en a consulta idAdquiscion ", ex);
    }
    logger.warning("termina metodo de seleccionar adquiscion");    
}
    
    public Long getIdAdquisicionGetCurrentRow(){
        logger.warning("Ingresa metodo getIdAdquisicionGetCurrentRow");
        Long idAdquisicion = null;
        Row adquisicionesRow = null;
        
        try{
            adquisicionesRow = this.getCurrentRow();
            idAdquisicion = Long.valueOf( adquisicionesRow.getAttribute("Id").toString() );
            logger.warning("IdAdquisicion recuperado del getCurrentRow: " + idAdquisicion);
        }
        catch(Exception e){
            logger.warning("Error al obtener el getCurrentRow de AdquisicionesVO... " + e.getClass() + ", " + e.getMessage());
        }
        
        logger.warning("Se retorna valor IdAdquisicion: " + idAdquisicion);
        logger.warning("Finaliza el metodo getIdAdquisicionGetCurrentRow");
        return idAdquisicion;
    }
    
    public void obtenerAdquisicion(){
        Row row=getCurrentRow();
            if(null!= row){
                    logger.warning("id no adquiscion actual: "+ (Long) row.getAttribute("Id"));
                }
            else{
                    logger.warning("No hay datos");
                }
        }

}

