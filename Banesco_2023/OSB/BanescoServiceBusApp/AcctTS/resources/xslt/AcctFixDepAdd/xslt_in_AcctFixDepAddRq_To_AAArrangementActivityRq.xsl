<?xml version="1.0" encoding="UTF-8" ?>
<xsl:stylesheet version="2.0"
                xmlns:UUIDUserFunction="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.stages.functions.UUIDUserFunction"
                xmlns:IsUserInGroupFunction="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.stages.functions.IsUserInGroupFunction"
                xmlns:oraext="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc"
                xmlns:IsUserInRoleFunction="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.stages.functions.IsUserInRoleFunction"
                xmlns:xsd="http://www.w3.org/2001/XMLSchema"
                xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20"
                xmlns:DVMFunctions="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.functions.dvm.DVMFunctions"
                xmlns:ns0="http://xmlns.banesco.com/eopt/AcctFixDepAdd_V1.0"
                xmlns:oracle-xsl-mapper="http://www.oracle.com/xsl/mapper/schemas"
                xmlns:oraxsl="http://www.oracle.com/XSL/Transform/java"
                xmlns:RuntimeTypeConversionFunctions="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.stages.functions.RuntimeTypeConversionFunctions"
                xmlns:XrefFunctions="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.functions.xref.XrefFunctions"
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:BasicCredentialsUserFunction="http://www.oracle.com/XSL/Transform/java/com.bea.wli.sb.stages.functions.BasicCredentialsUserFunction"
                xmlns:tns="http://www.temenos.com/T24/ofs/Request"
                exclude-result-prefixes="xsd oracle-xsl-mapper xsi xsl ns0 tns UUIDUserFunction IsUserInGroupFunction oraext IsUserInRoleFunction xp20 DVMFunctions oraxsl RuntimeTypeConversionFunctions XrefFunctions BasicCredentialsUserFunction"
                xmlns:ns6="http://xmlns.banesco.com/eo/Product_V1.0"
                xmlns:eoAcct="http://xmlns.banesco.com/eo/Acct_V1.0" xmlns:ns7="http://xmlns.banesco.com/eo/Party_V1.0"
                xmlns:eoStatus="http://xmlns.banesco.com/eo/Status_V1.0"
                xmlns:ns8="http://xmlns.banesco.com/eo/Chk_V1.0" xmlns:ns3="http://xmlns.banesco.com/eo/Banking_V1.0"
                xmlns:ns5="http://xmlns.banesco.com/eo/Fee_V1.0" xmlns:ns1="http://xmlns.banesco.com/eo/Card_V1.0"
                xmlns:ns2="http://xmlns.banesco.com/eo/Payee_V1.0" xmlns:ns4="http://xmlns.banesco.com/eo/Common_V1.0"
                xmlns:ns9="http://www.temenos.com/T24/ofs/AAARRANGEMENTACTIVITYWFACCTNEWType"
                xmlns:reqcns="http://www.temenos.com/T24/ofs/RequestCommon"
                xmlns:head="http://xmlns.banesco.com/appopt/AOptCommon_V1.0"
                xmlns:fn="http://www.w3.org/2005/xpath-functions">
  <oracle-xsl-mapper:schema>
    <!--SPECIFICATION OF MAP SOURCES AND TARGETS, DO NOT MODIFY.-->
    <oracle-xsl-mapper:mapSources>
      <oracle-xsl-mapper:source type="XSD">
        <oracle-xsl-mapper:schema location="../../../../Commons/xsd/EOpt/AccountDep/AcctFixDepAdd/AcctFixDepAdd_V1.0.xsd"/>
        <oracle-xsl-mapper:rootElement name="AcctFixDepAddRq"
                                       namespace="http://xmlns.banesco.com/eopt/AcctFixDepAdd_V1.0"/>
      </oracle-xsl-mapper:source>
    </oracle-xsl-mapper:mapSources>
    <oracle-xsl-mapper:mapTargets>
      <oracle-xsl-mapper:target type="XSD">
        <oracle-xsl-mapper:schema location="../../../../Commons/backends/T24/resources/xsd/AAArrangementActivity/NewcustomeraccNatCreaciondeclientecuentanatRequest.xsd"/>
        <oracle-xsl-mapper:rootElement name="AAARRANGEMENTACTIVITYWFACCTNEWRequest"
                                       namespace="http://www.temenos.com/T24/ofs/Request"/>
      </oracle-xsl-mapper:target>
    </oracle-xsl-mapper:mapTargets>
    <!--GENERATED BY ORACLE XSL MAPPER 12.2.1.2.0(XSLT Build 161003.0739.0018) AT [MON MAY 28 14:41:52 COT 2018].-->
  </oracle-xsl-mapper:schema>
  <!--User Editing allowed BELOW this line - DO NOT DELETE THIS LINE-->
  <xsl:include href="../../../../Commons/xslt/Template/TemplatePmtFrequency.xsl"/>
  <xsl:include href="../../../../Commons/xslt/Template/TemplateServiceUtil.xsl"/>
  <xsl:param name="varHeader"/>
  <xsl:template match="/">
    
    <xsl:variable name="CUSTOMER">
      <mPROPERTY>
        <PROPERTY>CUSTOMER</PROPERTY>
        <sgFIELDNAME>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:MovType/text()">
            <FIELDNAME>
              <FIELDNAME>LT.MOBILIZATION</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:MovType"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
          <!--Nuevos campos de beneficiario-->
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:PayeeInfo">
            <!--Foraech: Lista de Beneficiarios-->
            <xsl:for-each select="/ns0:AcctFixDepAddRq/ns0:PayeeInfo">
              <xsl:if test="ns2:FSPayee/ns2:PersonData/ns7:PersonName/ns7:FullName/text()">
                <FIELDNAME>
                  <FIELDNAME>LT.NAME.BENEF</FIELDNAME>
                  <FIELDVALUE>
                    <xsl:value-of select="ns2:FSPayee/ns2:PersonData/ns7:PersonName/ns7:FullName"/>
                  </FIELDVALUE>
                </FIELDNAME>
              </xsl:if>
              <xsl:if test="ns2:Percentage/text()">
                <FIELDNAME>
                  <FIELDNAME>LT.RATE.BENEF</FIELDNAME>
                  <FIELDVALUE>
                    <xsl:value-of select="ns2:Percentage"/>
                  </FIELDVALUE>
                </FIELDNAME>
              </xsl:if>
              <xsl:if test="ns2:PayeeType/text()">
                <FIELDNAME>
                  <FIELDNAME>LT.RELAT.BENEF</FIELDNAME>
                  <FIELDVALUE>
                    <xsl:value-of select="ns2:PayeeType"/>
                  </FIELDVALUE>
                </FIELDNAME>
              </xsl:if>
              <xsl:if test="ns2:FSPayee/ns2:PersonData/ns7:IssuedIdent/ns7:Ident/ns7:IssuedIdentValue/text()">
                <FIELDNAME>
                  <FIELDNAME>LT.ID.BENEF</FIELDNAME>
                  <FIELDVALUE>
                    <xsl:value-of select="ns2:FSPayee/ns2:PersonData/ns7:IssuedIdent/ns7:Ident/ns7:IssuedIdentValue"/>
                  </FIELDVALUE>
                </FIELDNAME>
              </xsl:if>
              <xsl:if test="ns2:FSPayee/ns2:PersonData/ns7:Contact/ns4:Locator/ns4:PostAddr/ns4:Country/ns4:CountryCode/text()">
                <FIELDNAME>
                  <FIELDNAME>LT.RESID.BENEF</FIELDNAME>
                  <FIELDVALUE>
                    <xsl:value-of select="ns2:FSPayee/ns2:PersonData/ns7:Contact/ns4:Locator/ns4:PostAddr/ns4:Country/ns4:CountryCode"/>
                  </FIELDVALUE>
                </FIELDNAME>
              </xsl:if>
              <xsl:if test="ns2:FSPayee/ns2:PersonData/ns7:Contact/ns4:Locator/ns4:Phone/ns4:PhoneNum/text()">
                <FIELDNAME>
                  <FIELDNAME>LT.PHONE</FIELDNAME>
                  <FIELDVALUE>
                    <xsl:value-of select="ns2:FSPayee/ns2:PersonData/ns7:Contact/ns4:Locator/ns4:Phone/ns4:PhoneNum"/>
                  </FIELDVALUE>
                </FIELDNAME>
              </xsl:if>
              <xsl:if test="ns2:UnderAge/text()">
                <FIELDNAME>
                  <FIELDNAME>LT.MINOR</FIELDNAME>
                  <FIELDVALUE>
                    <!--<xsl:value-of select="ns2:UnderAge"/>-->
                      <xsl:call-template name="Boolean_Regex">
                      <xsl:with-param name="operation">ADD</xsl:with-param>
                      <xsl:with-param name="parametro"> <xsl:value-of select="ns2:UnderAge"></xsl:value-of> </xsl:with-param>
                    </xsl:call-template>
                 </FIELDVALUE>
                </FIELDNAME>
              </xsl:if>
              <xsl:if test="ns2:TutorData/ns7:PersonName/ns7:FullName/text()">
                <FIELDNAME>
                  <FIELDNAME>LT.TUTOR.NAME</FIELDNAME>
                  <FIELDVALUE>
                    <xsl:value-of select="ns2:TutorData/ns7:PersonName/ns7:FullName"/>
                  </FIELDVALUE>
                </FIELDNAME>
              </xsl:if>
              <xsl:if test="ns2:TutorData/ns7:IssuedIdent/ns7:Ident/ns7:IssuedIdentValue/text()">
                <FIELDNAME>
                  <FIELDNAME>LT.ID.TUTOR</FIELDNAME>
                  <FIELDVALUE>
                    <xsl:value-of select="ns2:TutorData/ns7:IssuedIdent/ns7:Ident/ns7:IssuedIdentValue"/>
                  </FIELDVALUE>
                </FIELDNAME>
              </xsl:if>
              <xsl:if test="ns2:TutorData/ns7:Contact/ns4:Locator/ns4:Phone/ns4:PhoneNum/text()">
                <FIELDNAME>
                  <FIELDNAME>LT.PHONE.TUTOR</FIELDNAME>
                  <FIELDVALUE>
                    <xsl:value-of select="ns2:TutorData/ns7:Contact/ns4:Locator/ns4:Phone/ns4:PhoneNum"/>
                  </FIELDVALUE>
                </FIELDNAME>
              </xsl:if>
              <xsl:if test="ns2:TutorData/ns7:Contact/ns4:Locator/ns4:Phone/ns4:AreaCode/text()">
                <FIELDNAME>
                  <FIELDNAME>LT.PHONE.COD2</FIELDNAME>
                  <FIELDVALUE>
                    <xsl:value-of select="ns2:TutorData/ns7:Contact/ns4:Locator/ns4:Phone/ns4:AreaCode"/>
                  </FIELDVALUE>
                </FIELDNAME>
              </xsl:if>
            </xsl:for-each>
            <!--End_Foraech-->
          </xsl:if>
        </sgFIELDNAME>
      </mPROPERTY>
    </xsl:variable>
    
    <xsl:variable name="ACCOUNT">
      <mPROPERTY>
        <PROPERTY>ACCOUNT</PROPERTY>
        <sgFIELDNAME>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:AcctTitle/text()">
            <FIELDNAME>
              <FIELDNAME>ACCOUNT.TITLE.1</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:AcctTitle"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:Category/text()">
            <FIELDNAME>
              <FIELDNAME>CATEGORY</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:Category"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:SubCategory/text()">
            <FIELDNAME>
              <FIELDNAME>LT.SUBPRODUCT</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:SubCategory"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
        </sgFIELDNAME>
      </mPROPERTY>
    </xsl:variable>
    <!-- Nueva Variable OFFICERS-->
    <xsl:variable name="OFFICERS">
      <mPROPERTY>
        <PROPERTY>OFFICERS</PROPERTY>
        <sgFIELDNAME>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:AcctOpeningInfo/eoAcct:SaleOfficer/text()">
            <FIELDNAME>
              <FIELDNAME>LT.SALE.OFFICER</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:AcctOpeningInfo/eoAcct:SaleOfficer"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:AcctOpeningInfo/eoAcct:BusinessUnit/text()">
            <FIELDNAME>
              <FIELDNAME>LT.BUS.UNIT</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:AcctOpeningInfo/eoAcct:BusinessUnit"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
        </sgFIELDNAME>
      </mPROPERTY>
    </xsl:variable>
    <xsl:variable name="COMMITMENT">
      <mPROPERTY>
        <PROPERTY>COMMITMENT</PROPERTY>
        <sgFIELDNAME>
          <FIELDNAME>
            <FIELDNAME>AMOUNT</FIELDNAME>
            <FIELDVALUE>
              <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:AcctOpeningInfo/eoAcct:InitialAmt/ns4:Amt"/>
            </FIELDVALUE>
          </FIELDNAME>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:Term/eoAcct:ProposedTerm/text()">
            <FIELDNAME>
              <FIELDNAME>TERM</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:Term/eoAcct:ProposedTerm"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:ClosedDt/text()">
            <FIELDNAME>
              <FIELDNAME>MATURITY.DATE</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:ClosedDt"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
        </sgFIELDNAME>
      </mPROPERTY>
    </xsl:variable>
    <xsl:variable name="RENEWAL">
      <mPROPERTY>
        <PROPERTY>RENEWAL</PROPERTY>
        <sgFIELDNAME>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:ChangeDateType/text()">
            <FIELDNAME>
              <FIELDNAME>CHANGE.DATE.TYPE</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:ChangeDateType"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:ChangePeriod/text()">
            <FIELDNAME>
              <FIELDNAME>CHANGE.PERIOD</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:ChangePeriod"/>
                <!--<xsl:value-of select="concat('D_', xp20:format-dateTime(/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:ChangePeriod, &quot;[Y0001][M01][D01]&quot; ))"/>-->
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:ChangeDt/text()">
            <FIELDNAME>
              <FIELDNAME>CHANGE.DATE</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="xp20:format-dateTime(/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:ChangeDt,'[Y0001][M01][D01]')"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:ChangeActivity/text()">
            <FIELDNAME>
              <FIELDNAME>CHANGE.ACTIVITY</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:ChangeActivity"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:RenewalOption/text()">
            <FIELDNAME>
              <FIELDNAME>INITIATION.TYPE</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:RenewalOption"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
        </sgFIELDNAME>
      </mPROPERTY>
    </xsl:variable>
    <xsl:variable name="DEPOSITINT">
      <mPROPERTY>
        <PROPERTY>DEPOSITINT</PROPERTY>
        <sgFIELDNAME>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:IntRateData/eoAcct:IntRate/text()">
            <FIELDNAME>
              <FIELDNAME>PERIODIC.RATE</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:IntRateData/eoAcct:IntRate"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:IntRateData/eoAcct:PeriodicIndex/text()">
            <FIELDNAME>
              <FIELDNAME>PERIODIC.INDEX</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:IntRateData/eoAcct:PeriodicIndex"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:IntRateData/eoAcct:EffRate/text()">
            <FIELDNAME>
              <FIELDNAME>EFFECTIVE.RATE</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:IntRateData/eoAcct:EffRate"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
        </sgFIELDNAME>
      </mPROPERTY>
    </xsl:variable>
    <xsl:variable name="SCHEDULE">
      <mPROPERTY>
        <PROPERTY>SCHEDULE</PROPERTY>
        <sgFIELDNAME>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:PmtType/text()">
            <FIELDNAME>
              <FIELDNAME>PAYMENT.TYPE</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:PmtType"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:PmtClass/text()">
            <FIELDNAME>
              <FIELDNAME>PAYMENT.METHOD</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:PmtClass"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:Freq/ns4:Every/text()">
            <FIELDNAME>
              <FIELDNAME>PAYMENT.FREQ</FIELDNAME>
              <FIELDVALUE>
                <xsl:call-template name="DepIntPmtFreq">
                  <xsl:with-param name="every"><xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:Freq/ns4:Every/text()"/></xsl:with-param>
                  <xsl:with-param name="onDay"><xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:Freq/ns4:OnDay/text()"/></xsl:with-param>
                  <xsl:with-param name="onDayNumber"><xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:Freq/ns4:OnDayNumber/text()"/></xsl:with-param>
                  <xsl:with-param name="onWeekDay"><xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:Freq/ns4:OnWeekDay/text()"/></xsl:with-param>
                </xsl:call-template>
                <!--xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:Freq"/-->
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
          <!-- Nueva propiedad DUE.FREQ -->
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:Freq/ns4:Every/text()">
            <FIELDNAME>
              <FIELDNAME>DUE.FREQ</FIELDNAME>
              <FIELDVALUE>
                <xsl:call-template name="DepIntPmtFreq">
                  <xsl:with-param name="every"><xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:Freq/ns4:Every/text()"/></xsl:with-param>
                  <xsl:with-param name="onDay"><xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:Freq/ns4:OnDay/text()"/></xsl:with-param>
                  <xsl:with-param name="onDayNumber"><xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:Freq/ns4:OnDayNumber/text()"/></xsl:with-param>
                  <xsl:with-param name="onWeekDay"><xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:Freq/ns4:OnWeekDay/text()"/></xsl:with-param>
                </xsl:call-template>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
          <!-- Nuevo propiedad START.DATE-->
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:PmtTargetDetail/eoAcct:StartDate">
            <FIELDNAME>
              <FIELDNAME>START.DATE</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="concat('D_', xp20:format-dateTime(/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:PmtTargetDetail/eoAcct:StartDate, &quot;[Y0001][M01][D01]&quot; ))"/>
              </FIELDVALUE>
            </FIELDNAME>
            <!--<xsl:variable name="method" select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:PmtClass/text()"/>
          <xsl:if test="$method='CAPITALISE' or $method='PAY'">
            <xsl:choose>
              <xsl:when test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:Freq/ns4:Every/text()">
                <FIELDNAME>
                  <FIELDNAME>START.DATE</FIELDNAME>
                  <FIELDVALUE></FIELDVALUE>
                </FIELDNAME>
              </xsl:when>
              <xsl:otherwise>
                <FIELDNAME>
                  <FIELDNAME>START.DATE</FIELDNAME>
                  <FIELDVALUE>R_RENEWAL +</FIELDVALUE>
                </FIELDNAME>
              </xsl:otherwise>
            </xsl:choose>
          </xsl:if>-->
          </xsl:if>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:PmtDetail/eoAcct:PmtTarget/text()">
            <FIELDNAME>
              <FIELDNAME>PROPERTY</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:DepInterestPmt/eoAcct:PmtDetail/eoAcct:PmtTarget"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
        </sgFIELDNAME>
      </mPROPERTY>
    </xsl:variable>
    <xsl:variable name="SETTLEMENT">
      <mPROPERTY>
        <PROPERTY>SETTLEMENT</PROPERTY>
        <sgFIELDNAME>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:SettleInstruction/eoAcct:PayIn/eoAcct:PayInAcctRef/eoAcct:PayInAcct/eoAcct:AcctId/text()">
            <FIELDNAME>
              <FIELDNAME>PAYIN.ACCOUNT</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:SettleInstruction/eoAcct:PayIn/eoAcct:PayInAcctRef/eoAcct:PayInAcct/eoAcct:AcctId"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
          <!-- Nueva propiedad FONDEO CHEQUE -->
          <xsl:variable name="fondeo" select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:SettleInstruction/eoAcct:PayIn/eoAcct:Settlement"/>
          <!--<FONDEO><xsl:value-of select="$fondeo"/></FONDEO>-->
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:SettleInstruction/eoAcct:PayIn/eoAcct:PayInAcctRef/eoAcct:PayInAcct/eoAcct:AcctId/text()">
            <xsl:choose>
              <xsl:when test="$fondeo='true'">
                <FIELDNAME>
                  <FIELDNAME>PAYIN.SETTLEMENT</FIELDNAME>
                  <!--<FIELDVALUE>N</FIELDVALUE>-->
                  <FIELDVALUE>
                    <xsl:call-template name="Boolean_Regex">
                      <xsl:with-param name="operation">ADD</xsl:with-param>
                      <xsl:with-param name="parametro"> <xsl:value-of select="$fondeo"></xsl:value-of> </xsl:with-param>
                    </xsl:call-template>
                  </FIELDVALUE>
                </FIELDNAME>
              </xsl:when>
            </xsl:choose>
          </xsl:if>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:SettleInstruction/eoAcct:PayOut/eoAcct:PayOutAcct/eoAcct:AcctId/text()">
            <FIELDNAME>
              <FIELDNAME>PAYOUT.ACCOUNT</FIELDNAME>
              <FIELDVALUE>
                <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:DepAcctData/eoAcct:SettleInstruction/eoAcct:PayOut/eoAcct:PayOutAcct/eoAcct:AcctId"/>
              </FIELDVALUE>
            </FIELDNAME>
          </xsl:if>
        </sgFIELDNAME>
      </mPROPERTY>
    </xsl:variable>
    <opaq:opaqueElement xmlns:opaq="http://xmlns.oracle.com/pcbpel/adapter/opaque/">
      <tns:AAARRANGEMENTACTIVITYWFACCTNEWRequest>
        <RequestCommon>
          <UserName>
            <xsl:value-of select="$varHeader/head:ClientApp/head:UserId"/>
          </UserName>
        </RequestCommon>
        <AAARRANGEMENTACTIVITYWFACCTNEW>
          <ARRANGEMENT>
            <xsl:value-of select='DVMFunctions:lookupValue ("Commons/dvm/ServiceProperties", "CODE", "AcctFixDepAdd.Arragement", "VALUE", "" )'/>
          </ARRANGEMENT>
          <ACTIVITY>
            <xsl:value-of select='DVMFunctions:lookupValue ("Commons/dvm/ServiceProperties", "CODE", "AcctFixDepAdd.Activity", "VALUE", "" )'/>
          </ACTIVITY>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:AcctOpeningInfo/eoAcct:OpenDt/text()">
            <EFFECTIVEDATE>
              <xsl:value-of select="xp20:format-dateTime(/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:AcctOpeningInfo/eoAcct:OpenDt,'[Y0001]-[M01]-[D01]')"/>
            </EFFECTIVEDATE>
          </xsl:if>
          <gCUSTOMER>
            <xsl:for-each select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:AcctMember">
              <mCUSTOMER>
                <xsl:if test="eoAcct:PartyKey/ns7:PartyId/text()">
                  <CUSTOMER>
                    <xsl:value-of select="eoAcct:PartyKey/ns7:PartyId"/>
                  </CUSTOMER>
                </xsl:if>
                <xsl:if test="eoAcct:PartyRole/ns4:Cod/text()">
                  <CUSTOMERROLE>
                    <xsl:value-of select="eoAcct:PartyRole/ns4:Cod"/>
                  </CUSTOMERROLE>
                </xsl:if>
              </mCUSTOMER>
            </xsl:for-each>
          </gCUSTOMER>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:AcctSubtype/ns4:Cod/text()">
            <PRODUCT>
              <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:AcctSubtype/ns4:Cod"/>
            </PRODUCT>
          </xsl:if>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:CurCode/text()">
            <CURRENCY>
              <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:CurCode"/>
            </CURRENCY>
          </xsl:if>
          <xsl:if test="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:Variation/ns4:Cod/text()">
            <PRODUCTVARIATION>
              <xsl:value-of select="/ns0:AcctFixDepAddRq/ns0:Acct/eoAcct:Variation/ns4:Cod"/>
            </PRODUCTVARIATION>
          </xsl:if>
          <gPROPERTY>
            <xsl:if test="count($CUSTOMER/mPROPERTY/sgFIELDNAME/FIELDNAME) > 0">
              <xsl:copy-of select="$CUSTOMER"/>
            </xsl:if>
            <xsl:if test="count($COMMITMENT/mPROPERTY/sgFIELDNAME/FIELDNAME) > 0">
              <xsl:copy-of select="$COMMITMENT"/>
            </xsl:if>
            <xsl:if test="count($ACCOUNT/mPROPERTY/sgFIELDNAME/FIELDNAME) > 0">
              <xsl:copy-of select="$ACCOUNT"/>
            </xsl:if>
            <xsl:if test="count(OFFICERS/mPROPERTY/sgFIELDNAME/FIELDNAME) > 0">
              <xsl:copy-of select="OFFICERS"/>
            </xsl:if>
            <xsl:if test="count($DEPOSITINT/mPROPERTY/sgFIELDNAME/FIELDNAME) > 0">
              <xsl:copy-of select="$DEPOSITINT"/>
            </xsl:if>
            <xsl:if test="count($RENEWAL/mPROPERTY/sgFIELDNAME/FIELDNAME) > 0">
              <xsl:copy-of select="$RENEWAL"/>
            </xsl:if>
            <xsl:if test="count($SCHEDULE/mPROPERTY/sgFIELDNAME/FIELDNAME) > 0">
              <xsl:copy-of select="$SCHEDULE"/>
            </xsl:if>
            <xsl:if test="count($SETTLEMENT/mPROPERTY/sgFIELDNAME/FIELDNAME) > 0">
              <xsl:copy-of select="$SETTLEMENT"/>
            </xsl:if>
          </gPROPERTY>
        </AAARRANGEMENTACTIVITYWFACCTNEW>
      </tns:AAARRANGEMENTACTIVITYWFACCTNEWRequest>
    </opaq:opaqueElement>
  </xsl:template>
</xsl:stylesheet>